============================================================================================================================================================åˆ†éš”ç¬¦
æ­¤æœºæ„: 0008
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 118
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0008 2019 å¼€å§‹è¿›è¡Œè®¡ç®—å¹´æŠ¥è¡¨æ•°æ®å¤„ç†
ä¸åŒçš„è¡¨è®¡å·å…±æœ‰ä¸ªæ•°: 31
æ ¹æ®è¡¨è®¡å·ï¼Œè¿›è¡Œæ•°æ®çš„å†æ¬¡ç­›é€‰ï¼Œå¤„ç†ï¼Œå†™å…¥æ•°æ®åº“
----------------------------------------------------------------------------------------
00086000000012
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000078'}]
0000000078
00086000000012
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000067')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000078', 'rtu_no': '00080000000012', 'flmeter_no': '00086000000012', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 38, 470822), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 0, 21, 5), 'min_std_flow_time': datetime.datetime(2019, 4, 27, 0, 20, 46), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 0, 21, 5), 'min_work_flow_time': datetime.datetime(2019, 4, 27, 0, 20, 46), 'max_temperature': '27.5', 'min_temperature': '17.0', 'avg_temperature': '22.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 0, 21, 39), 'min_temp_time': datetime.datetime(2019, 4, 27, 0, 20, 46), 'max_press': '102.1', 'min_press': '101.3', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 5, 30, 0, 21, 34), 'min_press_time': datetime.datetime(2019, 4, 27, 0, 20, 46), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 48.0, 'total_buy_volume': None, 'total_buy_money': '53', 'remain_money': '5.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '48.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000012å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000001
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000079'}]
0000000079
00086000000001
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000053')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000079', 'rtu_no': '00080000000001', 'flmeter_no': '00086000000001', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 38, 749003), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 12, 15, 3, 9), 'min_std_flow_time': datetime.datetime(2019, 4, 11, 16, 57, 9), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 12, 15, 3, 9), 'min_work_flow_time': datetime.datetime(2019, 4, 11, 16, 57, 9), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 4, 12, 15, 3, 9), 'min_temp_time': datetime.datetime(2019, 4, 11, 16, 57, 9), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 4, 12, 15, 3, 9), 'min_press_time': datetime.datetime(2019, 4, 11, 16, 57, 9), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '1120', 'remain_money': '1120', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '00', 'valve_state_msg': 'é˜€é—¨å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '18.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000001å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000018
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000080'}]
0000000080
00086000000018 â˜† sum_total_money <0 ç½®ä¸º0
00086000000018
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000070')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000080', 'rtu_no': '00080000000018', 'flmeter_no': '00086000000018', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 39, 4321), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 0, 20, 47), 'min_std_flow_time': datetime.datetime(2019, 4, 27, 4, 35, 41), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 0, 20, 47), 'min_work_flow_time': datetime.datetime(2019, 4, 27, 4, 35, 41), 'max_temperature': '34.4', 'min_temperature': '0.0', 'avg_temperature': '24.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 0, 20, 25), 'min_temp_time': datetime.datetime(2019, 7, 1, 0, 51, 11), 'max_press': '104.6', 'min_press': '101.1', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 5, 30, 0, 51, 3), 'min_press_time': datetime.datetime(2019, 4, 27, 4, 35, 41), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '24.0', 'temp_out': '24.0', 'rssi': '30.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000018å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000029
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000081'}]
0000000081
00086000000029
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000063')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000081', 'rtu_no': '00080000000029', 'flmeter_no': '00086000000029', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 39, 276591), 'year': '2019', 'std_sum': '710', 'work_sum': '717', 'max_std_flow': '3.03', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 3, 1, 32, 22), 'min_std_flow_time': datetime.datetime(2019, 5, 22, 1, 21, 4), 'max_work_flow': '3.03', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 3, 1, 32, 22), 'min_work_flow_time': datetime.datetime(2019, 5, 22, 1, 21, 4), 'max_temperature': '31.8', 'min_temperature': '0.0', 'avg_temperature': '24.0', 'max_temp_time': datetime.datetime(2019, 7, 3, 1, 32, 22), 'min_temp_time': datetime.datetime(2019, 6, 25, 11, 23, 39), 'max_press': '161.0', 'min_press': '0.0', 'avg_press': '98.0', 'max_press_time': datetime.datetime(2019, 5, 22, 12, 38, 24), 'min_press_time': datetime.datetime(2019, 6, 25, 11, 23, 39), 'price': '3.1', 'use_volume_work': '499.0', 'use_volume_std': '494.0', 'use_money': '1506.48', 'sum_total_volume': '710', 'sum_total_money': 2161.0, 'total_buy_volume': None, 'total_buy_money': '3578', 'remain_money': '1417.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '24.0', 'temp_out': '24.0', 'rssi': '21.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000029å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000008
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 6
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000082'}]
0000000082
00086000000008
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000077')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000082', 'rtu_no': '00080000000003', 'flmeter_no': '00086000000008', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 39, 622667), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '25.09', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 14, 20, 18, 13), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 14, 32, 35), 'max_work_flow': '25.09', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 14, 20, 18, 13), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 14, 32, 35), 'max_temperature': '28.7', 'min_temperature': '15.0', 'avg_temperature': '22.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 1, 23, 15), 'min_temp_time': datetime.datetime(2019, 3, 4, 14, 32, 35), 'max_press': '103.4', 'min_press': '100.1', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 31, 22, 31, 26), 'min_press_time': datetime.datetime(2019, 4, 1, 0, 21, 12), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '32.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000008å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000007
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000083'}]
0000000083
00086000000007 â˜† sum_total_money <0 ç½®ä¸º0
00086000000007
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000066')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000083', 'rtu_no': '00080000000007', 'flmeter_no': '00086000000007', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 39, 856041), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '25.11', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 14, 21, 18, 53), 'min_std_flow_time': datetime.datetime(2019, 5, 6, 14, 39, 51), 'max_work_flow': '25.11', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 14, 21, 18, 53), 'min_work_flow_time': datetime.datetime(2019, 5, 6, 14, 39, 51), 'max_temperature': '28.3', 'min_temperature': '19.5', 'avg_temperature': '25.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 1, 23), 'min_temp_time': datetime.datetime(2019, 5, 6, 14, 39, 51), 'max_press': '101.4', 'min_press': '48.9', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 5, 14, 21, 18, 53), 'min_press_time': datetime.datetime(2019, 5, 6, 14, 39, 51), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '25.0', 'temp_out': '25.0', 'rssi': '17.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000007å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000015
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000084'}]
0000000084
00086000000015
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000074')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000084', 'rtu_no': '00080000000015', 'flmeter_no': '00086000000015', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 40, 155242), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 1, 22, 25), 'min_std_flow_time': datetime.datetime(2019, 4, 27, 1, 20, 52), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 1, 22, 25), 'min_work_flow_time': datetime.datetime(2019, 4, 27, 1, 20, 52), 'max_temperature': '27.5', 'min_temperature': '17.1', 'avg_temperature': '22.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 1, 20, 55), 'min_temp_time': datetime.datetime(2019, 4, 27, 1, 20, 52), 'max_press': '102.1', 'min_press': '101.1', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 5, 30, 1, 20, 15), 'min_press_time': datetime.datetime(2019, 4, 27, 1, 20, 52), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 993.0, 'total_buy_volume': None, 'total_buy_money': '998', 'remain_money': '5.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '38.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000015å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000002
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000085'}]
0000000085
00086000000002
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000054')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000085', 'rtu_no': '00080000000002', 'flmeter_no': '00086000000002', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 40, 444613), 'year': '2019', 'std_sum': '1018', 'work_sum': '1031', 'max_std_flow': '1.03', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 1, 17, 52, 10), 'min_std_flow_time': datetime.datetime(2019, 4, 15, 11, 18, 34), 'max_work_flow': '1.03', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 1, 17, 52, 10), 'min_work_flow_time': datetime.datetime(2019, 4, 15, 11, 18, 34), 'max_temperature': '36.4', 'min_temperature': '0.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 8, 1, 17, 52, 10), 'min_temp_time': datetime.datetime(2019, 4, 15, 11, 18, 34), 'max_press': '104.5', 'min_press': '0.0', 'avg_press': '87.0', 'max_press_time': datetime.datetime(2019, 4, 29, 0, 22, 26), 'min_press_time': datetime.datetime(2019, 4, 15, 11, 18, 34), 'price': '3.1', 'use_volume_work': '996.0', 'use_volume_std': '985.0', 'use_money': '2991.83', 'sum_total_volume': '1018', 'sum_total_money': 3092.0, 'total_buy_volume': None, 'total_buy_money': '4001', 'remain_money': '909.0', 'remain_volume': None, 'fm_state': '000000000101000000000000000000000000000000000000', 'fm_state_msg': '[å¾…å®š][å¾…å®š]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '87.0', 'press_out': '87.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '22.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000002å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000006
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000086'}]
0000000086
00086000000006 â˜† sum_total_money <0 ç½®ä¸º0
00086000000006
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000056')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000086', 'rtu_no': '00080000000006', 'flmeter_no': '00086000000006', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 40, 724720), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 0, 19, 5), 'min_std_flow_time': datetime.datetime(2019, 5, 6, 14, 40, 2), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 0, 19, 5), 'min_work_flow_time': datetime.datetime(2019, 5, 6, 14, 40, 2), 'max_temperature': '28.8', 'min_temperature': '0.0', 'avg_temperature': '24.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 0, 18, 58), 'min_temp_time': datetime.datetime(2019, 7, 1, 10, 36, 22), 'max_press': '101.4', 'min_press': '0.0', 'avg_press': '98.0', 'max_press_time': datetime.datetime(2019, 5, 30, 1, 20, 29), 'min_press_time': datetime.datetime(2019, 7, 1, 10, 36, 22), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '24.0', 'temp_out': '24.0', 'rssi': '35.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000006å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000025
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000087'}]
0000000087
00086000000025
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000055')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000087', 'rtu_no': '00080000000025', 'flmeter_no': '00086000000025', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 40, 990010), 'year': '2019', 'std_sum': '2922', 'work_sum': '2973', 'max_std_flow': '14.34', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 10, 18, 35, 5), 'min_std_flow_time': datetime.datetime(2019, 5, 19, 1, 20, 30), 'max_work_flow': '14.34', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 10, 18, 35, 5), 'min_work_flow_time': datetime.datetime(2019, 5, 19, 1, 20, 30), 'max_temperature': '32.4', 'min_temperature': '20.9', 'avg_temperature': '25.0', 'max_temp_time': datetime.datetime(2019, 7, 10, 18, 35, 5), 'min_temp_time': datetime.datetime(2019, 5, 19, 1, 20, 30), 'max_press': '113.2', 'min_press': '100.0', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 7, 10, 18, 35, 5), 'min_press_time': datetime.datetime(2019, 5, 19, 1, 20, 30), 'price': '3.1', 'use_volume_work': '2863.0', 'use_volume_std': '2814.0', 'use_money': '8566.46', 'sum_total_volume': '2922', 'sum_total_money': 8885.0, 'total_buy_volume': None, 'total_buy_money': '9849', 'remain_money': '964.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '25.0', 'temp_out': '25.0', 'rssi': '19.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000025å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000017
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000088'}]
0000000088
00086000000017
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000052')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000088', 'rtu_no': '00080000000017', 'flmeter_no': '00086000000017', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 41, 265274), 'year': '2019', 'std_sum': '1276', 'work_sum': '2592', 'max_std_flow': '7.7', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 8, 17, 17, 36), 'min_std_flow_time': datetime.datetime(2019, 4, 27, 0, 20, 46), 'max_work_flow': '7.7', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 8, 17, 17, 36), 'min_work_flow_time': datetime.datetime(2019, 4, 27, 0, 20, 46), 'max_temperature': '37.0', 'min_temperature': '0.0', 'avg_temperature': '22.0', 'max_temp_time': datetime.datetime(2019, 7, 27, 1, 43, 22), 'min_temp_time': datetime.datetime(2019, 7, 2, 0, 33, 20), 'max_press': '104.7', 'min_press': '0.0', 'avg_press': '96.0', 'max_press_time': datetime.datetime(2019, 5, 8, 17, 17, 36), 'min_press_time': datetime.datetime(2019, 7, 2, 0, 33, 20), 'price': '3.1', 'use_volume_work': '2431.0', 'use_volume_std': '1206.0', 'use_money': '3668.74', 'sum_total_volume': '1276', 'sum_total_money': 3887.0, 'total_buy_volume': None, 'total_buy_money': '8000', 'remain_money': '4113.0', 'remain_volume': None, 'fm_state': '000000000001000000000000000000000000000000000000', 'fm_state_msg': '[å¾…å®š]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '96.0', 'press_out': '96.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '23.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000017å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000030
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000089'}]
0000000089
00086000000030
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000058')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000089', 'rtu_no': '00080000000030', 'flmeter_no': '00086000000030', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 41, 511616), 'year': '2019', 'std_sum': '138', 'work_sum': '142', 'max_std_flow': '1.9', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 28, 1, 20, 39), 'min_std_flow_time': datetime.datetime(2019, 5, 19, 0, 30, 53), 'max_work_flow': '1.9', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 28, 1, 20, 39), 'min_work_flow_time': datetime.datetime(2019, 5, 19, 0, 30, 53), 'max_temperature': '32.6', 'min_temperature': '0.0', 'avg_temperature': '26.0', 'max_temp_time': datetime.datetime(2019, 7, 28, 1, 20, 39), 'min_temp_time': datetime.datetime(2019, 5, 19, 0, 30, 53), 'max_press': '107.2', 'min_press': '100.1', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 5, 23, 10, 56, 49), 'min_press_time': datetime.datetime(2019, 5, 19, 0, 30, 53), 'price': '3.1', 'use_volume_work': '130.0', 'use_volume_std': '126.0', 'use_money': '386.75', 'sum_total_volume': '138', 'sum_total_money': 414.0, 'total_buy_volume': None, 'total_buy_money': '1000', 'remain_money': '586.0', 'remain_volume': None, 'fm_state': '000000000001000000000000000000000000000000000000', 'fm_state_msg': '[å¾…å®š]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '26.0', 'temp_out': '26.0', 'rssi': '24.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000030å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000010
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000090'}]
0000000090
00086000000010
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000068')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000090', 'rtu_no': '00080000000010', 'flmeter_no': '00086000000010', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 41, 761947), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 0, 59, 7), 'min_std_flow_time': datetime.datetime(2019, 4, 26, 0, 20, 50), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 0, 59, 7), 'min_work_flow_time': datetime.datetime(2019, 4, 26, 0, 20, 50), 'max_temperature': '28.8', 'min_temperature': '0.0', 'avg_temperature': '22.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 1, 0, 43), 'min_temp_time': datetime.datetime(2019, 7, 1, 10, 49, 15), 'max_press': '107.6', 'min_press': '0.0', 'avg_press': '98.0', 'max_press_time': datetime.datetime(2019, 5, 30, 0, 22, 58), 'min_press_time': datetime.datetime(2019, 7, 1, 10, 49, 15), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '55.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000010å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000022
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000091'}]
0000000091
00086000000022
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000065')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000091', 'rtu_no': '00080000000022', 'flmeter_no': '00086000000022', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 42, 28389), 'year': '2019', 'std_sum': '767', 'work_sum': '776', 'max_std_flow': '3.7', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 30, 1, 50, 48), 'min_std_flow_time': datetime.datetime(2019, 5, 7, 20, 29, 38), 'max_work_flow': '3.7', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 30, 1, 50, 48), 'min_work_flow_time': datetime.datetime(2019, 5, 7, 20, 29, 38), 'max_temperature': '31.9', 'min_temperature': '17.0', 'avg_temperature': '24.0', 'max_temp_time': datetime.datetime(2019, 7, 24, 1, 51, 22), 'min_temp_time': datetime.datetime(2019, 5, 7, 20, 29, 38), 'max_press': '104.3', 'min_press': '102.3', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 5, 30, 1, 50, 48), 'min_press_time': datetime.datetime(2019, 7, 1, 1, 51, 12), 'price': '3.1', 'use_volume_work': '677.0', 'use_volume_std': '667.0', 'use_money': '2036.76', 'sum_total_volume': '767', 'sum_total_money': 2342.0, 'total_buy_volume': None, 'total_buy_money': '3150', 'remain_money': '808.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '24.0', 'temp_out': '24.0', 'rssi': '22.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000022å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000016
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000092'}]
0000000092
00086000000016
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000050')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000092', 'rtu_no': '00080000000016', 'flmeter_no': '00086000000016', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 42, 315466), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 0, 22, 23), 'min_std_flow_time': datetime.datetime(2019, 6, 25, 16, 15, 27), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 0, 22, 23), 'min_work_flow_time': datetime.datetime(2019, 6, 25, 16, 15, 27), 'max_temperature': '27.6', 'min_temperature': '24.3', 'avg_temperature': '25.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 0, 20, 45), 'min_temp_time': datetime.datetime(2019, 7, 1, 0, 20, 49), 'max_press': '115.6', 'min_press': '99.0', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 7, 30, 0, 20, 45), 'min_press_time': datetime.datetime(2019, 7, 1, 0, 20, 49), 'price': '3.03', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '1.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '25.0', 'temp_out': '25.0', 'rssi': '46.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000016å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000005
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000093'}]
0000000093
00086000000005
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000060')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000093', 'rtu_no': '00080000000005', 'flmeter_no': '00086000000005', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 42, 580757), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 1, 21, 7), 'min_std_flow_time': datetime.datetime(2019, 5, 7, 1, 20, 38), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 1, 21, 7), 'min_work_flow_time': datetime.datetime(2019, 5, 7, 1, 20, 38), 'max_temperature': '29.5', 'min_temperature': '24.8', 'avg_temperature': '25.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 1, 20, 58), 'min_temp_time': datetime.datetime(2019, 7, 1, 1, 20, 55), 'max_press': '134.3', 'min_press': '81.2', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 5, 30, 1, 20, 28), 'min_press_time': datetime.datetime(2019, 8, 1, 1, 20, 49), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '1.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '25.0', 'temp_out': '25.0', 'rssi': '15.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000005å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000020
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000094'}]
0000000094
00086000000020
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000051')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000094', 'rtu_no': '00080000000020', 'flmeter_no': '00086000000020', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 42, 873976), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 0, 20, 49), 'min_std_flow_time': datetime.datetime(2019, 5, 6, 14, 25, 38), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 0, 20, 49), 'min_work_flow_time': datetime.datetime(2019, 5, 6, 14, 25, 38), 'max_temperature': '36.0', 'min_temperature': '19.7', 'avg_temperature': '28.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 0, 20, 26), 'min_temp_time': datetime.datetime(2019, 5, 6, 14, 25, 38), 'max_press': '109.6', 'min_press': '99.3', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 6, 29, 0, 20, 49), 'min_press_time': datetime.datetime(2019, 6, 1, 0, 20, 49), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '28.0', 'temp_out': '28.0', 'rssi': '19.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000020å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000031
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000095'}]
0000000095
00086000000031
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000048')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000095', 'rtu_no': '00080000000031', 'flmeter_no': '00086000000031', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 43, 166191), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '74.11', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 6, 5, 12, 56, 57), 'min_std_flow_time': datetime.datetime(2019, 6, 4, 12, 38, 12), 'max_work_flow': '76.05', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 6, 5, 12, 56, 57), 'min_work_flow_time': datetime.datetime(2019, 6, 4, 12, 38, 12), 'max_temperature': '35.7', 'min_temperature': '20.0', 'avg_temperature': '28.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 0, 40, 50), 'min_temp_time': datetime.datetime(2019, 6, 4, 12, 38, 12), 'max_press': '101.3', 'min_press': '99.2', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 6, 5, 12, 56, 57), 'min_press_time': datetime.datetime(2019, 7, 1, 11, 19, 24), 'price': '3.03', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '7', 'remain_money': '7.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': '7.33', 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '28.0', 'temp_out': '28.0', 'rssi': '18.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000031å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000034
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000096'}]
0000000096
00086000000034
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000057')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000096', 'rtu_no': '00080000000034', 'flmeter_no': '00086000000034', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 43, 453427), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 5, 1, 10, 41), 'min_std_flow_time': datetime.datetime(2019, 6, 4, 10, 46, 12), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 5, 1, 10, 41), 'min_work_flow_time': datetime.datetime(2019, 6, 4, 10, 46, 12), 'max_temperature': '31.4', 'min_temperature': '20.0', 'avg_temperature': '28.0', 'max_temp_time': datetime.datetime(2019, 6, 29, 3, 15, 30), 'min_temp_time': datetime.datetime(2019, 6, 4, 10, 46, 12), 'max_press': '99.7', 'min_press': '98.7', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 7, 5, 1, 10, 41), 'min_press_time': datetime.datetime(2019, 6, 4, 10, 46, 12), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': '7.32', 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '28.0', 'temp_out': '28.0', 'rssi': '20.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000034å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000035
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000097'}]
0000000097
00086000000035
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000069')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000097', 'rtu_no': '00080000000035', 'flmeter_no': '00086000000035', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 43, 772570), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 5, 1, 40, 54), 'min_std_flow_time': datetime.datetime(2019, 6, 5, 1, 20, 26), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 5, 1, 40, 54), 'min_work_flow_time': datetime.datetime(2019, 6, 5, 1, 20, 26), 'max_temperature': '32.6', 'min_temperature': '24.6', 'avg_temperature': '30.0', 'max_temp_time': datetime.datetime(2019, 7, 5, 1, 40, 54), 'min_temp_time': datetime.datetime(2019, 6, 5, 1, 20, 26), 'max_press': '100.7', 'min_press': '99.3', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 6, 29, 1, 40, 59), 'min_press_time': datetime.datetime(2019, 6, 5, 1, 20, 26), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '4', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': '7.38', 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '30.0', 'temp_out': '30.0', 'rssi': '18.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000035å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000023
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000098'}]
0000000098
00086000000023
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000075')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000098', 'rtu_no': '00080000000023', 'flmeter_no': '00086000000023', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 44, 12927), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 1, 22, 37), 'min_std_flow_time': datetime.datetime(2019, 5, 19, 1, 21, 28), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 1, 22, 37), 'min_work_flow_time': datetime.datetime(2019, 5, 19, 1, 21, 28), 'max_temperature': '34.1', 'min_temperature': '21.6', 'avg_temperature': '28.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 1, 20, 33), 'min_temp_time': datetime.datetime(2019, 5, 19, 1, 21, 28), 'max_press': '100.9', 'min_press': '93.7', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 5, 30, 1, 20, 19), 'min_press_time': datetime.datetime(2019, 7, 1, 1, 21, 4), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '28.0', 'temp_out': '28.0', 'rssi': '22.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000023å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000027
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000099'}]
0000000099
00086000000027
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000059')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000099', 'rtu_no': '00080000000027', 'flmeter_no': '00086000000027', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 44, 303151), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 1, 20, 41), 'min_std_flow_time': datetime.datetime(2019, 5, 19, 1, 21, 55), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 1, 20, 41), 'min_work_flow_time': datetime.datetime(2019, 5, 19, 1, 21, 55), 'max_temperature': '34.2', 'min_temperature': '21.1', 'avg_temperature': '28.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 1, 20, 34), 'min_temp_time': datetime.datetime(2019, 5, 19, 1, 21, 55), 'max_press': '101.2', 'min_press': '100.2', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 5, 30, 1, 20, 11), 'min_press_time': datetime.datetime(2019, 5, 19, 1, 21, 55), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '28.0', 'temp_out': '28.0', 'rssi': '21.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000027å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000003
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000100'}]
0000000100
00086000000003
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000071')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000100', 'rtu_no': '00080000000003', 'flmeter_no': '00086000000003', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 44, 593375), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 17, 13, 1, 49), 'min_std_flow_time': datetime.datetime(2019, 4, 12, 0, 20, 35), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 17, 13, 1, 49), 'min_work_flow_time': datetime.datetime(2019, 4, 12, 0, 20, 35), 'max_temperature': '22.0', 'min_temperature': '0.0', 'avg_temperature': '6.0', 'max_temp_time': datetime.datetime(2019, 4, 29, 0, 23, 11), 'min_temp_time': datetime.datetime(2019, 4, 12, 0, 20, 35), 'max_press': '103.7', 'min_press': '0.0', 'avg_press': '35.0', 'max_press_time': datetime.datetime(2019, 4, 29, 0, 23, 11), 'min_press_time': datetime.datetime(2019, 4, 12, 0, 20, 35), 'price': '1.4', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 777.0, 'total_buy_volume': None, 'total_buy_money': '4200', 'remain_money': '3423', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '85', 'press_in': '35.0', 'press_out': '35.0', 'temp_in': '6.0', 'temp_out': '6.0', 'rssi': '15.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000003å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000026
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000101'}]
0000000101
00086000000026
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000062')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000101', 'rtu_no': '00080000000026', 'flmeter_no': '00086000000026', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 44, 868639), 'year': '2019', 'std_sum': '5735', 'work_sum': '5834', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 1, 14), 'min_std_flow_time': datetime.datetime(2019, 5, 19, 1, 22, 17), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 1, 14), 'min_work_flow_time': datetime.datetime(2019, 5, 19, 1, 22, 17), 'max_temperature': '35.3', 'min_temperature': '0.0', 'avg_temperature': '27.0', 'max_temp_time': datetime.datetime(2019, 6, 27, 15, 47, 13), 'min_temp_time': datetime.datetime(2019, 7, 1, 14, 6, 51), 'max_press': '104.3', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 7, 30, 1, 21, 12), 'min_press_time': datetime.datetime(2019, 7, 1, 14, 6, 51), 'price': '3.1', 'use_volume_work': '4185.0', 'use_volume_std': '4107.0', 'use_money': '12521.0', 'sum_total_volume': '5735', 'sum_total_money': 17444.0, 'total_buy_volume': None, 'total_buy_money': '27166', 'remain_money': '9722.0', 'remain_volume': None, 'fm_state': '000000000001000000000000000000000000000000000000', 'fm_state_msg': '[å¾…å®š]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '27.0', 'temp_out': '27.0', 'rssi': '23.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000026å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000033
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000102'}]
0000000102
00086000000033
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000049')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000102', 'rtu_no': '00080000000033', 'flmeter_no': '00086000000033', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 45, 143903), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 22, 3, 14, 30), 'min_std_flow_time': datetime.datetime(2019, 6, 23, 16, 20, 50), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 22, 3, 14, 30), 'min_work_flow_time': datetime.datetime(2019, 6, 23, 16, 20, 50), 'max_temperature': '33.4', 'min_temperature': '29.0', 'avg_temperature': '30.0', 'max_temp_time': datetime.datetime(2019, 7, 22, 3, 14, 30), 'min_temp_time': datetime.datetime(2019, 7, 1, 2, 45, 53), 'max_press': '100.6', 'min_press': '99.3', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 6, 29, 3, 20, 12), 'min_press_time': datetime.datetime(2019, 6, 23, 16, 20, 50), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '4', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': '7.3', 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '30.0', 'temp_out': '30.0', 'rssi': '18.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000033å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000032
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000103'}]
0000000103
00086000000032
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000072')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000103', 'rtu_no': '00080000000032', 'flmeter_no': '00086000000032', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 45, 434128), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '77.81', 'min_std_flow': '0.0', 'avg_std_flow': '4.0', 'max_std_flow_time': datetime.datetime(2019, 6, 4, 19, 29, 18), 'min_std_flow_time': datetime.datetime(2019, 6, 4, 10, 51, 46), 'max_work_flow': '80.11', 'min_work_flow': '0.0', 'avg_work_flow': '5.0', 'max_work_flow_time': datetime.datetime(2019, 6, 4, 19, 29, 18), 'min_work_flow_time': datetime.datetime(2019, 6, 4, 10, 51, 46), 'max_temperature': '33.2', 'min_temperature': '0.0', 'avg_temperature': '28.0', 'max_temp_time': datetime.datetime(2019, 7, 27, 1, 35, 39), 'min_temp_time': datetime.datetime(2019, 6, 4, 10, 51, 46), 'max_press': '100.7', 'min_press': '99.3', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 6, 4, 19, 29, 18), 'min_press_time': datetime.datetime(2019, 6, 4, 10, 51, 46), 'price': '3.03', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '27', 'remain_money': '26.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': '7.37', 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '28.0', 'temp_out': '28.0', 'rssi': '22.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000032å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000009
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000104'}]
0000000104
00086000000009
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000064')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000104', 'rtu_no': '00080000000009', 'flmeter_no': '00086000000009', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 45, 670495), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 1, 20, 33), 'min_std_flow_time': datetime.datetime(2019, 5, 7, 1, 20, 59), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 1, 20, 33), 'min_work_flow_time': datetime.datetime(2019, 5, 7, 1, 20, 59), 'max_temperature': '28.7', 'min_temperature': '19.4', 'avg_temperature': '25.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 1, 20, 29), 'min_temp_time': datetime.datetime(2019, 5, 7, 1, 20, 59), 'max_press': '101.7', 'min_press': '87.7', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 5, 29, 1, 21, 16), 'min_press_time': datetime.datetime(2019, 7, 1, 1, 21, 18), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '25.0', 'temp_out': '25.0', 'rssi': '23.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000009å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000011
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000105'}]
0000000105
00086000000011
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000061')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000105', 'rtu_no': '00080000000011', 'flmeter_no': '00086000000011', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 45, 929801), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 0, 21, 1), 'min_std_flow_time': datetime.datetime(2019, 4, 19, 0, 20, 21), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 0, 21, 1), 'min_work_flow_time': datetime.datetime(2019, 4, 19, 0, 20, 21), 'max_temperature': '27.5', 'min_temperature': '17.0', 'avg_temperature': '22.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 0, 20, 44), 'min_temp_time': datetime.datetime(2019, 4, 19, 0, 20, 21), 'max_press': '110.5', 'min_press': '100.6', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 6, 29, 0, 21, 17), 'min_press_time': datetime.datetime(2019, 4, 19, 0, 20, 21), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '56.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000011å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000028
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000106'}]
0000000106
00086000000028
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000073')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000106', 'rtu_no': '00080000000028', 'flmeter_no': '00086000000028', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 46, 194111), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '39.98', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 20, 10, 46, 55), 'min_std_flow_time': datetime.datetime(2019, 5, 19, 1, 21, 30), 'max_work_flow': '39.98', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 20, 10, 46, 55), 'min_work_flow_time': datetime.datetime(2019, 5, 19, 1, 21, 30), 'max_temperature': '32.9', 'min_temperature': '0.0', 'avg_temperature': '27.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 1, 22, 28), 'min_temp_time': datetime.datetime(2019, 6, 1, 1, 20, 39), 'max_press': '103.5', 'min_press': '0.0', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 8, 10, 1, 22, 54), 'min_press_time': datetime.datetime(2019, 6, 1, 1, 20, 39), 'price': '2.38', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '3.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '27.0', 'temp_out': '27.0', 'rssi': '19.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000028å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000021
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000107'}]
0000000107
00086000000021
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000047')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000107', 'rtu_no': '00080000000021', 'flmeter_no': '00086000000021', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 46, 477338), 'year': '2019', 'std_sum': '53', 'work_sum': '52', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 7, 17, 33, 5), 'min_std_flow_time': datetime.datetime(2019, 4, 27, 0, 21, 37), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 7, 17, 33, 5), 'min_work_flow_time': datetime.datetime(2019, 4, 27, 0, 21, 37), 'max_temperature': '27.6', 'min_temperature': '11.9', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 5, 7, 17, 33, 5), 'min_temp_time': datetime.datetime(2019, 4, 27, 0, 21, 37), 'max_press': '104.5', 'min_press': '12.7', 'avg_press': '70.0', 'max_press_time': datetime.datetime(2019, 4, 29, 0, 21), 'min_press_time': datetime.datetime(2019, 5, 1, 0, 20, 41), 'price': '3.03', 'use_volume_work': '26.0', 'use_volume_std': '26.0', 'use_money': '78.78', 'sum_total_volume': '53', 'sum_total_money': 163.0, 'total_buy_volume': None, 'total_buy_money': '3150', 'remain_money': '2987', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '70.0', 'press_out': '70.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '21.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000021å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00086000000024
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000108'}]
0000000108
00086000000024
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0008', '00082019080000000076')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0008', 'sry_id': '00082019080000000108', 'rtu_no': '00080000000024', 'flmeter_no': '00086000000024', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 46, 757588), 'year': '2019', 'std_sum': '1686', 'work_sum': '1720', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 1, 23, 2), 'min_std_flow_time': datetime.datetime(2019, 5, 19, 1, 20, 40), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 1, 23, 2), 'min_work_flow_time': datetime.datetime(2019, 5, 19, 1, 20, 40), 'max_temperature': '32.2', 'min_temperature': '20.7', 'avg_temperature': '25.0', 'max_temp_time': datetime.datetime(2019, 7, 29, 1, 20, 35), 'min_temp_time': datetime.datetime(2019, 6, 1, 1, 20, 36), 'max_press': '110.6', 'min_press': '100.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 6, 29, 1, 21, 9), 'min_press_time': datetime.datetime(2019, 5, 19, 1, 20, 40), 'price': '3.1', 'use_volume_work': '1596.0', 'use_volume_std': '1566.0', 'use_money': '4768.99', 'sum_total_volume': '1686', 'sum_total_money': 5131.0, 'total_buy_volume': None, 'total_buy_money': '8000', 'remain_money': '2869.0', 'remain_volume': None, 'fm_state': '000000000001000000000000000000000000000000000000', 'fm_state_msg': '[å¾…å®š]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '25.0', 'temp_out': '25.0', 'rssi': '18.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00086000000024å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
0008 data_processing is ok
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0015
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 6
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0015 2019 å¼€å§‹è¿›è¡Œè®¡ç®—å¹´æŠ¥è¡¨æ•°æ®å¤„ç†
ä¸åŒçš„è¡¨è®¡å·å…±æœ‰ä¸ªæ•°: 1
æ ¹æ®è¡¨è®¡å·ï¼Œè¿›è¡Œæ•°æ®çš„å†æ¬¡ç­›é€‰ï¼Œå¤„ç†ï¼Œå†™å…¥æ•°æ®åº“
----------------------------------------------------------------------------------------
00156000000001
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 6
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0015', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0015', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000003'}]
0000000003
00156000000001
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0015', '00152019080000000002')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0015', 'sry_id': '00152019080000000003', 'rtu_no': '00150000000001', 'flmeter_no': '00156000000001', 'customer_no': '00150000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 47, 108649), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 1, 16), 'min_std_flow_time': datetime.datetime(2019, 3, 12, 16, 42, 13), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 1, 16), 'min_work_flow_time': datetime.datetime(2019, 3, 12, 16, 42, 13), 'max_temperature': '32.3', 'min_temperature': '0.0', 'avg_temperature': '23.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 23, 33, 37), 'min_temp_time': datetime.datetime(2019, 3, 12, 16, 42, 13), 'max_press': '99.9', 'min_press': '0.0', 'avg_press': '97.0', 'max_press_time': datetime.datetime(2019, 6, 29, 23, 48, 36), 'min_press_time': datetime.datetime(2019, 3, 12, 16, 42, 13), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 15.0, 'total_buy_volume': None, 'total_buy_money': '20', 'remain_money': '5.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '97.0', 'press_out': '97.0', 'temp_in': '23.0', 'temp_out': '23.0', 'rssi': '20.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00156000000001å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
0015 data_processing is ok
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0020
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0020 2019 æœŸé—´æ— SCADA_REPORT_MONTHLYæ•°æ®ï¼Œè¯·ç­‰å¾…é‡æ–°è®¡ç®—å¹´æŠ¥è¡¨
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0017
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 146
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0017 2019 å¼€å§‹è¿›è¡Œè®¡ç®—å¹´æŠ¥è¡¨æ•°æ®å¤„ç†
ä¸åŒçš„è¡¨è®¡å·å…±æœ‰ä¸ªæ•°: 91
æ ¹æ®è¡¨è®¡å·ï¼Œè¿›è¡Œæ•°æ®çš„å†æ¬¡ç­›é€‰ï¼Œå¤„ç†ï¼Œå†™å…¥æ•°æ®åº“
----------------------------------------------------------------------------------------
00176000000016
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000183'}]
0000000183
00176000000016
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000170')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000183', 'rtu_no': None, 'flmeter_no': '00176000000016', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 47, 590362), 'year': '2019', 'std_sum': '1064282.003', 'work_sum': '544275.627', 'max_std_flow': '331.93', 'min_std_flow': '0.0', 'avg_std_flow': '65.0', 'max_std_flow_time': datetime.datetime(2019, 4, 20, 16, 28, 43), 'min_std_flow_time': datetime.datetime(2019, 4, 10, 5, 19, 26), 'max_work_flow': '58.65', 'min_work_flow': '0.0', 'avg_work_flow': '33.0', 'max_work_flow_time': datetime.datetime(2019, 5, 1, 0, 30, 19), 'min_work_flow_time': datetime.datetime(2019, 4, 10, 5, 19, 26), 'max_temperature': '18.38', 'min_temperature': '14.05', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 4, 20, 16, 28, 43), 'min_temp_time': datetime.datetime(2019, 5, 1, 3, 42, 35), 'max_press': '201.68', 'min_press': '192.76', 'avg_press': '197.0', 'max_press_time': datetime.datetime(2019, 4, 20, 16, 28, 43), 'min_press_time': datetime.datetime(2019, 4, 10, 5, 19, 26), 'price': '0.000', 'use_volume_work': '16396.71', 'use_volume_std': '32244.13', 'use_money': '0.0', 'sum_total_volume': '1064282.003', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '197.0', 'press_out': '197.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000016å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000089
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000184'}]
0000000184
00176000000089
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000151')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000184', 'rtu_no': None, 'flmeter_no': '00176000000089', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 47, 909507), 'year': '2019', 'std_sum': '60355.000', 'work_sum': '46468.000', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 3, 16, 31, 51), 'min_std_flow_time': datetime.datetime(2019, 4, 16, 7, 57, 18), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 3, 16, 31, 51), 'min_work_flow_time': datetime.datetime(2019, 4, 16, 7, 57, 18), 'max_temperature': '20.1', 'min_temperature': '15.7', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 5, 3, 16, 31, 51), 'min_temp_time': datetime.datetime(2019, 4, 16, 7, 57, 18), 'max_press': '135.2', 'min_press': '131.8', 'avg_press': '133.0', 'max_press_time': datetime.datetime(2019, 4, 15, 5, 27, 56), 'min_press_time': datetime.datetime(2019, 5, 1, 8, 1, 59), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '60355.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '133.0', 'press_out': '133.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000089å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000072
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000185'}]
0000000185
00176000000072
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000182')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000185', 'rtu_no': None, 'flmeter_no': '00176000000072', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 48, 194745), 'year': '2019', 'std_sum': '3179008.020', 'work_sum': '2804226.299', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 5, 5, 25, 23), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 10, 18, 17), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 5, 5, 25, 23), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 10, 18, 17), 'max_temperature': '37.63', 'min_temperature': '10.17', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 5, 5, 5, 25, 23), 'min_temp_time': datetime.datetime(2019, 5, 1, 4, 8, 33), 'max_press': '112.1', 'min_press': '110.8', 'avg_press': '111.0', 'max_press_time': datetime.datetime(2019, 4, 17, 7, 33), 'min_press_time': datetime.datetime(2019, 5, 1, 4, 8, 33), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '3179008.020', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '111.0', 'press_out': '111.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000072å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000100
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000186'}]
0000000186
00176000000100
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000174')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000186', 'rtu_no': None, 'flmeter_no': '00176000000100', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 48, 476990), 'year': '2019', 'std_sum': '1157325.000', 'work_sum': '962573.000', 'max_std_flow': '97.03', 'min_std_flow': '0.0', 'avg_std_flow': '46.0', 'max_std_flow_time': datetime.datetime(2019, 4, 17, 9, 29, 48), 'min_std_flow_time': datetime.datetime(2019, 4, 20, 13, 8, 23), 'max_work_flow': '96.81', 'min_work_flow': '0.0', 'avg_work_flow': '38.0', 'max_work_flow_time': datetime.datetime(2019, 5, 8, 5, 37, 34), 'min_work_flow_time': datetime.datetime(2019, 4, 20, 13, 8, 23), 'max_temperature': '28.1', 'min_temperature': '12.6', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 4, 17, 9, 29, 48), 'min_temp_time': datetime.datetime(2019, 4, 20, 13, 8, 23), 'max_press': '121.5', 'min_press': '116.1', 'avg_press': '119.0', 'max_press_time': datetime.datetime(2019, 4, 17, 9, 29, 48), 'min_press_time': datetime.datetime(2019, 5, 1, 13, 12, 13), 'price': '0.000', 'use_volume_work': '15133.0', 'use_volume_std': '17907.0', 'use_money': '0.0', 'sum_total_volume': '1157325.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '119.0', 'press_out': '119.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000100å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000051
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000187'}]
0000000187
00176000000051
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000142')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000187', 'rtu_no': None, 'flmeter_no': '00176000000051', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 48, 757250), 'year': '2019', 'std_sum': '161264.160', 'work_sum': '155795.440', 'max_std_flow': '28.4', 'min_std_flow': '0.0', 'avg_std_flow': '4.0', 'max_std_flow_time': datetime.datetime(2019, 4, 16, 9, 13, 14), 'min_std_flow_time': datetime.datetime(2019, 4, 13, 17, 24), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 16, 9, 13, 14), 'min_work_flow_time': datetime.datetime(2019, 4, 13, 17, 24), 'max_temperature': '15.1', 'min_temperature': '13.0', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 4, 16, 9, 13, 14), 'min_temp_time': datetime.datetime(2019, 4, 13, 17, 24), 'max_press': '104.1', 'min_press': '103.1', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 4, 16, 9, 13, 14), 'min_press_time': datetime.datetime(2019, 4, 13, 17, 24), 'price': '0.000', 'use_volume_work': '176.4', 'use_volume_std': '184.15', 'use_money': '0.0', 'sum_total_volume': '161264.160', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000051å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000106
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000188'}]
0000000188
00176000000106
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000099')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000188', 'rtu_no': None, 'flmeter_no': '00176000000106', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 49, 59437), 'year': '2019', 'std_sum': '211726.000', 'work_sum': '209449.000', 'max_std_flow': '27.58', 'min_std_flow': '0.0', 'avg_std_flow': '7.0', 'max_std_flow_time': datetime.datetime(2019, 5, 10, 8, 56, 47), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 18, 56, 49), 'max_work_flow': '27.14', 'min_work_flow': '0.0', 'avg_work_flow': '7.0', 'max_work_flow_time': datetime.datetime(2019, 5, 10, 8, 56, 47), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 18, 56, 49), 'max_temperature': '24.3', 'min_temperature': '18.1', 'avg_temperature': '21.0', 'max_temp_time': datetime.datetime(2019, 5, 10, 8, 56, 47), 'min_temp_time': datetime.datetime(2019, 4, 14, 18, 56, 49), 'max_press': '104.3', 'min_press': '102.6', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 4, 19, 9, 40, 23), 'min_press_time': datetime.datetime(2019, 4, 14, 18, 56, 49), 'price': '0.000', 'use_volume_work': '3108.0', 'use_volume_std': '3157.0', 'use_money': '0.0', 'sum_total_volume': '211726.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000106å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000122
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000189'}]
0000000189
00176000000122
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000110')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000189', 'rtu_no': None, 'flmeter_no': '00176000000122', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 49, 362622), 'year': '2019', 'std_sum': '801827.000', 'work_sum': '698820.000', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 21, 0, 42, 48), 'min_std_flow_time': datetime.datetime(2019, 4, 13, 17, 25, 31), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 21, 0, 42, 48), 'min_work_flow_time': datetime.datetime(2019, 4, 13, 17, 25, 31), 'max_temperature': '19.7', 'min_temperature': '15.5', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 4, 21, 0, 42, 48), 'min_temp_time': datetime.datetime(2019, 4, 13, 17, 25, 31), 'max_press': '115.4', 'min_press': '113.4', 'avg_press': '114.0', 'max_press_time': datetime.datetime(2019, 4, 21, 0, 42, 48), 'min_press_time': datetime.datetime(2019, 4, 13, 17, 25, 31), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '801827.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '114.0', 'press_out': '114.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000122å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000003
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000190'}]
0000000190
00176000000003
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000149')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000190', 'rtu_no': None, 'flmeter_no': '00176000000003', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 49, 655838), 'year': '2019', 'std_sum': '10394.077', 'work_sum': '1510.000', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 20, 9, 46, 12), 'min_std_flow_time': datetime.datetime(2019, 4, 1, 21, 40, 53), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 20, 9, 46, 12), 'min_work_flow_time': datetime.datetime(2019, 4, 1, 21, 40, 53), 'max_temperature': '27.32', 'min_temperature': '6.47', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 4, 20, 9, 46, 12), 'min_temp_time': datetime.datetime(2019, 4, 1, 21, 40, 53), 'max_press': '115.57', 'min_press': '107.14', 'avg_press': '113.0', 'max_press_time': datetime.datetime(2019, 4, 20, 9, 46, 12), 'min_press_time': datetime.datetime(2019, 4, 1, 21, 40, 53), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '10394.077', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '113.0', 'press_out': '113.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000003å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000095
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000191'}]
0000000191
00176000000095
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000125')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000191', 'rtu_no': None, 'flmeter_no': '00176000000095', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 50, 3907), 'year': '2019', 'std_sum': '813268.139', 'work_sum': '789434.100', 'max_std_flow': '46.41', 'min_std_flow': '0.0', 'avg_std_flow': '12.0', 'max_std_flow_time': datetime.datetime(2019, 5, 16, 4, 17, 23), 'min_std_flow_time': datetime.datetime(2019, 5, 14, 2, 57, 16), 'max_work_flow': '46.19', 'min_work_flow': '0.0', 'avg_work_flow': '12.0', 'max_work_flow_time': datetime.datetime(2019, 5, 16, 4, 17, 23), 'min_work_flow_time': datetime.datetime(2019, 5, 14, 2, 57, 16), 'max_temperature': '25.25', 'min_temperature': '18.24', 'avg_temperature': '21.0', 'max_temp_time': datetime.datetime(2019, 5, 16, 4, 17, 23), 'min_temp_time': datetime.datetime(2019, 5, 14, 2, 57, 16), 'max_press': '103.4', 'min_press': '100.04', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 5, 16, 4, 17, 23), 'min_press_time': datetime.datetime(2019, 5, 14, 2, 57, 16), 'price': '0.000', 'use_volume_work': '1846.5', 'use_volume_std': '1857.77', 'use_money': '0.0', 'sum_total_volume': '813268.139', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000095å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000113
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000192'}]
0000000192
00176000000113
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000152')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000192', 'rtu_no': None, 'flmeter_no': '00176000000113', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 50, 288149), 'year': '2019', 'std_sum': '1512012.000', 'work_sum': '1393338.000', 'max_std_flow': '308.25', 'min_std_flow': '0.0', 'avg_std_flow': '53.0', 'max_std_flow_time': datetime.datetime(2019, 5, 4, 8, 16, 25), 'min_std_flow_time': datetime.datetime(2019, 4, 13, 21, 13, 18), 'max_work_flow': '286.41', 'min_work_flow': '0.0', 'avg_work_flow': '49.0', 'max_work_flow_time': datetime.datetime(2019, 5, 4, 8, 16, 25), 'min_work_flow_time': datetime.datetime(2019, 4, 13, 21, 13, 18), 'max_temperature': '27.2', 'min_temperature': '17.3', 'avg_temperature': '21.0', 'max_temp_time': datetime.datetime(2019, 4, 16, 6, 51, 27), 'min_temp_time': datetime.datetime(2019, 4, 13, 21, 13, 18), 'max_press': '111.3', 'min_press': '108.3', 'avg_press': '109.0', 'max_press_time': datetime.datetime(2019, 5, 4, 8, 16, 25), 'min_press_time': datetime.datetime(2019, 4, 13, 21, 13, 18), 'price': '0.000', 'use_volume_work': '17993.0', 'use_volume_std': '19414.0', 'use_money': '0.0', 'sum_total_volume': '1512012.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '109.0', 'press_out': '109.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000113å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000019
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000193'}]
0000000193
00176000000019
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000135')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000193', 'rtu_no': None, 'flmeter_no': '00176000000019', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 50, 637214), 'year': '2019', 'std_sum': '4722617.000', 'work_sum': '4398987.000', 'max_std_flow': '275.96', 'min_std_flow': '9.24', 'avg_std_flow': '81.0', 'max_std_flow_time': datetime.datetime(2019, 4, 11, 8, 53, 26), 'min_std_flow_time': datetime.datetime(2019, 4, 7, 23, 55, 41), 'max_work_flow': '252.59', 'min_work_flow': '8.65', 'avg_work_flow': '75.0', 'max_work_flow_time': datetime.datetime(2019, 4, 11, 8, 53, 26), 'min_work_flow_time': datetime.datetime(2019, 4, 7, 23, 55, 41), 'max_temperature': '18.2', 'min_temperature': '11.0', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 4, 11, 8, 53, 26), 'min_temp_time': datetime.datetime(2019, 4, 7, 23, 55, 41), 'max_press': '110.6', 'min_press': '107.0', 'avg_press': '108.0', 'max_press_time': datetime.datetime(2019, 4, 11, 8, 53, 26), 'min_press_time': datetime.datetime(2019, 4, 7, 23, 55, 41), 'price': '0.000', 'use_volume_work': '8553.0', 'use_volume_std': '9259.0', 'use_money': '0.0', 'sum_total_volume': '4722617.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '108.0', 'press_out': '108.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000019å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000115
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000194'}]
0000000194
00176000000115
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000103')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000194', 'rtu_no': None, 'flmeter_no': '00176000000115', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 50, 937412), 'year': '2019', 'std_sum': '2223709.000', 'work_sum': '1808188.000', 'max_std_flow': '539.88', 'min_std_flow': '0.0', 'avg_std_flow': '97.0', 'max_std_flow_time': datetime.datetime(2019, 5, 2, 8, 40, 19), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 13, 6, 15), 'max_work_flow': '429.57', 'min_work_flow': '0.0', 'avg_work_flow': '78.0', 'max_work_flow_time': datetime.datetime(2019, 5, 2, 8, 40, 19), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 13, 6, 15), 'max_temperature': '27.7', 'min_temperature': '14.4', 'avg_temperature': '21.0', 'max_temp_time': datetime.datetime(2019, 5, 2, 8, 40, 19), 'min_temp_time': datetime.datetime(2019, 5, 1, 19, 47, 34), 'max_press': '128.5', 'min_press': '124.9', 'avg_press': '126.0', 'max_press_time': datetime.datetime(2019, 4, 15, 13, 48, 20), 'min_press_time': datetime.datetime(2019, 4, 14, 13, 6, 15), 'price': '0.000', 'use_volume_work': '32995.0', 'use_volume_std': '40698.0', 'use_money': '0.0', 'sum_total_volume': '2223709.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '126.0', 'press_out': '126.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000115å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000008
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000195'}]
0000000195
00176000000008
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000161')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000195', 'rtu_no': None, 'flmeter_no': '00176000000008', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 51, 236613), 'year': '2019', 'std_sum': '1882204.000', 'work_sum': '410218.000', 'max_std_flow': '165.89', 'min_std_flow': '0.0', 'avg_std_flow': '22.0', 'max_std_flow_time': datetime.datetime(2019, 4, 7, 15, 40, 33), 'min_std_flow_time': datetime.datetime(2019, 4, 1, 20, 47, 49), 'max_work_flow': '34.86', 'min_work_flow': '0.0', 'avg_work_flow': '4.0', 'max_work_flow_time': datetime.datetime(2019, 4, 7, 15, 40, 33), 'min_work_flow_time': datetime.datetime(2019, 4, 1, 20, 47, 49), 'max_temperature': '34.5', 'min_temperature': '10.2', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 4, 7, 15, 40, 33), 'min_temp_time': datetime.datetime(2019, 4, 1, 20, 47, 49), 'max_press': '491.5', 'min_press': '471.7', 'avg_press': '483.0', 'max_press_time': datetime.datetime(2019, 4, 7, 15, 40, 33), 'min_press_time': datetime.datetime(2019, 4, 1, 20, 47, 49), 'price': '0.000', 'use_volume_work': '2100.0', 'use_volume_std': '10161.0', 'use_money': '0.0', 'sum_total_volume': '1882204.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '483.0', 'press_out': '483.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000008å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000033
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000196'}]
0000000196
00176000000033
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000100')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000196', 'rtu_no': None, 'flmeter_no': '00176000000033', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 51, 571715), 'year': '2019', 'std_sum': '61772573.216', 'work_sum': '6820309.340', 'max_std_flow': '2735.5', 'min_std_flow': '0.0', 'avg_std_flow': '1217.0', 'max_std_flow_time': datetime.datetime(2019, 4, 15, 10, 42, 27), 'min_std_flow_time': datetime.datetime(2019, 4, 19, 3, 41), 'max_work_flow': '415.05', 'min_work_flow': '0.0', 'avg_work_flow': '182.0', 'max_work_flow_time': datetime.datetime(2019, 4, 15, 10, 42, 27), 'min_work_flow_time': datetime.datetime(2019, 4, 19, 3, 41), 'max_temperature': '21.65', 'min_temperature': '14.48', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 4, 15, 10, 42, 27), 'min_temp_time': datetime.datetime(2019, 4, 19, 3, 41), 'max_press': '668.19', 'min_press': '649.97', 'avg_press': '659.0', 'max_press_time': datetime.datetime(2019, 4, 15, 10, 42, 27), 'min_press_time': datetime.datetime(2019, 4, 19, 3, 41), 'price': '0.000', 'use_volume_work': '30264.32', 'use_volume_std': '202238.43', 'use_money': '0.0', 'sum_total_volume': '61772573.216', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '659.0', 'press_out': '659.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000033å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000058
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000197'}]
0000000197
00176000000058
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000111')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000197', 'rtu_no': None, 'flmeter_no': '00176000000058', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 51, 858947), 'year': '2019', 'std_sum': '1761537.950', 'work_sum': '1662035.880', 'max_std_flow': '127.9', 'min_std_flow': '13.5', 'avg_std_flow': '49.0', 'max_std_flow_time': datetime.datetime(2019, 5, 2, 7, 18, 46), 'min_std_flow_time': datetime.datetime(2019, 5, 2, 10, 31, 12), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 2, 7, 18, 46), 'min_work_flow_time': datetime.datetime(2019, 4, 13, 11, 32, 34), 'max_temperature': '26.6', 'min_temperature': '12.9', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 5, 2, 7, 18, 46), 'min_temp_time': datetime.datetime(2019, 4, 13, 11, 32, 34), 'max_press': '107.3', 'min_press': '105.5', 'avg_press': '106.0', 'max_press_time': datetime.datetime(2019, 4, 15, 6, 58, 24), 'min_press_time': datetime.datetime(2019, 4, 13, 11, 32, 34), 'price': '0.000', 'use_volume_work': '3636.66', 'use_volume_std': '3851.63', 'use_money': '0.0', 'sum_total_volume': '1761537.950', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '106.0', 'press_out': '106.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000058å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000040
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000198'}]
0000000198
00176000000040
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000140')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000198', 'rtu_no': None, 'flmeter_no': '00176000000040', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 52, 122244), 'year': '2019', 'std_sum': '3007606.380', 'work_sum': '2551154.770', 'max_std_flow': '181.9', 'min_std_flow': '0.0', 'avg_std_flow': '26.0', 'max_std_flow_time': datetime.datetime(2019, 4, 14, 15, 30, 14), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 10, 33, 34), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 3, 6, 44, 49), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 10, 33, 34), 'max_temperature': '22.9', 'min_temperature': '14.1', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 5, 3, 6, 44, 49), 'min_temp_time': datetime.datetime(2019, 4, 14, 10, 33, 34), 'max_press': '119.4', 'min_press': '117.4', 'avg_press': '118.0', 'max_press_time': datetime.datetime(2019, 5, 3, 6, 44, 49), 'min_press_time': datetime.datetime(2019, 4, 14, 10, 33, 34), 'price': '0.000', 'use_volume_work': '3681.91', 'use_volume_std': '4314.41', 'use_money': '0.0', 'sum_total_volume': '3007606.380', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '118.0', 'press_out': '118.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000040å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000076
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000199'}]
0000000199
00176000000076
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000129')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000199', 'rtu_no': None, 'flmeter_no': '00176000000076', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 52, 420452), 'year': '2019', 'std_sum': '12141034.073', 'work_sum': '9392121.593', 'max_std_flow': '808.0', 'min_std_flow': '0.0', 'avg_std_flow': '467.0', 'max_std_flow_time': datetime.datetime(2019, 4, 14, 12, 37, 28), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 9, 9, 18), 'max_work_flow': '617.94', 'min_work_flow': '0.0', 'avg_work_flow': '356.0', 'max_work_flow_time': datetime.datetime(2019, 4, 14, 12, 37, 28), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 9, 9, 18), 'max_temperature': '19.38', 'min_temperature': '15.47', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 4, 14, 12, 37, 28), 'min_temp_time': datetime.datetime(2019, 4, 14, 9, 9, 18), 'max_press': '134.28', 'min_press': '131.34', 'avg_press': '131.0', 'max_press_time': datetime.datetime(2019, 4, 14, 12, 37, 28), 'min_press_time': datetime.datetime(2019, 4, 14, 9, 9, 18), 'price': '0.000', 'use_volume_work': '6100.09', 'use_volume_std': '8002.6', 'use_money': '0.0', 'sum_total_volume': '12141034.073', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '131.0', 'press_out': '131.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000076å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000093
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000200'}]
0000000200
00176000000093
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000167')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000200', 'rtu_no': None, 'flmeter_no': '00176000000093', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 52, 700696), 'year': '2019', 'std_sum': '2618287.000', 'work_sum': '2099162.000', 'max_std_flow': '337.77', 'min_std_flow': '0.0', 'avg_std_flow': '102.0', 'max_std_flow_time': datetime.datetime(2019, 4, 16, 8, 19, 39), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 13, 0, 9), 'max_work_flow': '270.7', 'min_work_flow': '0.0', 'avg_work_flow': '81.0', 'max_work_flow_time': datetime.datetime(2019, 4, 16, 8, 19, 39), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 13, 0, 9), 'max_temperature': '21.5', 'min_temperature': '12.2', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 4, 16, 8, 19, 39), 'min_temp_time': datetime.datetime(2019, 4, 14, 13, 0, 9), 'max_press': '128.7', 'min_press': '112.3', 'avg_press': '125.0', 'max_press_time': datetime.datetime(2019, 4, 16, 8, 19, 39), 'min_press_time': datetime.datetime(2019, 4, 14, 13, 0, 9), 'price': '0.000', 'use_volume_work': '5303.0', 'use_volume_std': '6625.0', 'use_money': '0.0', 'sum_total_volume': '2618287.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '125.0', 'press_out': '125.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000093å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000060
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000201'}]
0000000201
00176000000060
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000092')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000201', 'rtu_no': None, 'flmeter_no': '00176000000060', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 53, 11868), 'year': '2019', 'std_sum': '1264041.030', 'work_sum': '1145389.920', 'max_std_flow': '76.8', 'min_std_flow': '0.0', 'avg_std_flow': '7.0', 'max_std_flow_time': datetime.datetime(2019, 4, 14, 18, 8, 10), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 9, 10, 45), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 14, 18, 8, 10), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 9, 10, 45), 'max_temperature': '21.2', 'min_temperature': '16.2', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 4, 14, 18, 8, 10), 'min_temp_time': datetime.datetime(2019, 4, 14, 9, 10, 45), 'max_press': '112.4', 'min_press': '110.2', 'avg_press': '111.0', 'max_press_time': datetime.datetime(2019, 4, 14, 18, 8, 10), 'min_press_time': datetime.datetime(2019, 4, 14, 9, 10, 45), 'price': '0.000', 'use_volume_work': '603.46', 'use_volume_std': '664.67', 'use_money': '0.0', 'sum_total_volume': '1264041.030', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '111.0', 'press_out': '111.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000060å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000038
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000202'}]
0000000202
00176000000038
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000102')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000202', 'rtu_no': None, 'flmeter_no': '00176000000038', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 53, 334999), 'year': '2019', 'std_sum': '0.000', 'work_sum': '0.000', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 5, 20, 33, 59), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 9, 20, 38), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 5, 20, 33, 59), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 9, 20, 38), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 5, 5, 20, 33, 59), 'min_temp_time': datetime.datetime(2019, 4, 14, 9, 20, 38), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 5, 5, 20, 33, 59), 'min_press_time': datetime.datetime(2019, 4, 14, 9, 20, 38), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000038å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000064
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000203'}]
0000000203
00176000000064
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000180')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000203', 'rtu_no': None, 'flmeter_no': '00176000000064', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 53, 688056), 'year': '2019', 'std_sum': '2148414.980', 'work_sum': '1760732.410', 'max_std_flow': '164.9', 'min_std_flow': '0.0', 'avg_std_flow': '81.0', 'max_std_flow_time': datetime.datetime(2019, 4, 16, 11, 9, 21), 'min_std_flow_time': datetime.datetime(2019, 4, 15, 21, 36, 28), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 16, 11, 9, 21), 'min_work_flow_time': datetime.datetime(2019, 4, 15, 21, 36, 28), 'max_temperature': '27.5', 'min_temperature': '20.5', 'avg_temperature': '24.0', 'max_temp_time': datetime.datetime(2019, 4, 16, 11, 9, 21), 'min_temp_time': datetime.datetime(2019, 4, 15, 21, 36, 28), 'max_press': '128.5', 'min_press': '124.9', 'avg_press': '126.0', 'max_press_time': datetime.datetime(2019, 4, 16, 11, 9, 21), 'min_press_time': datetime.datetime(2019, 4, 15, 21, 36, 28), 'price': '0.000', 'use_volume_work': '4637.5', 'use_volume_std': '5690.19', 'use_money': '0.0', 'sum_total_volume': '2148414.980', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '126.0', 'press_out': '126.0', 'temp_in': '24.0', 'temp_out': '24.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000064å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000114
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000204'}]
0000000204
00176000000114
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000109')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000204', 'rtu_no': None, 'flmeter_no': '00176000000114', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 53, 966312), 'year': '2019', 'std_sum': '148147.000', 'work_sum': '146449.000', 'max_std_flow': '0.59', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 13, 19, 9, 22), 'min_std_flow_time': datetime.datetime(2019, 4, 13, 23, 26, 45), 'max_work_flow': '0.58', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 13, 19, 9, 22), 'min_work_flow_time': datetime.datetime(2019, 4, 13, 23, 26, 45), 'max_temperature': '24.4', 'min_temperature': '14.9', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 4, 13, 19, 9, 22), 'min_temp_time': datetime.datetime(2019, 4, 13, 23, 26, 45), 'max_press': '120.3', 'min_press': '102.1', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 4, 13, 19, 9, 22), 'min_press_time': datetime.datetime(2019, 4, 13, 23, 26, 45), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '148147.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000114å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000108
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000205'}]
0000000205
00176000000108
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000131')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000205', 'rtu_no': None, 'flmeter_no': '00176000000108', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 54, 264518), 'year': '2019', 'std_sum': '860605.016', 'work_sum': '820938.023', 'max_std_flow': '91.68', 'min_std_flow': '0.0', 'avg_std_flow': '17.0', 'max_std_flow_time': datetime.datetime(2019, 4, 14, 10, 10, 23), 'min_std_flow_time': datetime.datetime(2019, 4, 15, 21, 42, 2), 'max_work_flow': '87.48', 'min_work_flow': '0.0', 'avg_work_flow': '16.0', 'max_work_flow_time': datetime.datetime(2019, 4, 14, 10, 10, 23), 'min_work_flow_time': datetime.datetime(2019, 4, 15, 21, 42, 2), 'max_temperature': '25.88', 'min_temperature': '17.55', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 5, 2, 10, 43, 47), 'min_temp_time': datetime.datetime(2019, 4, 15, 21, 42, 2), 'max_press': '106.93', 'min_press': '104.2', 'avg_press': '105.0', 'max_press_time': datetime.datetime(2019, 4, 14, 10, 10, 23), 'min_press_time': datetime.datetime(2019, 4, 15, 21, 42, 2), 'price': '0.000', 'use_volume_work': '3934.0', 'use_volume_std': '4064.27', 'use_money': '0.0', 'sum_total_volume': '860605.016', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '105.0', 'press_out': '105.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000108å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000127
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000206'}]
0000000206
00176000000127
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000157')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000206', 'rtu_no': None, 'flmeter_no': '00176000000127', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 54, 610593), 'year': '2019', 'std_sum': '2532275.415', 'work_sum': '2078661.189', 'max_std_flow': '448.44', 'min_std_flow': '9.5', 'avg_std_flow': '93.0', 'max_std_flow_time': datetime.datetime(2019, 5, 6, 22, 49, 38), 'min_std_flow_time': datetime.datetime(2019, 5, 5, 18, 58, 6), 'max_work_flow': '364.9', 'min_work_flow': '7.59', 'avg_work_flow': '76.0', 'max_work_flow_time': datetime.datetime(2019, 5, 6, 22, 49, 38), 'min_work_flow_time': datetime.datetime(2019, 5, 5, 18, 58, 6), 'max_temperature': '34.14', 'min_temperature': '11.56', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 5, 6, 22, 49, 38), 'min_temp_time': datetime.datetime(2019, 5, 5, 18, 58, 6), 'max_press': '126.42', 'min_press': '122.74', 'avg_press': '124.0', 'max_press_time': datetime.datetime(2019, 4, 15, 3, 1, 24), 'min_press_time': datetime.datetime(2019, 4, 13, 11, 29, 19), 'price': '0.000', 'use_volume_work': '26369.66', 'use_volume_std': '32565.54', 'use_money': '0.0', 'sum_total_volume': '2532275.415', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '124.0', 'press_out': '124.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000127å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000036
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000207'}]
0000000207
00176000000036
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000118')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000207', 'rtu_no': None, 'flmeter_no': '00176000000036', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 54, 994563), 'year': '2019', 'std_sum': '2540394.000', 'work_sum': '1668455.000', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 13, 10, 37, 58), 'min_std_flow_time': datetime.datetime(2019, 4, 13, 10, 37, 58), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 13, 10, 37, 58), 'min_work_flow_time': datetime.datetime(2019, 4, 13, 10, 37, 58), 'max_temperature': '16.2', 'min_temperature': '16.2', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 4, 13, 10, 37, 58), 'min_temp_time': datetime.datetime(2019, 4, 13, 10, 37, 58), 'max_press': '146.6', 'min_press': '146.6', 'avg_press': '146.0', 'max_press_time': datetime.datetime(2019, 4, 13, 10, 37, 58), 'min_press_time': datetime.datetime(2019, 4, 13, 10, 37, 58), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '2540394.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '146.0', 'press_out': '146.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000036å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000081
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000208'}]
0000000208
00176000000081
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000097')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000208', 'rtu_no': None, 'flmeter_no': '00176000000081', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 55, 259853), 'year': '2019', 'std_sum': '4090866.000', 'work_sum': '2595286.000', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 9, 3, 22, 49), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 10, 19), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 9, 3, 22, 49), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 10, 19), 'max_temperature': '15.5', 'min_temperature': '15.5', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 5, 9, 3, 22, 49), 'min_temp_time': datetime.datetime(2019, 4, 14, 10, 19), 'max_press': '167.8', 'min_press': '167.8', 'avg_press': '167.0', 'max_press_time': datetime.datetime(2019, 5, 9, 3, 22, 49), 'min_press_time': datetime.datetime(2019, 4, 14, 10, 19), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '4090866.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '167.0', 'press_out': '167.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000081å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000112
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000209'}]
0000000209
00176000000112
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000173')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000209', 'rtu_no': None, 'flmeter_no': '00176000000112', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 55, 536114), 'year': '2019', 'std_sum': '1239212.000', 'work_sum': '994266.000', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 9, 4, 32, 40), 'min_std_flow_time': datetime.datetime(2019, 4, 13, 17, 20, 38), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 9, 4, 32, 40), 'min_work_flow_time': datetime.datetime(2019, 4, 13, 17, 20, 38), 'max_temperature': '29.6', 'min_temperature': '10.5', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 4, 20, 19, 38, 26), 'min_temp_time': datetime.datetime(2019, 4, 13, 17, 20, 38), 'max_press': '105.7', 'min_press': '101.0', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 4, 20, 19, 38, 26), 'min_press_time': datetime.datetime(2019, 5, 1, 19, 45, 35), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '1239212.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000112å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000047
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000210'}]
0000000210
00176000000047
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000107')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000210', 'rtu_no': None, 'flmeter_no': '00176000000047', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 55, 859254), 'year': '2019', 'std_sum': '750334.200', 'work_sum': '412794.000', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 13, 12, 12, 55), 'min_std_flow_time': datetime.datetime(2019, 4, 13, 18, 13, 13), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 13, 12, 12, 55), 'min_work_flow_time': datetime.datetime(2019, 4, 13, 18, 13, 13), 'max_temperature': '21.8', 'min_temperature': '16.5', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 4, 13, 12, 12, 55), 'min_temp_time': datetime.datetime(2019, 4, 13, 18, 13, 13), 'max_press': '186.0', 'min_press': '183.2', 'avg_press': '184.0', 'max_press_time': datetime.datetime(2019, 4, 13, 12, 12, 55), 'min_press_time': datetime.datetime(2019, 4, 13, 18, 13, 13), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '750334.200', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '184.0', 'press_out': '184.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000047å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000097
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000211'}]
0000000211
00176000000097
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000119')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000211', 'rtu_no': None, 'flmeter_no': '00176000000097', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 56, 181388), 'year': '2019', 'std_sum': '1588179.000', 'work_sum': '1295391.000', 'max_std_flow': '212.9', 'min_std_flow': '0.0', 'avg_std_flow': '7.0', 'max_std_flow_time': datetime.datetime(2019, 4, 14, 0, 12, 42), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 13, 1, 26), 'max_work_flow': '169.92', 'min_work_flow': '0.0', 'avg_work_flow': '6.0', 'max_work_flow_time': datetime.datetime(2019, 4, 14, 0, 12, 42), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 13, 1, 26), 'max_temperature': '25.2', 'min_temperature': '13.0', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 5, 3, 14, 23, 14), 'min_temp_time': datetime.datetime(2019, 4, 14, 13, 1, 26), 'max_press': '136.4', 'min_press': '100.0', 'avg_press': '117.0', 'max_press_time': datetime.datetime(2019, 4, 14, 0, 12, 42), 'min_press_time': datetime.datetime(2019, 5, 1, 13, 8, 56), 'price': '0.000', 'use_volume_work': '1079.0', 'use_volume_std': '1378.0', 'use_money': '0.0', 'sum_total_volume': '1588179.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '117.0', 'press_out': '117.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000097å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000103
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000212'}]
0000000212
00176000000103
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000122')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000212', 'rtu_no': None, 'flmeter_no': '00176000000103', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 56, 549406), 'year': '2019', 'std_sum': '316162.000', 'work_sum': '253613.000', 'max_std_flow': '111.87', 'min_std_flow': '0.0', 'avg_std_flow': '32.0', 'max_std_flow_time': datetime.datetime(2019, 5, 13, 18, 21, 20), 'min_std_flow_time': datetime.datetime(2019, 5, 14, 2, 52), 'max_work_flow': '85.45', 'min_work_flow': '0.0', 'avg_work_flow': '24.0', 'max_work_flow_time': datetime.datetime(2019, 5, 13, 18, 21, 20), 'min_work_flow_time': datetime.datetime(2019, 5, 14, 2, 52), 'max_temperature': '19.2', 'min_temperature': '16.8', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 5, 13, 18, 21, 20), 'min_temp_time': datetime.datetime(2019, 5, 14, 2, 52), 'max_press': '139.3', 'min_press': '131.5', 'avg_press': '136.0', 'max_press_time': datetime.datetime(2019, 5, 13, 18, 21, 20), 'min_press_time': datetime.datetime(2019, 5, 14, 2, 52), 'price': '0.000', 'use_volume_work': '155.0', 'use_volume_std': '203.0', 'use_money': '0.0', 'sum_total_volume': '316162.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '136.0', 'press_out': '136.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000103å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000002
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000213'}]
0000000213
00176000000002
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000164')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000213', 'rtu_no': None, 'flmeter_no': '00176000000002', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 56, 889495), 'year': '2019', 'std_sum': '67562847.996', 'work_sum': '8634705.000', 'max_std_flow': '3472.24', 'min_std_flow': '0.0', 'avg_std_flow': '661.0', 'max_std_flow_time': datetime.datetime(2019, 4, 15, 15, 54, 59), 'min_std_flow_time': datetime.datetime(2019, 4, 2, 4, 57, 45), 'max_work_flow': '463.87', 'min_work_flow': '0.0', 'avg_work_flow': '83.0', 'max_work_flow_time': datetime.datetime(2019, 4, 15, 15, 54, 59), 'min_work_flow_time': datetime.datetime(2019, 4, 2, 4, 57, 45), 'max_temperature': '23.55', 'min_temperature': '10.96', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 5, 7, 10, 58, 8), 'min_temp_time': datetime.datetime(2019, 5, 1, 3, 30, 27), 'max_press': '773.99', 'min_press': '603.72', 'avg_press': '765.0', 'max_press_time': datetime.datetime(2019, 4, 15, 15, 54, 59), 'min_press_time': datetime.datetime(2019, 4, 2, 4, 57, 45), 'price': '0.000', 'use_volume_work': '74069.0', 'use_volume_std': '581223.76', 'use_money': '0.0', 'sum_total_volume': '67562847.996', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '765.0', 'press_out': '765.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000002å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000042
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000214'}]
0000000214
00176000000042
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000181')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000214', 'rtu_no': None, 'flmeter_no': '00176000000042', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 57, 252529), 'year': '2019', 'std_sum': '448735.430', 'work_sum': '427451.270', 'max_std_flow': '133.4', 'min_std_flow': '11.1', 'avg_std_flow': '65.0', 'max_std_flow_time': datetime.datetime(2019, 4, 15, 17, 50, 30), 'min_std_flow_time': datetime.datetime(2019, 4, 16, 6, 41, 28), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 4, 14, 17, 51), 'min_work_flow_time': datetime.datetime(2019, 4, 16, 6, 41, 28), 'max_temperature': '25.3', 'min_temperature': '10.8', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 5, 4, 14, 17, 51), 'min_temp_time': datetime.datetime(2019, 4, 16, 6, 41, 28), 'max_press': '106.5', 'min_press': '104.2', 'avg_press': '105.0', 'max_press_time': datetime.datetime(2019, 4, 15, 17, 50, 30), 'min_press_time': datetime.datetime(2019, 4, 16, 6, 41, 28), 'price': '0.000', 'use_volume_work': '1943.93', 'use_volume_std': '2034.83', 'use_money': '0.0', 'sum_total_volume': '448735.430', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '105.0', 'press_out': '105.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000042å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000005
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000215'}]
0000000215
00176000000005
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000146')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000215', 'rtu_no': None, 'flmeter_no': '00176000000005', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 57, 669413), 'year': '2019', 'std_sum': '141037528.896', 'work_sum': '11121340.000', 'max_std_flow': '7875.84', 'min_std_flow': '0.0', 'avg_std_flow': '3412.0', 'max_std_flow_time': datetime.datetime(2019, 4, 2, 17, 49, 28), 'min_std_flow_time': datetime.datetime(2019, 4, 2, 1, 38, 59), 'max_work_flow': '991.75', 'min_work_flow': '0.0', 'avg_work_flow': '428.0', 'max_work_flow_time': datetime.datetime(2019, 4, 2, 17, 49, 28), 'min_work_flow_time': datetime.datetime(2019, 4, 2, 1, 38, 59), 'max_temperature': '21.39', 'min_temperature': '6.64', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 4, 2, 17, 49, 28), 'min_temp_time': datetime.datetime(2019, 4, 2, 1, 38, 59), 'max_press': '775.57', 'min_press': '608.48', 'avg_press': '767.0', 'max_press_time': datetime.datetime(2019, 4, 2, 17, 49, 28), 'min_press_time': datetime.datetime(2019, 4, 2, 1, 38, 59), 'price': '0.000', 'use_volume_work': '127090.0', 'use_volume_std': '1002337.94', 'use_money': '0.0', 'sum_total_volume': '141037528.896', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '767.0', 'press_out': '767.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000005å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000017
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000216'}]
0000000216
00176000000017
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000113')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000216', 'rtu_no': None, 'flmeter_no': '00176000000017', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 57, 941764), 'year': '2019', 'std_sum': '7191488.770', 'work_sum': '3893755.640', 'max_std_flow': '484.3', 'min_std_flow': '0.0', 'avg_std_flow': '158.0', 'max_std_flow_time': datetime.datetime(2019, 4, 10, 15, 25, 42), 'min_std_flow_time': datetime.datetime(2019, 4, 7, 21, 16, 57), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 10, 15, 25, 42), 'min_work_flow_time': datetime.datetime(2019, 4, 7, 21, 16, 57), 'max_temperature': '21.9', 'min_temperature': '8.1', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 4, 10, 15, 25, 42), 'min_temp_time': datetime.datetime(2019, 4, 7, 21, 16, 57), 'max_press': '203.1', 'min_press': '193.1', 'avg_press': '197.0', 'max_press_time': datetime.datetime(2019, 4, 10, 15, 25, 42), 'min_press_time': datetime.datetime(2019, 4, 7, 21, 16, 57), 'price': '0.000', 'use_volume_work': '13888.9', 'use_volume_std': '27461.66', 'use_money': '0.0', 'sum_total_volume': '7191488.770', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '197.0', 'press_out': '197.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000017å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000018
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000217'}]
0000000217
00176000000018
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000130')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000217', 'rtu_no': None, 'flmeter_no': '00176000000018', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 58, 260828), 'year': '2019', 'std_sum': '13810844.698', 'work_sum': '9300905.363', 'max_std_flow': '417.8', 'min_std_flow': '160.48', 'avg_std_flow': '274.0', 'max_std_flow_time': datetime.datetime(2019, 5, 7, 14, 44, 9), 'min_std_flow_time': datetime.datetime(2019, 5, 3, 11, 3, 40), 'max_work_flow': '280.67', 'min_work_flow': '106.56', 'avg_work_flow': '182.0', 'max_work_flow_time': datetime.datetime(2019, 5, 7, 14, 44, 9), 'min_work_flow_time': datetime.datetime(2019, 5, 3, 11, 3, 40), 'max_temperature': '15.51', 'min_temperature': '10.77', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 5, 7, 14, 44, 9), 'min_temp_time': datetime.datetime(2019, 4, 20, 22, 8, 15), 'max_press': '151.35', 'min_press': '145.3', 'avg_press': '148.0', 'max_press_time': datetime.datetime(2019, 4, 8, 23, 9, 2), 'min_press_time': datetime.datetime(2019, 4, 20, 22, 8, 15), 'price': '0.000', 'use_volume_work': '93849.53', 'use_volume_std': '141177.78', 'use_money': '0.0', 'sum_total_volume': '13810844.698', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '148.0', 'press_out': '148.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000018å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000046
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000218'}]
0000000218
00176000000046
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000172')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000218', 'rtu_no': None, 'flmeter_no': '00176000000046', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 58, 558033), 'year': '2019', 'std_sum': '2391564.200', 'work_sum': '1291188.210', 'max_std_flow': '836.5', 'min_std_flow': '0.0', 'avg_std_flow': '44.0', 'max_std_flow_time': datetime.datetime(2019, 4, 15, 23, 6, 51), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 21, 4, 5), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 6, 16, 7, 16), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 21, 4, 5), 'max_temperature': '22.2', 'min_temperature': '14.0', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 5, 6, 16, 7, 16), 'min_temp_time': datetime.datetime(2019, 4, 14, 21, 4, 5), 'max_press': '209.9', 'min_press': '202.4', 'avg_press': '207.0', 'max_press_time': datetime.datetime(2019, 5, 6, 16, 7, 16), 'min_press_time': datetime.datetime(2019, 5, 1, 9, 41, 51), 'price': '0.000', 'use_volume_work': '6092.11', 'use_volume_std': '12472.94', 'use_money': '0.0', 'sum_total_volume': '2391564.200', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '207.0', 'press_out': '207.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000046å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000094
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000219'}]
0000000219
00176000000094
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000104')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000219', 'rtu_no': None, 'flmeter_no': '00176000000094', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 58, 907128), 'year': '2019', 'std_sum': '5615844.582', 'work_sum': '5343691.795', 'max_std_flow': '290.15', 'min_std_flow': '0.0', 'avg_std_flow': '165.0', 'max_std_flow_time': datetime.datetime(2019, 4, 15, 7, 42, 27), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 22, 49, 41), 'max_work_flow': '278.01', 'min_work_flow': '0.0', 'avg_work_flow': '158.0', 'max_work_flow_time': datetime.datetime(2019, 4, 15, 7, 42, 27), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 22, 49, 41), 'max_temperature': '25.7', 'min_temperature': '-2.46', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 5, 3, 5, 30, 49), 'min_temp_time': datetime.datetime(2019, 4, 14, 22, 49, 41), 'max_press': '107.49', 'min_press': '103.89', 'avg_press': '105.0', 'max_press_time': datetime.datetime(2019, 4, 15, 7, 42, 27), 'min_press_time': datetime.datetime(2019, 4, 14, 22, 49, 41), 'price': '0.000', 'use_volume_work': '59039.0', 'use_volume_std': '61726.97', 'use_money': '0.0', 'sum_total_volume': '5615844.582', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '105.0', 'press_out': '105.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000094å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000049
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000220'}]
0000000220
00176000000049
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000134')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000220', 'rtu_no': None, 'flmeter_no': '00176000000049', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 59, 216288), 'year': '2019', 'std_sum': '2599938.000', 'work_sum': '2336376.000', 'max_std_flow': '123.86', 'min_std_flow': '0.0', 'avg_std_flow': '19.0', 'max_std_flow_time': datetime.datetime(2019, 5, 3, 20, 7, 20), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 11, 16, 43), 'max_work_flow': '111.97', 'min_work_flow': '0.0', 'avg_work_flow': '17.0', 'max_work_flow_time': datetime.datetime(2019, 4, 16, 4, 33, 26), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 11, 16, 43), 'max_temperature': '24.4', 'min_temperature': '15.5', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 5, 3, 20, 7, 20), 'min_temp_time': datetime.datetime(2019, 4, 14, 11, 16, 43), 'max_press': '113.9', 'min_press': '112.0', 'avg_press': '113.0', 'max_press_time': datetime.datetime(2019, 4, 16, 4, 33, 26), 'min_press_time': datetime.datetime(2019, 4, 14, 11, 16, 43), 'price': '0.000', 'use_volume_work': '2742.0', 'use_volume_std': '3059.0', 'use_money': '0.0', 'sum_total_volume': '2599938.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '113.0', 'press_out': '113.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000049å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000044
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000221'}]
0000000221
00176000000044
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000177')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000221', 'rtu_no': None, 'flmeter_no': '00176000000044', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 59, 481565), 'year': '2019', 'std_sum': '1679901.980', 'work_sum': '1593542.060', 'max_std_flow': '144.6', 'min_std_flow': '0.0', 'avg_std_flow': '19.0', 'max_std_flow_time': datetime.datetime(2019, 4, 15, 9, 28, 42), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 10, 55, 2), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 15, 9, 28, 42), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 10, 55, 2), 'max_temperature': '21.3', 'min_temperature': '8.6', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 4, 15, 9, 28, 42), 'min_temp_time': datetime.datetime(2019, 4, 14, 10, 55, 2), 'max_press': '107.2', 'min_press': '105.8', 'avg_press': '106.0', 'max_press_time': datetime.datetime(2019, 4, 15, 9, 28, 42), 'min_press_time': datetime.datetime(2019, 4, 14, 10, 55, 2), 'price': '0.000', 'use_volume_work': '1300.98', 'use_volume_std': '1378.87', 'use_money': '0.0', 'sum_total_volume': '1679901.980', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '106.0', 'press_out': '106.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000044å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000065
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000222'}]
0000000222
00176000000065
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000162')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000222', 'rtu_no': None, 'flmeter_no': '00176000000065', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 20, 59, 793730), 'year': '2019', 'std_sum': '20602983.637', 'work_sum': '6996735.000', 'max_std_flow': '626.64', 'min_std_flow': '320.84', 'avg_std_flow': '542.0', 'max_std_flow_time': datetime.datetime(2019, 4, 14, 9, 4, 8), 'min_std_flow_time': datetime.datetime(2019, 4, 15, 13, 33, 14), 'max_work_flow': '207.75', 'min_work_flow': '105.05', 'avg_work_flow': '179.0', 'max_work_flow_time': datetime.datetime(2019, 4, 14, 9, 4, 8), 'min_work_flow_time': datetime.datetime(2019, 4, 15, 13, 33, 14), 'max_temperature': '20.15', 'min_temperature': '15.08', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 5, 4, 14, 59, 32), 'min_temp_time': datetime.datetime(2019, 4, 15, 13, 33, 14), 'max_press': '304.88', 'min_press': '300.11', 'avg_press': '301.0', 'max_press_time': datetime.datetime(2019, 4, 14, 9, 4, 8), 'min_press_time': datetime.datetime(2019, 5, 2, 9, 29, 45), 'price': '0.000', 'use_volume_work': '63910.0', 'use_volume_std': '192704.13', 'use_money': '0.0', 'sum_total_volume': '20602983.637', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '301.0', 'press_out': '301.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000065å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000118
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000223'}]
0000000223
00176000000118
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000143')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000223', 'rtu_no': None, 'flmeter_no': '00176000000118', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 0, 109885), 'year': '2019', 'std_sum': '2069754.000', 'work_sum': '1763151.000', 'max_std_flow': '4.2', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 18, 14, 2, 53), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 12, 8, 45), 'max_work_flow': '3.55', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 7, 13, 44, 42), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 12, 8, 45), 'max_temperature': '30.9', 'min_temperature': '10.8', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 5, 7, 13, 44, 42), 'min_temp_time': datetime.datetime(2019, 4, 14, 12, 8, 45), 'max_press': '128.3', 'min_press': '118.9', 'avg_press': '125.0', 'max_press_time': datetime.datetime(2019, 5, 7, 13, 44, 42), 'min_press_time': datetime.datetime(2019, 5, 2, 18, 3, 45), 'price': '0.000', 'use_volume_work': '12235.0', 'use_volume_std': '14726.0', 'use_money': '0.0', 'sum_total_volume': '2069754.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '125.0', 'press_out': '125.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000118å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000045
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000224'}]
0000000224
00176000000045
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000095')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000224', 'rtu_no': None, 'flmeter_no': '00176000000045', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 0, 399110), 'year': '2019', 'std_sum': '2570237.000', 'work_sum': '2092907.000', 'max_std_flow': '192.84', 'min_std_flow': '0.0', 'avg_std_flow': '47.0', 'max_std_flow_time': datetime.datetime(2019, 5, 17, 6, 21, 29), 'min_std_flow_time': datetime.datetime(2019, 5, 13, 20, 27, 14), 'max_work_flow': '159.67', 'min_work_flow': '0.0', 'avg_work_flow': '39.0', 'max_work_flow_time': datetime.datetime(2019, 5, 17, 6, 21, 29), 'min_work_flow_time': datetime.datetime(2019, 5, 13, 20, 27, 14), 'max_temperature': '24.1', 'min_temperature': '19.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 5, 17, 6, 21, 29), 'min_temp_time': datetime.datetime(2019, 5, 13, 20, 27, 14), 'max_press': '124.9', 'min_press': '121.6', 'avg_press': '123.0', 'max_press_time': datetime.datetime(2019, 5, 17, 6, 21, 29), 'min_press_time': datetime.datetime(2019, 5, 13, 20, 27, 14), 'price': '0.000', 'use_volume_work': '7726.0', 'use_volume_std': '9340.0', 'use_money': '0.0', 'sum_total_volume': '2570237.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '123.0', 'press_out': '123.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000045å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000111
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000225'}]
0000000225
00176000000111
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000116')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000225', 'rtu_no': None, 'flmeter_no': '00176000000111', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 0, 733217), 'year': '2019', 'std_sum': '416716.000', 'work_sum': '201708.000', 'max_std_flow': '77.13', 'min_std_flow': '0.0', 'avg_std_flow': '7.0', 'max_std_flow_time': datetime.datetime(2019, 4, 17, 8, 27, 45), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 14, 53, 49), 'max_work_flow': '38.26', 'min_work_flow': '0.0', 'avg_work_flow': '3.0', 'max_work_flow_time': datetime.datetime(2019, 4, 17, 8, 27, 45), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 14, 53, 49), 'max_temperature': '29.9', 'min_temperature': '10.1', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 4, 17, 8, 27, 45), 'min_temp_time': datetime.datetime(2019, 4, 14, 14, 53, 49), 'max_press': '217.2', 'min_press': '200.9', 'avg_press': '208.0', 'max_press_time': datetime.datetime(2019, 4, 17, 8, 27, 45), 'min_press_time': datetime.datetime(2019, 4, 14, 14, 53, 49), 'price': '0.000', 'use_volume_work': '667.0', 'use_volume_std': '1319.0', 'use_money': '0.0', 'sum_total_volume': '416716.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '208.0', 'press_out': '208.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000111å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000054
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000226'}]
0000000226
00176000000054
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000141')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000226', 'rtu_no': None, 'flmeter_no': '00176000000054', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 1, 54442), 'year': '2019', 'std_sum': '16406977.920', 'work_sum': '13702923.380', 'max_std_flow': '437.7', 'min_std_flow': '363.3', 'avg_std_flow': '388.0', 'max_std_flow_time': datetime.datetime(2019, 4, 13, 17, 28, 38), 'min_std_flow_time': datetime.datetime(2019, 5, 3, 12, 30, 13), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 3, 1, 49, 26), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 15, 6, 18), 'max_temperature': '23.6', 'min_temperature': '18.4', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 5, 3, 1, 49, 26), 'min_temp_time': datetime.datetime(2019, 4, 14, 15, 6, 18), 'max_press': '126.6', 'min_press': '124.5', 'avg_press': '125.0', 'max_press_time': datetime.datetime(2019, 5, 3, 1, 49, 26), 'min_press_time': datetime.datetime(2019, 5, 3, 12, 30, 13), 'price': '0.000', 'use_volume_work': '51077.62', 'use_volume_std': '63169.88', 'use_money': '0.0', 'sum_total_volume': '16406977.920', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '125.0', 'press_out': '125.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000054å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000120
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000227'}]
0000000227
00176000000120
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000153')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000227', 'rtu_no': None, 'flmeter_no': '00176000000120', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 1, 373506), 'year': '2019', 'std_sum': '123124.000', 'work_sum': '121345.000', 'max_std_flow': '14.12', 'min_std_flow': '0.0', 'avg_std_flow': '4.0', 'max_std_flow_time': datetime.datetime(2019, 5, 1, 5, 40, 30), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 23, 55, 47), 'max_work_flow': '13.99', 'min_work_flow': '0.0', 'avg_work_flow': '4.0', 'max_work_flow_time': datetime.datetime(2019, 5, 1, 5, 40, 30), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 23, 55, 47), 'max_temperature': '25.3', 'min_temperature': '20.3', 'avg_temperature': '22.0', 'max_temp_time': datetime.datetime(2019, 5, 1, 5, 40, 30), 'min_temp_time': datetime.datetime(2019, 4, 14, 23, 55, 47), 'max_press': '104.4', 'min_press': '101.1', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 5, 1, 5, 40, 30), 'min_press_time': datetime.datetime(2019, 5, 1, 20, 35, 34), 'price': '0.000', 'use_volume_work': '1782.0', 'use_volume_std': '1799.0', 'use_money': '0.0', 'sum_total_volume': '123124.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000120å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000011
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000228'}]
0000000228
00176000000011
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000155')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000228', 'rtu_no': None, 'flmeter_no': '00176000000011', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 1, 675697), 'year': '2019', 'std_sum': '18765637.279', 'work_sum': '4620490.000', 'max_std_flow': '553.0', 'min_std_flow': '0.0', 'avg_std_flow': '82.0', 'max_std_flow_time': datetime.datetime(2019, 4, 11, 11, 10, 58), 'min_std_flow_time': datetime.datetime(2019, 4, 8, 6, 35, 49), 'max_work_flow': '135.0', 'min_work_flow': '0.0', 'avg_work_flow': '20.0', 'max_work_flow_time': datetime.datetime(2019, 4, 11, 11, 10, 58), 'min_work_flow_time': datetime.datetime(2019, 4, 8, 6, 35, 49), 'max_temperature': '19.13', 'min_temperature': '10.56', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 4, 11, 11, 10, 58), 'min_temp_time': datetime.datetime(2019, 4, 8, 6, 35, 49), 'max_press': '411.16', 'min_press': '395.1', 'avg_press': '405.0', 'max_press_time': datetime.datetime(2019, 5, 1, 1, 45, 9), 'min_press_time': datetime.datetime(2019, 4, 8, 6, 35, 49), 'price': '0.000', 'use_volume_work': '11520.0', 'use_volume_std': '47047.17', 'use_money': '0.0', 'sum_total_volume': '18765637.279', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '405.0', 'press_out': '405.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000011å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000082
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000229'}]
0000000229
00176000000082
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000163')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000229', 'rtu_no': None, 'flmeter_no': '00176000000082', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 1, 942984), 'year': '2019', 'std_sum': '173475.000', 'work_sum': '152438.000', 'max_std_flow': '120.85', 'min_std_flow': '0.0', 'avg_std_flow': '16.0', 'max_std_flow_time': datetime.datetime(2019, 4, 13, 11, 33, 8), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 10, 14, 51), 'max_work_flow': '106.75', 'min_work_flow': '0.0', 'avg_work_flow': '14.0', 'max_work_flow_time': datetime.datetime(2019, 4, 13, 11, 33, 8), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 10, 14, 51), 'max_temperature': '26.7', 'min_temperature': '17.6', 'avg_temperature': '21.0', 'max_temp_time': datetime.datetime(2019, 5, 3, 15, 11, 44), 'min_temp_time': datetime.datetime(2019, 4, 14, 10, 14, 51), 'max_press': '116.7', 'min_press': '114.9', 'avg_press': '116.0', 'max_press_time': datetime.datetime(2019, 5, 3, 15, 11, 44), 'min_press_time': datetime.datetime(2019, 5, 1, 6, 58), 'price': '0.000', 'use_volume_work': '3496.0', 'use_volume_std': '3971.0', 'use_money': '0.0', 'sum_total_volume': '173475.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '116.0', 'press_out': '116.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000082å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000117
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000230'}]
0000000230
00176000000117
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000132')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000230', 'rtu_no': None, 'flmeter_no': '00176000000117', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 2, 243180), 'year': '2019', 'std_sum': '6318782.000', 'work_sum': '5170425.000', 'max_std_flow': '591.28', 'min_std_flow': '0.0', 'avg_std_flow': '42.0', 'max_std_flow_time': datetime.datetime(2019, 4, 16, 7, 34, 47), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 12, 59, 21), 'max_work_flow': '459.82', 'min_work_flow': '0.0', 'avg_work_flow': '33.0', 'max_work_flow_time': datetime.datetime(2019, 4, 16, 7, 34, 47), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 12, 59, 21), 'max_temperature': '21.3', 'min_temperature': '11.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 4, 16, 7, 34, 47), 'min_temp_time': datetime.datetime(2019, 4, 14, 12, 59, 21), 'max_press': '135.2', 'min_press': '117.0', 'avg_press': '126.0', 'max_press_time': datetime.datetime(2019, 5, 1, 4, 9, 35), 'min_press_time': datetime.datetime(2019, 4, 14, 12, 59, 21), 'price': '0.000', 'use_volume_work': '12675.0', 'use_volume_std': '15877.0', 'use_money': '0.0', 'sum_total_volume': '6318782.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '126.0', 'press_out': '126.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000117å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000125
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000231'}]
0000000231
00176000000125
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000123')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000231', 'rtu_no': None, 'flmeter_no': '00176000000125', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 2, 518450), 'year': '2019', 'std_sum': '243809.000', 'work_sum': '238332.000', 'max_std_flow': '35.83', 'min_std_flow': '0.0', 'avg_std_flow': '9.0', 'max_std_flow_time': datetime.datetime(2019, 4, 16, 6, 6, 54), 'min_std_flow_time': datetime.datetime(2019, 4, 16, 3, 3, 13), 'max_work_flow': '34.61', 'min_work_flow': '0.0', 'avg_work_flow': '9.0', 'max_work_flow_time': datetime.datetime(2019, 4, 16, 6, 6, 54), 'min_work_flow_time': datetime.datetime(2019, 4, 16, 3, 3, 13), 'max_temperature': '20.2', 'min_temperature': '13.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 4, 16, 6, 6, 54), 'min_temp_time': datetime.datetime(2019, 4, 16, 3, 3, 13), 'max_press': '104.1', 'min_press': '102.6', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 4, 16, 6, 6, 54), 'min_press_time': datetime.datetime(2019, 4, 16, 3, 3, 13), 'price': '0.000', 'use_volume_work': '935.0', 'use_volume_std': '963.0', 'use_money': '0.0', 'sum_total_volume': '243809.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000125å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000128
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000232'}]
0000000232
00176000000128
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000136')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000232', 'rtu_no': None, 'flmeter_no': '00176000000128', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 2, 775755), 'year': '2019', 'std_sum': '299414.000', 'work_sum': '275406.000', 'max_std_flow': '52.66', 'min_std_flow': '0.0', 'avg_std_flow': '8.0', 'max_std_flow_time': datetime.datetime(2019, 5, 5, 9, 32, 10), 'min_std_flow_time': datetime.datetime(2019, 4, 15, 20, 52, 8), 'max_work_flow': '48.72', 'min_work_flow': '0.0', 'avg_work_flow': '7.0', 'max_work_flow_time': datetime.datetime(2019, 5, 5, 9, 32, 10), 'min_work_flow_time': datetime.datetime(2019, 4, 15, 20, 52, 8), 'max_temperature': '36.9', 'min_temperature': '12.2', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 5, 5, 9, 32, 10), 'min_temp_time': datetime.datetime(2019, 5, 1, 19, 58, 4), 'max_press': '119.9', 'min_press': '109.0', 'avg_press': '111.0', 'max_press_time': datetime.datetime(2019, 5, 5, 9, 32, 10), 'min_press_time': datetime.datetime(2019, 4, 15, 20, 52, 8), 'price': '0.000', 'use_volume_work': '2824.0', 'use_volume_std': '3111.0', 'use_money': '0.0', 'sum_total_volume': '299414.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '111.0', 'press_out': '111.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000128å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000084
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000233'}]
0000000233
00176000000084
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000124')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000233', 'rtu_no': None, 'flmeter_no': '00176000000084', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 3, 84930), 'year': '2019', 'std_sum': '2238714.000', 'work_sum': '1775682.000', 'max_std_flow': '175.89', 'min_std_flow': '0.0', 'avg_std_flow': '47.0', 'max_std_flow_time': datetime.datetime(2019, 5, 5, 16, 26, 42), 'min_std_flow_time': datetime.datetime(2019, 4, 13, 20, 27, 40), 'max_work_flow': '139.37', 'min_work_flow': '0.0', 'avg_work_flow': '37.0', 'max_work_flow_time': datetime.datetime(2019, 5, 5, 16, 26, 42), 'min_work_flow_time': datetime.datetime(2019, 4, 13, 20, 27, 40), 'max_temperature': '23.4', 'min_temperature': '13.4', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 5, 5, 16, 26, 42), 'min_temp_time': datetime.datetime(2019, 4, 13, 20, 27, 40), 'max_press': '130.5', 'min_press': '126.8', 'avg_press': '128.0', 'max_press_time': datetime.datetime(2019, 5, 5, 16, 26, 42), 'min_press_time': datetime.datetime(2019, 4, 13, 20, 27, 40), 'price': '0.000', 'use_volume_work': '14919.0', 'use_volume_std': '19014.0', 'use_money': '0.0', 'sum_total_volume': '2238714.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '128.0', 'press_out': '128.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000084å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000119
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000234'}]
0000000234
00176000000119
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000150')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000234', 'rtu_no': None, 'flmeter_no': '00176000000119', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 3, 387121), 'year': '2019', 'std_sum': '230284.000', 'work_sum': '226334.000', 'max_std_flow': '29.85', 'min_std_flow': '0.0', 'avg_std_flow': '7.0', 'max_std_flow_time': datetime.datetime(2019, 4, 16, 9, 36, 18), 'min_std_flow_time': datetime.datetime(2019, 4, 13, 20, 18, 15), 'max_work_flow': '28.4', 'min_work_flow': '0.0', 'avg_work_flow': '7.0', 'max_work_flow_time': datetime.datetime(2019, 4, 16, 9, 36, 18), 'min_work_flow_time': datetime.datetime(2019, 4, 13, 20, 18, 15), 'max_temperature': '24.8', 'min_temperature': '17.2', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 4, 16, 9, 36, 18), 'min_temp_time': datetime.datetime(2019, 4, 13, 20, 18, 15), 'max_press': '104.4', 'min_press': '102.9', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 4, 16, 9, 36, 18), 'min_press_time': datetime.datetime(2019, 4, 13, 20, 18, 15), 'price': '0.000', 'use_volume_work': '854.0', 'use_volume_std': '874.0', 'use_money': '0.0', 'sum_total_volume': '230284.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000119å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000007
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000235'}]
0000000235
00176000000007
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000148')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000235', 'rtu_no': None, 'flmeter_no': '00176000000007', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 3, 687318), 'year': '2019', 'std_sum': '80814903.587', 'work_sum': '16165037.000', 'max_std_flow': '2490.43', 'min_std_flow': '0.0', 'avg_std_flow': '1453.0', 'max_std_flow_time': datetime.datetime(2019, 4, 2, 17, 28, 24), 'min_std_flow_time': datetime.datetime(2019, 5, 3, 15, 3, 45), 'max_work_flow': '490.51', 'min_work_flow': '0.0', 'avg_work_flow': '286.0', 'max_work_flow_time': datetime.datetime(2019, 4, 2, 17, 28, 24), 'min_work_flow_time': datetime.datetime(2019, 5, 3, 15, 3, 45), 'max_temperature': '21.68', 'min_temperature': '7.07', 'avg_temperature': '9.0', 'max_temp_time': datetime.datetime(2019, 5, 6, 18, 10, 56), 'min_temp_time': datetime.datetime(2019, 4, 18, 14, 0, 56), 'max_press': '498.16', 'min_press': '480.98', 'avg_press': '490.0', 'max_press_time': datetime.datetime(2019, 4, 2, 17, 28, 24), 'min_press_time': datetime.datetime(2019, 4, 18, 14, 0, 56), 'price': '0.000', 'use_volume_work': '192650.0', 'use_volume_std': '976592.0', 'use_money': '0.0', 'sum_total_volume': '80814903.587', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '490.0', 'press_out': '490.0', 'temp_in': '9.0', 'temp_out': '9.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000007å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000116
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000236'}]
0000000236
00176000000116
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000126')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000236', 'rtu_no': None, 'flmeter_no': '00176000000116', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 4, 46359), 'year': '2019', 'std_sum': '889323.000', 'work_sum': '774898.000', 'max_std_flow': '198.17', 'min_std_flow': '0.0', 'avg_std_flow': '30.0', 'max_std_flow_time': datetime.datetime(2019, 4, 15, 6, 47, 25), 'min_std_flow_time': datetime.datetime(2019, 4, 16, 3, 2, 4), 'max_work_flow': '163.68', 'min_work_flow': '0.0', 'avg_work_flow': '26.0', 'max_work_flow_time': datetime.datetime(2019, 4, 15, 6, 47, 25), 'min_work_flow_time': datetime.datetime(2019, 4, 16, 3, 2, 4), 'max_temperature': '24.8', 'min_temperature': '11.3', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 5, 7, 7, 23, 28), 'min_temp_time': datetime.datetime(2019, 4, 16, 3, 2, 4), 'max_press': '121.1', 'min_press': '115.3', 'avg_press': '117.0', 'max_press_time': datetime.datetime(2019, 5, 7, 7, 23, 28), 'min_press_time': datetime.datetime(2019, 4, 16, 3, 2, 4), 'price': '0.000', 'use_volume_work': '9509.0', 'use_volume_std': '11062.0', 'use_money': '0.0', 'sum_total_volume': '889323.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '117.0', 'press_out': '117.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000116å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000006
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000237'}]
0000000237
00176000000006
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000165')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000237', 'rtu_no': None, 'flmeter_no': '00176000000006', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 4, 350694), 'year': '2019', 'std_sum': '277156593.796', 'work_sum': '34790550.000', 'max_std_flow': '5761.44', 'min_std_flow': '1266.08', 'avg_std_flow': '3136.0', 'max_std_flow_time': datetime.datetime(2019, 4, 1, 19, 41, 33), 'min_std_flow_time': datetime.datetime(2019, 5, 2, 4, 16, 16), 'max_work_flow': '612.64', 'min_work_flow': '159.3', 'avg_work_flow': '623.0', 'max_work_flow_time': datetime.datetime(2019, 5, 2, 18, 11, 54), 'min_work_flow_time': datetime.datetime(2019, 4, 12, 14, 0, 18), 'max_temperature': '13.43', 'min_temperature': '10.44', 'avg_temperature': '9.0', 'max_temp_time': datetime.datetime(2019, 5, 2, 18, 11, 54), 'min_temp_time': datetime.datetime(2019, 5, 2, 4, 16, 16), 'max_press': '495.79', 'min_press': '478.44', 'avg_press': '486.0', 'max_press_time': datetime.datetime(2019, 4, 1, 19, 41, 33), 'min_press_time': datetime.datetime(2019, 4, 12, 14, 0, 18), 'price': '0.000', 'use_volume_work': '361600.0', 'use_volume_std': '1813006.36', 'use_money': '0.0', 'sum_total_volume': '277156593.796', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '486.0', 'press_out': '486.0', 'temp_in': '9.0', 'temp_out': '9.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000006å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000063
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000238'}]
0000000238
00176000000063
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000093')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000238', 'rtu_no': None, 'flmeter_no': '00176000000063', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 4, 654731), 'year': '2019', 'std_sum': '6897676.000', 'work_sum': '6080588.000', 'max_std_flow': '7.47', 'min_std_flow': '0.0', 'avg_std_flow': '1.0', 'max_std_flow_time': datetime.datetime(2019, 5, 4, 10, 16, 9), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 12, 10, 34), 'max_work_flow': '6.58', 'min_work_flow': '0.0', 'avg_work_flow': '1.0', 'max_work_flow_time': datetime.datetime(2019, 5, 4, 10, 16, 9), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 12, 10, 34), 'max_temperature': '34.1', 'min_temperature': '12.7', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 5, 4, 10, 16, 9), 'min_temp_time': datetime.datetime(2019, 4, 14, 12, 10, 34), 'max_press': '116.3', 'min_press': '110.5', 'avg_press': '114.0', 'max_press_time': datetime.datetime(2019, 4, 16, 7, 16, 10), 'min_press_time': datetime.datetime(2019, 5, 1, 10, 36, 29), 'price': '0.000', 'use_volume_work': '57770.0', 'use_volume_std': '64610.0', 'use_money': '0.0', 'sum_total_volume': '6897676.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '114.0', 'press_out': '114.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000063å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000048
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000239'}]
0000000239
00176000000048
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000105')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000239', 'rtu_no': None, 'flmeter_no': '00176000000048', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 4, 984852), 'year': '2019', 'std_sum': '718701.792', 'work_sum': '685709.705', 'max_std_flow': '154.15', 'min_std_flow': '0.0', 'avg_std_flow': '32.0', 'max_std_flow_time': datetime.datetime(2019, 5, 6, 6, 22, 31), 'min_std_flow_time': datetime.datetime(2019, 5, 2, 6, 3, 43), 'max_work_flow': '148.48', 'min_work_flow': '0.0', 'avg_work_flow': '31.0', 'max_work_flow_time': datetime.datetime(2019, 5, 6, 6, 22, 31), 'min_work_flow_time': datetime.datetime(2019, 5, 2, 6, 3, 43), 'max_temperature': '25.72', 'min_temperature': '14.77', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 5, 6, 6, 22, 31), 'min_temp_time': datetime.datetime(2019, 4, 20, 6, 6, 55), 'max_press': '106.91', 'min_press': '104.09', 'avg_press': '104.0', 'max_press_time': datetime.datetime(2019, 5, 6, 6, 22, 31), 'min_press_time': datetime.datetime(2019, 4, 20, 6, 6, 55), 'price': '0.000', 'use_volume_work': '12069.75', 'use_volume_std': '12522.08', 'use_money': '0.0', 'sum_total_volume': '718701.792', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '104.0', 'press_out': '104.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000048å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000107
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000240'}]
0000000240
00176000000107
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000096')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000240', 'rtu_no': None, 'flmeter_no': '00176000000107', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 5, 241164), 'year': '2019', 'std_sum': '246952.000', 'work_sum': '241638.000', 'max_std_flow': '34.45', 'min_std_flow': '0.0', 'avg_std_flow': '10.0', 'max_std_flow_time': datetime.datetime(2019, 5, 3, 9, 28, 36), 'min_std_flow_time': datetime.datetime(2019, 4, 15, 22, 27, 23), 'max_work_flow': '33.35', 'min_work_flow': '0.0', 'avg_work_flow': '10.0', 'max_work_flow_time': datetime.datetime(2019, 5, 3, 9, 28, 36), 'min_work_flow_time': datetime.datetime(2019, 4, 15, 22, 27, 23), 'max_temperature': '26.7', 'min_temperature': '12.5', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 5, 3, 9, 28, 36), 'min_temp_time': datetime.datetime(2019, 4, 15, 22, 27, 23), 'max_press': '103.8', 'min_press': '102.4', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 5, 3, 9, 28, 36), 'min_press_time': datetime.datetime(2019, 5, 3, 0, 59, 56), 'price': '0.000', 'use_volume_work': '2420.0', 'use_volume_std': '2464.0', 'use_money': '0.0', 'sum_total_volume': '246952.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000107å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000001
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000241'}]
0000000241
00176000000001
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000127')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000241', 'rtu_no': None, 'flmeter_no': '00176000000001', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 5, 577264), 'year': '2019', 'std_sum': '230905329.313', 'work_sum': '46539674.000', 'max_std_flow': '8124.09', 'min_std_flow': '2661.93', 'avg_std_flow': '6627.0', 'max_std_flow_time': datetime.datetime(2019, 4, 2, 17, 38, 46), 'min_std_flow_time': datetime.datetime(2019, 4, 6, 2, 7, 11), 'max_work_flow': '1615.87', 'min_work_flow': '523.51', 'avg_work_flow': '1309.0', 'max_work_flow_time': datetime.datetime(2019, 4, 2, 17, 38, 46), 'min_work_flow_time': datetime.datetime(2019, 4, 6, 2, 7, 11), 'max_temperature': '8.83', 'min_temperature': '7.73', 'avg_temperature': '8.0', 'max_temp_time': datetime.datetime(2019, 4, 2, 17, 38, 46), 'min_temp_time': datetime.datetime(2019, 4, 6, 2, 7, 11), 'max_press': '491.13', 'min_press': '482.18', 'avg_press': '487.0', 'max_press_time': datetime.datetime(2019, 4, 2, 17, 38, 46), 'min_press_time': datetime.datetime(2019, 4, 6, 2, 7, 11), 'price': '0.000', 'use_volume_work': '188420.0', 'use_volume_std': '952229.06', 'use_money': '0.0', 'sum_total_volume': '230905329.313', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '487.0', 'press_out': '487.0', 'temp_in': '8.0', 'temp_out': '8.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000001å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000059
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000242'}]
0000000242
00176000000059
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000166')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000242', 'rtu_no': None, 'flmeter_no': '00176000000059', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 5, 942289), 'year': '2019', 'std_sum': '2729679.660', 'work_sum': '2327917.750', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 13, 17, 34, 52), 'min_std_flow_time': datetime.datetime(2019, 4, 13, 17, 34, 52), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 13, 17, 34, 52), 'min_work_flow_time': datetime.datetime(2019, 4, 13, 17, 34, 52), 'max_temperature': '23.9', 'min_temperature': '21.8', 'avg_temperature': '22.0', 'max_temp_time': datetime.datetime(2019, 4, 13, 17, 34, 52), 'min_temp_time': datetime.datetime(2019, 4, 13, 17, 34, 52), 'max_press': '120.7', 'min_press': '120.3', 'avg_press': '120.0', 'max_press_time': datetime.datetime(2019, 4, 13, 17, 34, 52), 'min_press_time': datetime.datetime(2019, 4, 13, 17, 34, 52), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '2729679.660', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '120.0', 'press_out': '120.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000059å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000010
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000243'}]
0000000243
00176000000010
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000115')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000243', 'rtu_no': None, 'flmeter_no': '00176000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 6, 253456), 'year': '2019', 'std_sum': '1529197.585', 'work_sum': '1011470.000', 'max_std_flow': '105.0', 'min_std_flow': '0.0', 'avg_std_flow': '8.0', 'max_std_flow_time': datetime.datetime(2019, 4, 16, 7, 22, 9), 'min_std_flow_time': datetime.datetime(2019, 4, 7, 15, 2, 59), 'max_work_flow': '69.0', 'min_work_flow': '0.0', 'avg_work_flow': '5.0', 'max_work_flow_time': datetime.datetime(2019, 4, 16, 7, 22, 9), 'min_work_flow_time': datetime.datetime(2019, 4, 7, 15, 2, 59), 'max_temperature': '22.14', 'min_temperature': '13.57', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 4, 16, 7, 22, 9), 'min_temp_time': datetime.datetime(2019, 5, 1, 0, 4, 7), 'max_press': '151.92', 'min_press': '148.88', 'avg_press': '150.0', 'max_press_time': datetime.datetime(2019, 4, 16, 7, 22, 9), 'min_press_time': datetime.datetime(2019, 4, 7, 15, 2, 59), 'price': '0.000', 'use_volume_work': '3090.0', 'use_volume_std': '4694.0', 'use_money': '0.0', 'sum_total_volume': '1529197.585', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '150.0', 'press_out': '150.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000010å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000037
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000244'}]
0000000244
00176000000037
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000106')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000244', 'rtu_no': None, 'flmeter_no': '00176000000037', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 6, 599665), 'year': '2019', 'std_sum': '2226817.368', 'work_sum': '115381.204', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 13, 10, 38, 34), 'min_std_flow_time': datetime.datetime(2019, 4, 13, 10, 38, 34), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 13, 10, 38, 34), 'min_work_flow_time': datetime.datetime(2019, 4, 13, 10, 38, 34), 'max_temperature': '16.04', 'min_temperature': '16.04', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 4, 13, 10, 38, 34), 'min_temp_time': datetime.datetime(2019, 4, 13, 10, 38, 34), 'max_press': '147.02', 'min_press': '147.02', 'avg_press': '147.0', 'max_press_time': datetime.datetime(2019, 4, 13, 10, 38, 34), 'min_press_time': datetime.datetime(2019, 4, 13, 10, 38, 34), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '2226817.368', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '147.0', 'press_out': '147.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000037å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000009
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000245'}]
0000000245
00176000000009
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000169')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000245', 'rtu_no': None, 'flmeter_no': '00176000000009', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 6, 887760), 'year': '2019', 'std_sum': '1906608.000', 'work_sum': '415302.000', 'max_std_flow': '133.99', 'min_std_flow': '0.0', 'avg_std_flow': '30.0', 'max_std_flow_time': datetime.datetime(2019, 5, 7, 23, 26, 1), 'min_std_flow_time': datetime.datetime(2019, 4, 7, 15, 6, 35), 'max_work_flow': '28.83', 'min_work_flow': '0.0', 'avg_work_flow': '6.0', 'max_work_flow_time': datetime.datetime(2019, 5, 7, 23, 26, 1), 'min_work_flow_time': datetime.datetime(2019, 4, 7, 15, 6, 35), 'max_temperature': '21.1', 'min_temperature': '0.0', 'avg_temperature': '4.0', 'max_temp_time': datetime.datetime(2019, 5, 7, 23, 26, 1), 'min_temp_time': datetime.datetime(2019, 4, 7, 15, 6, 35), 'max_press': '474.8', 'min_press': '0.0', 'avg_press': '109.0', 'max_press_time': datetime.datetime(2019, 5, 7, 23, 26, 1), 'min_press_time': datetime.datetime(2019, 4, 7, 15, 6, 35), 'price': '0.000', 'use_volume_work': '415302.0', 'use_volume_std': '1906608.0', 'use_money': '0.0', 'sum_total_volume': '1906608.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '109.0', 'press_out': '109.0', 'temp_in': '4.0', 'temp_out': '4.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000009å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000043
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000246'}]
0000000246
00176000000043
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000101')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000246', 'rtu_no': None, 'flmeter_no': '00176000000043', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 7, 223937), 'year': '2019', 'std_sum': '658928.660', 'work_sum': '491272.420', 'max_std_flow': '98.83', 'min_std_flow': '0.0', 'avg_std_flow': '2.0', 'max_std_flow_time': datetime.datetime(2019, 4, 13, 15, 28, 13), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 9, 59, 33), 'max_work_flow': '76.22', 'min_work_flow': '0.0', 'avg_work_flow': '2.0', 'max_work_flow_time': datetime.datetime(2019, 4, 13, 15, 28, 13), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 9, 59, 33), 'max_temperature': '21.16', 'min_temperature': '15.02', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 4, 13, 15, 28, 13), 'min_temp_time': datetime.datetime(2019, 4, 14, 9, 59, 33), 'max_press': '134.67', 'min_press': '131.25', 'avg_press': '134.0', 'max_press_time': datetime.datetime(2019, 4, 13, 15, 28, 13), 'min_press_time': datetime.datetime(2019, 4, 14, 9, 59, 33), 'price': '0.000', 'use_volume_work': '201.79', 'use_volume_std': '263.03', 'use_money': '0.0', 'sum_total_volume': '658928.660', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '134.0', 'press_out': '134.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000043å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000032
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000247'}]
0000000247
00176000000032
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000154')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000247', 'rtu_no': None, 'flmeter_no': '00176000000032', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 7, 615814), 'year': '2019', 'std_sum': '42397031.141', 'work_sum': '6435527.337', 'max_std_flow': '1093.11', 'min_std_flow': '0.0', 'avg_std_flow': '594.0', 'max_std_flow_time': datetime.datetime(2019, 4, 14, 20, 48, 31), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 13, 3, 27), 'max_work_flow': '164.83', 'min_work_flow': '0.0', 'avg_work_flow': '88.0', 'max_work_flow_time': datetime.datetime(2019, 4, 14, 20, 48, 31), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 13, 3, 27), 'max_temperature': '17.37', 'min_temperature': '12.62', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 4, 14, 20, 48, 31), 'min_temp_time': datetime.datetime(2019, 4, 14, 13, 3, 27), 'max_press': '666.88', 'min_press': '647.56', 'avg_press': '658.0', 'max_press_time': datetime.datetime(2019, 4, 14, 20, 48, 31), 'min_press_time': datetime.datetime(2019, 4, 14, 13, 3, 27), 'price': '0.000', 'use_volume_work': '18201.88', 'use_volume_std': '122120.22', 'use_money': '0.0', 'sum_total_volume': '42397031.141', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '658.0', 'press_out': '658.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000032å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000041
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000248'}]
0000000248
00176000000041
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000139')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000248', 'rtu_no': None, 'flmeter_no': '00176000000041', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 7, 928061), 'year': '2019', 'std_sum': '1012120.000', 'work_sum': '931376.000', 'max_std_flow': '98.55', 'min_std_flow': '0.0', 'avg_std_flow': '15.0', 'max_std_flow_time': datetime.datetime(2019, 4, 17, 0, 11, 56), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 22, 1, 11), 'max_work_flow': '90.95', 'min_work_flow': '0.0', 'avg_work_flow': '14.0', 'max_work_flow_time': datetime.datetime(2019, 4, 17, 0, 11, 56), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 22, 1, 11), 'max_temperature': '26.7', 'min_temperature': '12.4', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 5, 1, 3, 48, 34), 'min_temp_time': datetime.datetime(2019, 4, 14, 22, 1, 11), 'max_press': '109.2', 'min_press': '107.8', 'avg_press': '108.0', 'max_press_time': datetime.datetime(2019, 5, 1, 3, 48, 34), 'min_press_time': datetime.datetime(2019, 5, 1, 15, 29, 45), 'price': '0.000', 'use_volume_work': '2646.0', 'use_volume_std': '2868.0', 'use_money': '0.0', 'sum_total_volume': '1012120.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '108.0', 'press_out': '108.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000041å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000092
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000249'}]
0000000249
00176000000092
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000145')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000249', 'rtu_no': None, 'flmeter_no': '00176000000092', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 8, 273057), 'year': '2019', 'std_sum': '4157440.000', 'work_sum': '2869564.000', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 7, 8, 14, 20), 'min_std_flow_time': datetime.datetime(2019, 4, 13, 17, 14, 22), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 7, 8, 14, 20), 'min_work_flow_time': datetime.datetime(2019, 4, 13, 17, 14, 22), 'max_temperature': '39.2', 'min_temperature': '11.5', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 4, 17, 17, 52, 1), 'min_temp_time': datetime.datetime(2019, 5, 1, 4, 22, 45), 'max_press': '154.2', 'min_press': '149.2', 'avg_press': '150.0', 'max_press_time': datetime.datetime(2019, 4, 17, 17, 52, 1), 'min_press_time': datetime.datetime(2019, 5, 1, 4, 22, 45), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '4157440.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '150.0', 'press_out': '150.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000092å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000121
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000250'}]
0000000250
00176000000121
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000159')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000250', 'rtu_no': None, 'flmeter_no': '00176000000121', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 8, 638081), 'year': '2019', 'std_sum': '111836.000', 'work_sum': '112728.000', 'max_std_flow': '12.99', 'min_std_flow': '0.0', 'avg_std_flow': '5.0', 'max_std_flow_time': datetime.datetime(2019, 4, 17, 12, 40, 46), 'min_std_flow_time': datetime.datetime(2019, 4, 16, 3, 17, 42), 'max_work_flow': '13.15', 'min_work_flow': '0.0', 'avg_work_flow': '5.0', 'max_work_flow_time': datetime.datetime(2019, 4, 17, 12, 40, 46), 'min_work_flow_time': datetime.datetime(2019, 4, 16, 3, 17, 42), 'max_temperature': '25.7', 'min_temperature': '21.1', 'avg_temperature': '23.0', 'max_temp_time': datetime.datetime(2019, 5, 6, 11, 30, 50), 'min_temp_time': datetime.datetime(2019, 4, 16, 3, 17, 42), 'max_press': '104.0', 'min_press': '102.0', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 4, 17, 12, 40, 46), 'min_press_time': datetime.datetime(2019, 4, 16, 3, 17, 42), 'price': '0.000', 'use_volume_work': '1503.0', 'use_volume_std': '1481.0', 'use_money': '0.0', 'sum_total_volume': '111836.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '23.0', 'temp_out': '23.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000121å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000061
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000251'}]
0000000251
00176000000061
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000176')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000251', 'rtu_no': None, 'flmeter_no': '00176000000061', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 8, 992266), 'year': '2019', 'std_sum': '1457115.530', 'work_sum': '1319627.130', 'max_std_flow': '68.3', 'min_std_flow': '0.0', 'avg_std_flow': '27.0', 'max_std_flow_time': datetime.datetime(2019, 4, 16, 7, 7, 40), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 11, 11, 26), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 16, 7, 7, 40), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 11, 11, 26), 'max_temperature': '21.3', 'min_temperature': '11.6', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 4, 16, 7, 7, 40), 'min_temp_time': datetime.datetime(2019, 4, 14, 11, 11, 26), 'max_press': '112.4', 'min_press': '109.6', 'avg_press': '110.0', 'max_press_time': datetime.datetime(2019, 4, 16, 7, 7, 40), 'min_press_time': datetime.datetime(2019, 4, 14, 11, 11, 26), 'price': '0.000', 'use_volume_work': '2050.24', 'use_volume_std': '2252.87', 'use_money': '0.0', 'sum_total_volume': '1457115.530', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '110.0', 'press_out': '110.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000061å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000098
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000252'}]
0000000252
00176000000098
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000147')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000252', 'rtu_no': None, 'flmeter_no': '00176000000098', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 9, 333222), 'year': '2019', 'std_sum': '3170802.000', 'work_sum': '1805774.000', 'max_std_flow': '192.28', 'min_std_flow': '0.0', 'avg_std_flow': '66.0', 'max_std_flow_time': datetime.datetime(2019, 4, 15, 15, 13, 23), 'min_std_flow_time': datetime.datetime(2019, 4, 15, 16, 20, 8), 'max_work_flow': '108.11', 'min_work_flow': '0.0', 'avg_work_flow': '36.0', 'max_work_flow_time': datetime.datetime(2019, 4, 15, 15, 13, 23), 'min_work_flow_time': datetime.datetime(2019, 4, 15, 16, 20, 8), 'max_temperature': '20.6', 'min_temperature': '10.0', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 4, 15, 15, 13, 23), 'min_temp_time': datetime.datetime(2019, 4, 15, 16, 20, 8), 'max_press': '192.8', 'min_press': '180.3', 'avg_press': '186.0', 'max_press_time': datetime.datetime(2019, 4, 15, 15, 13, 23), 'min_press_time': datetime.datetime(2019, 4, 15, 16, 20, 8), 'price': '0.000', 'use_volume_work': '3383.0', 'use_volume_std': '6166.0', 'use_money': '0.0', 'sum_total_volume': '3170802.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '186.0', 'press_out': '186.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000098å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000085
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000253'}]
0000000253
00176000000085
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000160')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000253', 'rtu_no': None, 'flmeter_no': '00176000000085', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 9, 658352), 'year': '2019', 'std_sum': '1030087.000', 'work_sum': '824193.000', 'max_std_flow': '59.35', 'min_std_flow': '0.0', 'avg_std_flow': '27.0', 'max_std_flow_time': datetime.datetime(2019, 4, 15, 5, 57, 56), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 11, 11, 10), 'max_work_flow': '46.29', 'min_work_flow': '0.0', 'avg_work_flow': '22.0', 'max_work_flow_time': datetime.datetime(2019, 4, 15, 5, 57, 56), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 11, 11, 10), 'max_temperature': '30.8', 'min_temperature': '13.4', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 5, 7, 2, 12, 8), 'min_temp_time': datetime.datetime(2019, 4, 14, 11, 11, 10), 'max_press': '129.4', 'min_press': '125.6', 'avg_press': '126.0', 'max_press_time': datetime.datetime(2019, 4, 15, 5, 57, 56), 'min_press_time': datetime.datetime(2019, 4, 14, 11, 11, 10), 'price': '0.000', 'use_volume_work': '7787.0', 'use_volume_std': '9798.0', 'use_money': '0.0', 'sum_total_volume': '1030087.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '126.0', 'press_out': '126.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000085å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000020
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000254'}]
0000000254
00176000000020
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000175')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000254', 'rtu_no': None, 'flmeter_no': '00176000000020', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 10, 68259), 'year': '2019', 'std_sum': '12558151.000', 'work_sum': '5657701.000', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 20, 11, 25, 19), 'min_std_flow_time': datetime.datetime(2019, 4, 7, 15, 16, 6), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 20, 11, 25, 19), 'min_work_flow_time': datetime.datetime(2019, 4, 7, 15, 16, 6), 'max_temperature': '24.34', 'min_temperature': '14.04', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 5, 20, 11, 25, 19), 'min_temp_time': datetime.datetime(2019, 4, 7, 15, 16, 6), 'max_press': '153.84', 'min_press': '143.49', 'avg_press': '149.0', 'max_press_time': datetime.datetime(2019, 4, 28, 18, 47, 2), 'min_press_time': datetime.datetime(2019, 4, 7, 15, 16, 6), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '12558151.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '149.0', 'press_out': '149.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000020å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000090
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000255'}]
0000000255
00176000000090
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000112')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000255', 'rtu_no': None, 'flmeter_no': '00176000000090', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 10, 400367), 'year': '2019', 'std_sum': '3945419.019', 'work_sum': '3553907.000', 'max_std_flow': '140.11', 'min_std_flow': '7.65', 'avg_std_flow': '76.0', 'max_std_flow_time': datetime.datetime(2019, 4, 11, 10, 44, 51), 'min_std_flow_time': datetime.datetime(2019, 4, 7, 15, 7, 48), 'max_work_flow': '125.61', 'min_work_flow': '7.03', 'avg_work_flow': '69.0', 'max_work_flow_time': datetime.datetime(2019, 4, 11, 10, 44, 51), 'min_work_flow_time': datetime.datetime(2019, 4, 7, 15, 7, 48), 'max_temperature': '19.54', 'min_temperature': '13.98', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 4, 11, 10, 44, 51), 'min_temp_time': datetime.datetime(2019, 4, 7, 15, 7, 48), 'max_press': '112.57', 'min_press': '108.21', 'avg_press': '110.0', 'max_press_time': datetime.datetime(2019, 4, 11, 10, 44, 51), 'min_press_time': datetime.datetime(2019, 4, 7, 15, 7, 48), 'price': '0.000', 'use_volume_work': '8568.0', 'use_volume_std': '9459.53', 'use_money': '0.0', 'sum_total_volume': '3945419.019', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '110.0', 'press_out': '110.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000090å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000080
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000256'}]
0000000256
00176000000080
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000156')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000256', 'rtu_no': None, 'flmeter_no': '00176000000080', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 10, 720520), 'year': '2019', 'std_sum': '2857428.390', 'work_sum': '2194386.080', 'max_std_flow': '90.2', 'min_std_flow': '0.0', 'avg_std_flow': '12.0', 'max_std_flow_time': datetime.datetime(2019, 4, 14, 1, 11, 35), 'min_std_flow_time': datetime.datetime(2019, 4, 16, 7, 56, 56), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 1, 5, 8, 46), 'min_work_flow_time': datetime.datetime(2019, 4, 16, 7, 56, 56), 'max_temperature': '27.5', 'min_temperature': '10.8', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 4, 14, 1, 11, 35), 'min_temp_time': datetime.datetime(2019, 4, 16, 7, 56, 56), 'max_press': '132.0', 'min_press': '129.6', 'avg_press': '130.0', 'max_press_time': datetime.datetime(2019, 4, 14, 1, 11, 35), 'min_press_time': datetime.datetime(2019, 4, 16, 7, 56, 56), 'price': '0.000', 'use_volume_work': '946.81', 'use_volume_std': '1231.15', 'use_money': '0.0', 'sum_total_volume': '2857428.390', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '130.0', 'press_out': '130.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000080å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000021
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000257'}]
0000000257
00176000000021
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000133')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000257', 'rtu_no': None, 'flmeter_no': '00176000000021', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 11, 148369), 'year': '2019', 'std_sum': '14991636.000', 'work_sum': '10527059.000', 'max_std_flow': '701.37', 'min_std_flow': '0.0', 'avg_std_flow': '221.0', 'max_std_flow_time': datetime.datetime(2019, 5, 7, 5, 55, 55), 'min_std_flow_time': datetime.datetime(2019, 4, 7, 15, 35, 58), 'max_work_flow': '720.0', 'min_work_flow': '0.0', 'avg_work_flow': '151.0', 'max_work_flow_time': datetime.datetime(2019, 4, 11, 20, 14, 22), 'min_work_flow_time': datetime.datetime(2019, 4, 7, 15, 35, 58), 'max_temperature': '28.09', 'min_temperature': '14.05', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 4, 11, 20, 14, 22), 'min_temp_time': datetime.datetime(2019, 4, 7, 15, 35, 58), 'max_press': '153.88', 'min_press': '143.18', 'avg_press': '150.0', 'max_press_time': datetime.datetime(2019, 4, 11, 20, 14, 22), 'min_press_time': datetime.datetime(2019, 4, 7, 15, 35, 58), 'price': '0.000', 'use_volume_work': '89390.0', 'use_volume_std': '130804.0', 'use_money': '0.0', 'sum_total_volume': '14991636.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '150.0', 'press_out': '150.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000021å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000088
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000258'}]
0000000258
00176000000088
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000158')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000258', 'rtu_no': None, 'flmeter_no': '00176000000088', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 11, 503418), 'year': '2019', 'std_sum': '74635.000', 'work_sum': '54402.000', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 4, 15, 22, 2), 'min_std_flow_time': datetime.datetime(2019, 4, 13, 17, 24, 14), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 4, 15, 22, 2), 'min_work_flow_time': datetime.datetime(2019, 4, 13, 17, 24, 14), 'max_temperature': '20.6', 'min_temperature': '15.3', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 5, 4, 15, 22, 2), 'min_temp_time': datetime.datetime(2019, 4, 13, 17, 24, 14), 'max_press': '134.9', 'min_press': '131.6', 'avg_press': '133.0', 'max_press_time': datetime.datetime(2019, 4, 16, 20, 1, 16), 'min_press_time': datetime.datetime(2019, 5, 1, 2, 45, 56), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '74635.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '133.0', 'press_out': '133.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000088å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000027
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000259'}]
0000000259
00176000000027
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000114')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000259', 'rtu_no': None, 'flmeter_no': '00176000000027', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 11, 820712), 'year': '2019', 'std_sum': '223.000', 'work_sum': '5335.000', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 21, 1, 47, 12), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 11, 51, 6), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 21, 1, 47, 12), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 11, 51, 6), 'max_temperature': '34.64', 'min_temperature': '7.21', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 4, 21, 1, 47, 12), 'min_temp_time': datetime.datetime(2019, 4, 14, 11, 51, 6), 'max_press': '506.85', 'min_press': '477.7', 'avg_press': '488.0', 'max_press_time': datetime.datetime(2019, 4, 21, 1, 47, 12), 'min_press_time': datetime.datetime(2019, 4, 14, 11, 51, 6), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '223.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '488.0', 'press_out': '488.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000027å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000026
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000260'}]
0000000260
00176000000026
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000128')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000260', 'rtu_no': None, 'flmeter_no': '00176000000026', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 12, 138719), 'year': '2019', 'std_sum': '188132104.616', 'work_sum': '20728180.000', 'max_std_flow': '9602.99', 'min_std_flow': '2413.95', 'avg_std_flow': '6307.0', 'max_std_flow_time': datetime.datetime(2019, 5, 7, 17, 56, 43), 'min_std_flow_time': datetime.datetime(2019, 5, 4, 2, 30, 3), 'max_work_flow': '1193.4', 'min_work_flow': '259.05', 'avg_work_flow': '686.0', 'max_work_flow_time': datetime.datetime(2019, 4, 15, 10, 20, 40), 'min_work_flow_time': datetime.datetime(2019, 5, 4, 2, 30, 3), 'max_temperature': '20.15', 'min_temperature': '10.66', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 5, 7, 17, 56, 43), 'min_temp_time': datetime.datetime(2019, 5, 4, 2, 30, 3), 'max_press': '905.45', 'min_press': '887.59', 'avg_press': '894.0', 'max_press_time': datetime.datetime(2019, 5, 7, 17, 56, 43), 'min_press_time': datetime.datetime(2019, 4, 19, 2, 38, 33), 'price': '0.000', 'use_volume_work': '236240.0', 'use_volume_std': '2170869.52', 'use_money': '0.0', 'sum_total_volume': '188132104.616', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '894.0', 'press_out': '894.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000026å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000050
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000261'}]
0000000261
00176000000050
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000171')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000261', 'rtu_no': None, 'flmeter_no': '00176000000050', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 12, 542639), 'year': '2019', 'std_sum': '2552074.000', 'work_sum': '2196283.000', 'max_std_flow': '328.29', 'min_std_flow': '0.0', 'avg_std_flow': '30.0', 'max_std_flow_time': datetime.datetime(2019, 4, 16, 6, 25, 35), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 13, 11, 52), 'max_work_flow': '285.84', 'min_work_flow': '0.0', 'avg_work_flow': '26.0', 'max_work_flow_time': datetime.datetime(2019, 4, 16, 6, 25, 35), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 13, 11, 52), 'max_temperature': '23.5', 'min_temperature': '15.1', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 5, 3, 14, 41, 12), 'min_temp_time': datetime.datetime(2019, 4, 14, 13, 11, 52), 'max_press': '118.3', 'min_press': '115.7', 'avg_press': '117.0', 'max_press_time': datetime.datetime(2019, 4, 16, 6, 25, 35), 'min_press_time': datetime.datetime(2019, 4, 14, 13, 11, 52), 'price': '0.000', 'use_volume_work': '5433.0', 'use_volume_std': '6290.0', 'use_money': '0.0', 'sum_total_volume': '2552074.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '117.0', 'press_out': '117.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000050å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000124
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000262'}]
0000000262
00176000000124
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000138')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000262', 'rtu_no': None, 'flmeter_no': '00176000000124', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 12, 872759), 'year': '2019', 'std_sum': '88179.000', 'work_sum': '86031.000', 'max_std_flow': '9.55', 'min_std_flow': '0.0', 'avg_std_flow': '2.0', 'max_std_flow_time': datetime.datetime(2019, 5, 5, 9, 50, 50), 'min_std_flow_time': datetime.datetime(2019, 4, 16, 3, 3, 7), 'max_work_flow': '9.66', 'min_work_flow': '0.0', 'avg_work_flow': '2.0', 'max_work_flow_time': datetime.datetime(2019, 5, 5, 9, 50, 50), 'min_work_flow_time': datetime.datetime(2019, 4, 16, 3, 3, 7), 'max_temperature': '25.8', 'min_temperature': '12.9', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 4, 15, 8, 42, 45), 'min_temp_time': datetime.datetime(2019, 4, 16, 3, 3, 7), 'max_press': '104.2', 'min_press': '102.4', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 4, 15, 8, 42, 45), 'min_press_time': datetime.datetime(2019, 5, 1, 20, 5, 46), 'price': '0.000', 'use_volume_work': '905.0', 'use_volume_std': '926.0', 'use_money': '0.0', 'sum_total_volume': '88179.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000124å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000039
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000263'}]
0000000263
00176000000039
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000137')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000263', 'rtu_no': None, 'flmeter_no': '00176000000039', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 13, 188911), 'year': '2019', 'std_sum': '758526.397', 'work_sum': '673801.814', 'max_std_flow': '40.77', 'min_std_flow': '0.0', 'avg_std_flow': '7.0', 'max_std_flow_time': datetime.datetime(2019, 4, 16, 9, 14, 57), 'min_std_flow_time': datetime.datetime(2019, 4, 16, 14, 47, 31), 'max_work_flow': '34.57', 'min_work_flow': '0.0', 'avg_work_flow': '6.0', 'max_work_flow_time': datetime.datetime(2019, 4, 16, 9, 14, 57), 'min_work_flow_time': datetime.datetime(2019, 4, 16, 14, 47, 31), 'max_temperature': '22.04', 'min_temperature': '13.95', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 5, 8, 4, 27, 33), 'min_temp_time': datetime.datetime(2019, 4, 16, 14, 47, 31), 'max_press': '118.93', 'min_press': '113.31', 'avg_press': '115.0', 'max_press_time': datetime.datetime(2019, 4, 16, 9, 14, 57), 'min_press_time': datetime.datetime(2019, 5, 2, 6, 0, 54), 'price': '0.000', 'use_volume_work': '1940.72', 'use_volume_std': '2292.38', 'use_money': '0.0', 'sum_total_volume': '758526.397', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '115.0', 'press_out': '115.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000039å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000110
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000264'}]
0000000264
00176000000110
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000178')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000264', 'rtu_no': None, 'flmeter_no': '00176000000110', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 13, 485119), 'year': '2019', 'std_sum': '3945133.234', 'work_sum': '1987748.000', 'max_std_flow': '275.46', 'min_std_flow': '0.0', 'avg_std_flow': '54.0', 'max_std_flow_time': datetime.datetime(2019, 4, 15, 6, 54, 53), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 23, 59, 41), 'max_work_flow': '145.04', 'min_work_flow': '0.0', 'avg_work_flow': '29.0', 'max_work_flow_time': datetime.datetime(2019, 5, 5, 6, 55, 30), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 23, 59, 41), 'max_temperature': '28.35', 'min_temperature': '12.4', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 4, 15, 6, 54, 53), 'min_temp_time': datetime.datetime(2019, 4, 14, 23, 59, 41), 'max_press': '192.36', 'min_press': '187.06', 'avg_press': '189.0', 'max_press_time': datetime.datetime(2019, 4, 15, 6, 54, 53), 'min_press_time': datetime.datetime(2019, 5, 1, 22, 34, 21), 'price': '0.000', 'use_volume_work': '6338.0', 'use_volume_std': '11771.89', 'use_money': '0.0', 'sum_total_volume': '3945133.234', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '189.0', 'press_out': '189.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000110å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000068
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000265'}]
0000000265
00176000000068
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000117')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000265', 'rtu_no': None, 'flmeter_no': '00176000000068', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 13, 802272), 'year': '2019', 'std_sum': '7289353.916', 'work_sum': '795029.156', 'max_std_flow': '411.99', 'min_std_flow': '0.0', 'avg_std_flow': '84.0', 'max_std_flow_time': datetime.datetime(2019, 4, 14, 5, 9, 23), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 9, 3, 7), 'max_work_flow': '44.32', 'min_work_flow': '0.0', 'avg_work_flow': '9.0', 'max_work_flow_time': datetime.datetime(2019, 4, 14, 5, 9, 23), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 9, 3, 7), 'max_temperature': '18.92', 'min_temperature': '13.67', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 4, 14, 5, 9, 23), 'min_temp_time': datetime.datetime(2019, 5, 1, 1, 28, 21), 'max_press': '903.11', 'min_press': '888.53', 'avg_press': '895.0', 'max_press_time': datetime.datetime(2019, 4, 14, 5, 9, 23), 'min_press_time': datetime.datetime(2019, 4, 14, 9, 3, 7), 'price': '0.000', 'use_volume_work': '933.44', 'use_volume_std': '8583.18', 'use_money': '0.0', 'sum_total_volume': '7289353.916', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '895.0', 'press_out': '895.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000068å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000004
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000266'}]
0000000266
00176000000004
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000108')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000266', 'rtu_no': None, 'flmeter_no': '00176000000004', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 14, 109449), 'year': '2019', 'std_sum': '60121384.000', 'work_sum': '7669286.000', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 9, 16, 53, 44), 'min_std_flow_time': datetime.datetime(2019, 4, 2, 0, 13, 28), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 9, 16, 53, 44), 'min_work_flow_time': datetime.datetime(2019, 4, 2, 0, 13, 28), 'max_temperature': '12.9', 'min_temperature': '12.9', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 4, 9, 16, 53, 44), 'min_temp_time': datetime.datetime(2019, 4, 2, 0, 13, 28), 'max_press': '771.85', 'min_press': '771.85', 'avg_press': '771.0', 'max_press_time': datetime.datetime(2019, 4, 9, 16, 53, 44), 'min_press_time': datetime.datetime(2019, 4, 2, 0, 13, 28), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '60121384.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '771.0', 'press_out': '771.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000004å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000062
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000267'}]
0000000267
00176000000062
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000121')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000267', 'rtu_no': None, 'flmeter_no': '00176000000062', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 14, 392828), 'year': '2019', 'std_sum': '2901534.510', 'work_sum': '2620031.390', 'max_std_flow': '452.0', 'min_std_flow': '0.0', 'avg_std_flow': '15.0', 'max_std_flow_time': datetime.datetime(2019, 5, 4, 7, 33, 45), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 10, 12, 54), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 4, 7, 33, 45), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 10, 12, 54), 'max_temperature': '24.6', 'min_temperature': '12.0', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 5, 4, 7, 33, 45), 'min_temp_time': datetime.datetime(2019, 4, 14, 10, 12, 54), 'max_press': '117.4', 'min_press': '109.8', 'avg_press': '113.0', 'max_press_time': datetime.datetime(2019, 4, 15, 11, 44, 55), 'min_press_time': datetime.datetime(2019, 4, 14, 10, 12, 54), 'price': '0.000', 'use_volume_work': '5960.31', 'use_volume_std': '6731.8', 'use_money': '0.0', 'sum_total_volume': '2901534.510', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '113.0', 'press_out': '113.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000062å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000123
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000268'}]
0000000268
00176000000123
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000120')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000268', 'rtu_no': None, 'flmeter_no': '00176000000123', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 14, 706852), 'year': '2019', 'std_sum': '923662.000', 'work_sum': '630434.000', 'max_std_flow': '82.43', 'min_std_flow': '0.0', 'avg_std_flow': '16.0', 'max_std_flow_time': datetime.datetime(2019, 5, 5, 7, 32, 6), 'min_std_flow_time': datetime.datetime(2019, 4, 14, 12, 59, 24), 'max_work_flow': '53.29', 'min_work_flow': '0.0', 'avg_work_flow': '10.0', 'max_work_flow_time': datetime.datetime(2019, 5, 5, 7, 32, 6), 'min_work_flow_time': datetime.datetime(2019, 4, 14, 12, 59, 24), 'max_temperature': '25.7', 'min_temperature': '12.1', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 5, 5, 7, 32, 6), 'min_temp_time': datetime.datetime(2019, 5, 1, 19, 57, 25), 'max_press': '164.2', 'min_press': '154.1', 'avg_press': '161.0', 'max_press_time': datetime.datetime(2019, 5, 5, 7, 32, 6), 'min_press_time': datetime.datetime(2019, 5, 1, 19, 57, 25), 'price': '0.000', 'use_volume_work': '5172.0', 'use_volume_std': '8118.0', 'use_money': '0.0', 'sum_total_volume': '923662.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '161.0', 'press_out': '161.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000123å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000056
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000269'}]
0000000269
00176000000056
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000168')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000269', 'rtu_no': None, 'flmeter_no': '00176000000056', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 14, 998079), 'year': '2019', 'std_sum': '2772765.000', 'work_sum': '2651135.000', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 13, 14, 25), 'min_std_flow_time': datetime.datetime(2019, 4, 13, 14, 25), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 13, 14, 25), 'min_work_flow_time': datetime.datetime(2019, 4, 13, 14, 25), 'max_temperature': '22.3', 'min_temperature': '22.3', 'avg_temperature': '22.0', 'max_temp_time': datetime.datetime(2019, 4, 13, 14, 25), 'min_temp_time': datetime.datetime(2019, 4, 13, 14, 25), 'max_press': '107.9', 'min_press': '107.9', 'avg_press': '107.0', 'max_press_time': datetime.datetime(2019, 4, 13, 14, 25), 'min_press_time': datetime.datetime(2019, 4, 13, 14, 25), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '2772765.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '107.0', 'press_out': '107.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000056å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000055
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000270'}]
0000000270
00176000000055
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000179')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000270', 'rtu_no': None, 'flmeter_no': '00176000000055', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 15, 306372), 'year': '2019', 'std_sum': '2179183.420', 'work_sum': '1709104.860', 'max_std_flow': '114.5', 'min_std_flow': '0.0', 'avg_std_flow': '33.0', 'max_std_flow_time': datetime.datetime(2019, 4, 15, 6, 46, 48), 'min_std_flow_time': datetime.datetime(2019, 4, 15, 23, 19, 50), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 15, 6, 46, 48), 'min_work_flow_time': datetime.datetime(2019, 4, 15, 23, 19, 50), 'max_temperature': '21.0', 'min_temperature': '12.3', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 4, 15, 6, 46, 48), 'min_temp_time': datetime.datetime(2019, 4, 15, 23, 19, 50), 'max_press': '133.9', 'min_press': '129.7', 'avg_press': '132.0', 'max_press_time': datetime.datetime(2019, 4, 15, 6, 46, 48), 'min_press_time': datetime.datetime(2019, 4, 15, 23, 19, 50), 'price': '0.000', 'use_volume_work': '2334.43', 'use_volume_std': '3036.63', 'use_money': '0.0', 'sum_total_volume': '2179183.420', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '132.0', 'press_out': '132.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000055å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000070
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000271'}]
0000000271
00176000000070
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000094')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000271', 'rtu_no': None, 'flmeter_no': '00176000000070', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 15, 589492), 'year': '2019', 'std_sum': '671366.010', 'work_sum': '657271.840', 'max_std_flow': '24.1', 'min_std_flow': '0.0', 'avg_std_flow': '1.0', 'max_std_flow_time': datetime.datetime(2019, 4, 13, 19, 22, 53), 'min_std_flow_time': datetime.datetime(2019, 4, 13, 22, 5, 34), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 13, 19, 22, 53), 'min_work_flow_time': datetime.datetime(2019, 4, 13, 22, 5, 34), 'max_temperature': '27.6', 'min_temperature': '17.8', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 4, 13, 19, 22, 53), 'min_temp_time': datetime.datetime(2019, 4, 13, 22, 5, 34), 'max_press': '103.1', 'min_press': '102.5', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 4, 13, 19, 22, 53), 'min_press_time': datetime.datetime(2019, 4, 13, 22, 5, 34), 'price': '0.000', 'use_volume_work': '110.99', 'use_volume_std': '111.72', 'use_money': '0.0', 'sum_total_volume': '671366.010', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000070å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000077
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000272'}]
0000000272
00176000000077
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000098')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000272', 'rtu_no': None, 'flmeter_no': '00176000000077', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 15, 886698), 'year': '2019', 'std_sum': '1369018.080', 'work_sum': '1292392.370', 'max_std_flow': '116.1', 'min_std_flow': '0.0', 'avg_std_flow': '5.0', 'max_std_flow_time': datetime.datetime(2019, 5, 15, 9, 57, 5), 'min_std_flow_time': datetime.datetime(2019, 5, 14, 20, 4, 57), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 15, 9, 57, 5), 'min_work_flow_time': datetime.datetime(2019, 5, 14, 20, 4, 57), 'max_temperature': '25.8', 'min_temperature': '18.7', 'avg_temperature': '21.0', 'max_temp_time': datetime.datetime(2019, 5, 15, 9, 57, 5), 'min_temp_time': datetime.datetime(2019, 5, 14, 20, 4, 57), 'max_press': '108.5', 'min_press': '106.7', 'avg_press': '107.0', 'max_press_time': datetime.datetime(2019, 5, 15, 9, 57, 5), 'min_press_time': datetime.datetime(2019, 5, 14, 20, 4, 57), 'price': '0.000', 'use_volume_work': '1279.34', 'use_volume_std': '1335.36', 'use_money': '0.0', 'sum_total_volume': '1369018.080', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '107.0', 'press_out': '107.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000077å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00176000000087
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0017', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000273'}]
0000000273
00176000000087
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0017', '00172019080000000144')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0017', 'sry_id': '00172019080000000273', 'rtu_no': None, 'flmeter_no': '00176000000087', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 16, 202852), 'year': '2019', 'std_sum': '4916007.810', 'work_sum': '4582382.018', 'max_std_flow': '248.9', 'min_std_flow': '0.0', 'avg_std_flow': '111.0', 'max_std_flow_time': datetime.datetime(2019, 5, 1, 16, 30, 27), 'min_std_flow_time': datetime.datetime(2019, 4, 13, 13, 33, 58), 'max_work_flow': '229.49', 'min_work_flow': '0.0', 'avg_work_flow': '100.0', 'max_work_flow_time': datetime.datetime(2019, 5, 1, 16, 30, 27), 'min_work_flow_time': datetime.datetime(2019, 4, 13, 13, 33, 58), 'max_temperature': '21.89', 'min_temperature': '13.08', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 5, 1, 16, 30, 27), 'min_temp_time': datetime.datetime(2019, 4, 13, 13, 33, 58), 'max_press': '114.32', 'min_press': '108.79', 'avg_press': '111.0', 'max_press_time': datetime.datetime(2019, 4, 15, 3, 57, 33), 'min_press_time': datetime.datetime(2019, 5, 1, 2, 34, 2), 'price': '0.000', 'use_volume_work': '14647.0', 'use_volume_std': '16243.58', 'use_money': '0.0', 'sum_total_volume': '4916007.810', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '111.0', 'press_out': '111.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00176000000087å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
0017 data_processing is ok
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0005
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 323
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0005 2019 å¼€å§‹è¿›è¡Œè®¡ç®—å¹´æŠ¥è¡¨æ•°æ®å¤„ç†
ä¸åŒçš„è¡¨è®¡å·å…±æœ‰ä¸ªæ•°: 59
æ ¹æ®è¡¨è®¡å·ï¼Œè¿›è¡Œæ•°æ®çš„å†æ¬¡ç­›é€‰ï¼Œå¤„ç†ï¼Œå†™å…¥æ•°æ®åº“
----------------------------------------------------------------------------------------
00056000000041
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000119'}]
0000000119
00056000000041 â˜† sum_total_money <0 ç½®ä¸º0
00056000000041
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000101')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000119', 'rtu_no': '00050000000034', 'flmeter_no': '00056000000041', 'customer_no': '00050000000031', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 16, 670601), 'year': '2019', 'std_sum': '363514', 'work_sum': '330107', 'max_std_flow': '1.52', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 2, 12, 42, 9), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 22, 58, 35), 'max_work_flow': '1.85', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 2, 12, 42, 9), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 22, 58, 35), 'max_temperature': '26.22', 'min_temperature': '13.71', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 7, 2, 12, 42, 9), 'min_temp_time': datetime.datetime(2019, 5, 1, 15, 29, 35), 'max_press': '83.5', 'min_press': '83.5', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 8, 1, 15, 21, 54), 'min_press_time': datetime.datetime(2019, 4, 29, 22, 58, 35), 'price': '1.61', 'use_volume_work': '9.0', 'use_volume_std': '9.0', 'use_money': '14.49', 'sum_total_volume': '330107', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '21788.41', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000041å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000015
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000120'}]
0000000120
00056000000015 â˜† sum_total_money <0 ç½®ä¸º0
00056000000015
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000089')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000120', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000015', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 17, 47737), 'year': '2019', 'std_sum': '340632', 'work_sum': '247686', 'max_std_flow': '104.72', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 15, 23, 7, 46), 'min_std_flow_time': datetime.datetime(2019, 1, 20, 1, 38, 23), 'max_work_flow': '126.3', 'min_work_flow': '0.0', 'avg_work_flow': '1.0', 'max_work_flow_time': datetime.datetime(2019, 4, 15, 23, 7, 46), 'min_work_flow_time': datetime.datetime(2019, 1, 20, 1, 38, 23), 'max_temperature': '24.07', 'min_temperature': '10.15', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 7, 27, 18, 21, 3), 'min_temp_time': datetime.datetime(2019, 4, 1, 1, 40, 1), 'max_press': '83.5', 'min_press': '83.5', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 8, 1, 21, 47, 57), 'min_press_time': datetime.datetime(2019, 1, 20, 1, 38, 23), 'price': '1.63', 'use_volume_work': '31698.0', 'use_volume_std': '31698.0', 'use_money': '49317.36', 'sum_total_volume': '247686', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '41262.13', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000015å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000043
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000121'}]
0000000121
00056000000043 â˜† sum_total_money <0 ç½®ä¸º0
00056000000043
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000084')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000121', 'rtu_no': '00050000000035', 'flmeter_no': '00056000000043', 'customer_no': '00050000000032', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 17, 352778), 'year': '2019', 'std_sum': '111062', 'work_sum': '111062', 'max_std_flow': '2.08', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 22, 3, 34, 10), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 21, 46, 22), 'max_work_flow': '2.44', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 22, 3, 34, 10), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 21, 46, 22), 'max_temperature': '23.06', 'min_temperature': '13.27', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 5, 27, 8, 44, 9), 'min_temp_time': datetime.datetime(2019, 5, 1, 17, 16, 17), 'max_press': '86.29', 'min_press': '86.29', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2019, 8, 1, 8, 31, 1), 'min_press_time': datetime.datetime(2019, 4, 29, 21, 46, 22), 'price': '1.58', 'use_volume_work': '1114.0', 'use_volume_std': '1114.0', 'use_money': '1760.12', 'sum_total_volume': '111062', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '21455.75', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000043å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000050
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000122'}]
0000000122
00056000000050 â˜† sum_total_money <0 ç½®ä¸º0
00056000000050
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000079')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000122', 'rtu_no': '00050000000038', 'flmeter_no': '00056000000050', 'customer_no': '00050000000035', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 17, 643002), 'year': '2019', 'std_sum': '345636', 'work_sum': '362084', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 2, 16, 39, 33), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 3, 13, 23), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 2, 16, 39, 33), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 3, 13, 23), 'max_temperature': '22.6', 'min_temperature': '13.25', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 7, 31, 0, 17, 27), 'min_temp_time': datetime.datetime(2019, 5, 1, 0, 7, 26), 'max_press': '99.32', 'min_press': '96.36', 'avg_press': '97.0', 'max_press_time': datetime.datetime(2019, 5, 30, 18, 12, 23), 'min_press_time': datetime.datetime(2019, 7, 1, 0, 9, 24), 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '345636', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1828.14', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '97.0', 'press_out': '97.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000050å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000048
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000123'}]
0000000123
00056000000048 â˜† sum_total_money <0 ç½®ä¸º0
00056000000048
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000066')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000123', 'rtu_no': '00050000000038', 'flmeter_no': '00056000000048', 'customer_no': '00050000000035', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 18, 70858), 'year': '2019', 'std_sum': '359125', 'work_sum': '382221', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 2, 16, 39, 31), 'min_std_flow_time': datetime.datetime(2019, 4, 28, 22, 53, 22), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 2, 16, 39, 31), 'min_work_flow_time': datetime.datetime(2019, 4, 28, 22, 53, 22), 'max_temperature': '23.08', 'min_temperature': '12.08', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 7, 31, 0, 17, 25), 'min_temp_time': datetime.datetime(2019, 5, 1, 11, 37, 27), 'max_press': '99.02', 'min_press': '95.97', 'avg_press': '96.0', 'max_press_time': datetime.datetime(2019, 5, 30, 18, 7, 21), 'min_press_time': datetime.datetime(2019, 7, 1, 0, 9, 23), 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '359125', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '3279.64', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '96.0', 'press_out': '96.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000048å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000013
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000124'}]
0000000124
00056000000013 â˜† sum_total_money <0 ç½®ä¸º0
00056000000013
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000080')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000124', 'rtu_no': '00050000000012', 'flmeter_no': '00056000000013', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 18, 370058), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '35.91', 'min_std_flow': '0.0', 'avg_std_flow': '19.0', 'max_std_flow_time': datetime.datetime(2019, 7, 17, 16, 12, 15), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 0, 32, 24), 'max_work_flow': '35.91', 'min_work_flow': '0.0', 'avg_work_flow': '19.0', 'max_work_flow_time': datetime.datetime(2019, 7, 17, 16, 12, 15), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 0, 32, 24), 'max_temperature': '35.91', 'min_temperature': '0.0', 'avg_temperature': '35.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 13, 52), 'min_temp_time': datetime.datetime(2019, 1, 4, 0, 32, 24), 'max_press': '101.32', 'min_press': '0.0', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 13, 52), 'min_press_time': datetime.datetime(2019, 1, 4, 0, 32, 24), 'price': '2.27', 'use_volume_work': '0.0', 'use_volume_std': '115948.0', 'use_money': '264252.06', 'sum_total_volume': '116584', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '9259.92', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '35.0', 'temp_out': '35.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000013å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000040
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000125'}]
0000000125
00056000000040 â˜† sum_total_money <0 ç½®ä¸º0
00056000000040
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000106')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000125', 'rtu_no': '00050000000033', 'flmeter_no': '00056000000040', 'customer_no': '00050000000030', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 18, 675242), 'year': '2019', 'std_sum': '4630', 'work_sum': '4630', 'max_std_flow': '1.28', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 6, 13, 2, 41, 6), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 17, 29, 44), 'max_work_flow': '1.5', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 6, 13, 2, 41, 6), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 17, 29, 44), 'max_temperature': '22.68', 'min_temperature': '13.1', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 7, 14, 19, 20, 22), 'min_temp_time': datetime.datetime(2019, 5, 1, 15, 24, 45), 'max_press': '86.29', 'min_press': '86.29', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2019, 8, 1, 17, 46, 29), 'min_press_time': datetime.datetime(2019, 4, 29, 17, 29, 44), 'price': '2.27', 'use_volume_work': '15.0', 'use_volume_std': '15.0', 'use_money': '34.05', 'sum_total_volume': '4630', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '627.78', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000040å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000019
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000126'}]
0000000126
00056000000019 â˜† sum_total_money <0 ç½®ä¸º0
00056000000019
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000107')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000126', 'rtu_no': '00050000000016', 'flmeter_no': '00056000000019', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 18, 965465), 'year': '2019', 'std_sum': '196376', 'work_sum': '180161', 'max_std_flow': '2.18', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 6, 13, 20, 39, 53), 'min_std_flow_time': datetime.datetime(2019, 1, 18, 4, 53, 40), 'max_work_flow': '2.49', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 6, 13, 20, 39, 53), 'min_work_flow_time': datetime.datetime(2019, 1, 18, 4, 53, 40), 'max_temperature': '5.99', 'min_temperature': '0.0', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 22, 20, 44), 'min_temp_time': datetime.datetime(2019, 1, 18, 4, 53, 40), 'max_press': '98.34', 'min_press': '79.08', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2019, 3, 22, 8, 21, 40), 'min_press_time': datetime.datetime(2019, 6, 1, 0, 1, 4), 'price': '2.27', 'use_volume_work': '180157.0', 'use_volume_std': '16285.0', 'use_money': '37128.87', 'sum_total_volume': '180161', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '15260.86', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000019å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00050000000007
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000127'}]
0000000127
00050000000007 â˜† sum_total_money <0 ç½®ä¸º0
00050000000007
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000067')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000127', 'rtu_no': '00050000000002', 'flmeter_no': '00050000000007', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 19, 361410), 'year': '2019', 'std_sum': '1000', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 6, 13, 9, 3, 25), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 10, 44, 39), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 6, 13, 9, 3, 25), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 10, 44, 39), 'max_temperature': '35.91', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 21, 44, 39), 'min_temp_time': datetime.datetime(2019, 3, 4, 10, 44, 39), 'max_press': '101.32', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 6, 13, 9, 3, 25), 'min_press_time': datetime.datetime(2019, 3, 4, 10, 44, 39), 'price': '1.71', 'use_volume_work': '0.0', 'use_volume_std': '1000.0', 'use_money': '1580.0', 'sum_total_volume': '1000', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '305.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,æœªå¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00050000000007å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000026
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000128'}]
0000000128
00056000000026 â˜† sum_total_money <0 ç½®ä¸º0
00056000000026
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000076')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000128', 'rtu_no': '00050000000021', 'flmeter_no': '00056000000026', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 19, 678559), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 14, 16), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 1, 14, 35), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 14, 16), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 1, 14, 35), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 14, 16), 'min_temp_time': datetime.datetime(2019, 1, 4, 1, 14, 35), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 14, 16), 'min_press_time': datetime.datetime(2019, 1, 4, 1, 14, 35), 'price': '1.6', 'use_volume_work': '0.0', 'use_volume_std': '3392.0', 'use_money': '5441.19', 'sum_total_volume': '12353', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '3636.04', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000026å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000031
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000129'}]
0000000129
00056000000031 â˜† sum_total_money <0 ç½®ä¸º0
00056000000031
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000096')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000129', 'rtu_no': '00050000000026', 'flmeter_no': '00056000000031', 'customer_no': '00050000000023', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 19, 985761), 'year': '2019', 'std_sum': '420048', 'work_sum': '481632', 'max_std_flow': '279.36', 'min_std_flow': '0.0', 'avg_std_flow': '1.0', 'max_std_flow_time': datetime.datetime(2019, 5, 5, 7, 8, 41), 'min_std_flow_time': datetime.datetime(2019, 5, 1, 17, 16, 46), 'max_work_flow': '321.9', 'min_work_flow': '0.0', 'avg_work_flow': '1.0', 'max_work_flow_time': datetime.datetime(2019, 5, 5, 7, 8, 41), 'min_work_flow_time': datetime.datetime(2019, 5, 1, 17, 16, 46), 'max_temperature': '32.04', 'min_temperature': '17.82', 'avg_temperature': '26.0', 'max_temp_time': datetime.datetime(2019, 7, 31, 0, 15, 3), 'min_temp_time': datetime.datetime(2019, 5, 1, 17, 16, 46), 'max_press': '93.08', 'min_press': '75.15', 'avg_press': '85.0', 'max_press_time': datetime.datetime(2019, 5, 5, 7, 8, 41), 'min_press_time': datetime.datetime(2019, 6, 30, 23, 53, 36), 'price': '1.58', 'use_volume_work': '3982.0', 'use_volume_std': '3450.0', 'use_money': '5451.0', 'sum_total_volume': '420048', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '47226.7', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '85.0', 'press_out': '85.0', 'temp_in': '26.0', 'temp_out': '26.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000031å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000058
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000130'}]
0000000130
00056000000058 â˜† sum_total_money <0 ç½®ä¸º0
00056000000058
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000088')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000130', 'rtu_no': '00050000000043', 'flmeter_no': '00056000000058', 'customer_no': '00050000000040', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 20, 282942), 'year': '2019', 'std_sum': '884216', 'work_sum': '883726', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 2), 'min_std_flow_time': datetime.datetime(2019, 4, 28, 19, 4, 17), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 2), 'min_work_flow_time': datetime.datetime(2019, 4, 28, 19, 4, 17), 'max_temperature': '15.09', 'min_temperature': '12.83', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 4, 29, 10, 9, 16), 'min_temp_time': datetime.datetime(2019, 4, 28, 19, 4, 17), 'max_press': '100.85', 'min_press': '100.4', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 4, 29, 10, 9, 16), 'min_press_time': datetime.datetime(2019, 7, 29, 11, 44, 20), 'price': '1.77', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '884216', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5462.22', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000058å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000025
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000131'}]
0000000131
00056000000025 â˜† sum_total_money <0 ç½®ä¸º0
00056000000025
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000118')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000131', 'rtu_no': '00050000000020', 'flmeter_no': '00056000000025', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 20, 683869), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 14, 47), 'min_std_flow_time': datetime.datetime(2019, 1, 3, 14, 14, 15), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 14, 47), 'min_work_flow_time': datetime.datetime(2019, 1, 3, 14, 14, 15), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 14, 47), 'min_temp_time': datetime.datetime(2019, 1, 3, 14, 14, 15), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 14, 47), 'min_press_time': datetime.datetime(2019, 1, 3, 14, 14, 15), 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '12293.0', 'use_money': '28028.04', 'sum_total_volume': '47674', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '13689.99', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000025å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000021
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 7
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000132'}]
0000000132
00056000000021 â˜† sum_total_money <0 ç½®ä¸º0
00056000000021
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000112')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000132', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000021', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 20, 991053), 'year': '2019', 'std_sum': '88645', 'work_sum': '95985', 'max_std_flow': '143.92', 'min_std_flow': '0.0', 'avg_std_flow': '5.0', 'max_std_flow_time': datetime.datetime(2019, 7, 24, 6, 6, 33), 'min_std_flow_time': datetime.datetime(2019, 1, 3, 13, 15, 19), 'max_work_flow': '157.06', 'min_work_flow': '0.0', 'avg_work_flow': '6.0', 'max_work_flow_time': datetime.datetime(2019, 7, 24, 6, 6, 33), 'min_work_flow_time': datetime.datetime(2019, 1, 3, 13, 15, 19), 'max_temperature': '38.08', 'min_temperature': '17.25', 'avg_temperature': '31.0', 'max_temp_time': datetime.datetime(2019, 7, 24, 6, 6, 33), 'min_temp_time': datetime.datetime(2019, 1, 3, 13, 15, 19), 'max_press': '99.56', 'min_press': '75.04', 'avg_press': '97.0', 'max_press_time': datetime.datetime(2019, 5, 5, 5, 58, 59), 'min_press_time': datetime.datetime(2019, 7, 1, 0, 0, 39), 'price': '1.59', 'use_volume_work': '52183.0', 'use_volume_std': '48149.0', 'use_money': '73338.08', 'sum_total_volume': '88645', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '7123.89', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '97.0', 'press_out': '97.0', 'temp_in': '31.0', 'temp_out': '31.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000021å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00050000000006
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000133'}]
0000000133
00050000000006 â˜† sum_total_money <0 ç½®ä¸º0
00050000000006
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000087')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000133', 'rtu_no': '00050000000002', 'flmeter_no': '00050000000006', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 21, 308201), 'year': '2019', 'std_sum': '1000', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 6, 13, 9, 3, 23), 'min_std_flow_time': datetime.datetime(2019, 3, 2, 15, 40, 46), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 6, 13, 9, 3, 23), 'min_work_flow_time': datetime.datetime(2019, 3, 2, 15, 40, 46), 'max_temperature': '35.91', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 21, 39, 39), 'min_temp_time': datetime.datetime(2019, 3, 2, 15, 40, 46), 'max_press': '101.32', 'min_press': '101.32', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 6, 13, 9, 3, 23), 'min_press_time': datetime.datetime(2019, 3, 2, 15, 40, 46), 'price': '1.73', 'use_volume_work': '0.0', 'use_volume_std': '1000.0', 'use_money': '1580.0', 'sum_total_volume': '1000', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1700.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,æœªå¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00050000000006å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000024
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 6
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000134'}]
0000000134
00056000000024 â˜† sum_total_money <0 ç½®ä¸º0
00056000000024
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000104')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000134', 'rtu_no': '00050000000019', 'flmeter_no': '00056000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 21, 651287), 'year': '2019', 'std_sum': '253487', 'work_sum': '253487', 'max_std_flow': '111.96', 'min_std_flow': '0.0', 'avg_std_flow': '4.0', 'max_std_flow_time': datetime.datetime(2019, 4, 6, 6, 23, 42), 'min_std_flow_time': datetime.datetime(2019, 1, 3, 14, 40, 1), 'max_work_flow': '131.77', 'min_work_flow': '0.0', 'avg_work_flow': '5.0', 'max_work_flow_time': datetime.datetime(2019, 4, 6, 6, 23, 42), 'min_work_flow_time': datetime.datetime(2019, 1, 3, 14, 40, 1), 'max_temperature': '24.56', 'min_temperature': '12.69', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 4, 6, 6, 23, 42), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 18, 51), 'max_press': '86.29', 'min_press': '86.29', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 14, 53), 'min_press_time': datetime.datetime(2019, 1, 3, 14, 40, 1), 'price': '1.63', 'use_volume_work': '79356.0', 'use_volume_std': '79356.0', 'use_money': '114820.48', 'sum_total_volume': '253487', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5361.48', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000024å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000022
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000135'}]
0000000135
00056000000022 â˜† sum_total_money <0 ç½®ä¸º0
00056000000022
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000073')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000135', 'rtu_no': '00050000000017', 'flmeter_no': '00056000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 21, 979410), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 51), 'min_std_flow_time': datetime.datetime(2019, 1, 3, 12, 48, 21), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 51), 'min_work_flow_time': datetime.datetime(2019, 1, 3, 12, 48, 21), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 16, 51), 'min_temp_time': datetime.datetime(2019, 1, 3, 12, 48, 21), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 16, 51), 'min_press_time': datetime.datetime(2019, 1, 3, 12, 48, 21), 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '2263.0', 'use_money': '3643.43', 'sum_total_volume': '7319', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '331.22', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000022å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000049
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000136'}]
0000000136
00056000000049 â˜† sum_total_money <0 ç½®ä¸º0
00056000000049
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000070')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000136', 'rtu_no': '00050000000038', 'flmeter_no': '00056000000049', 'customer_no': '00050000000035', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 22, 329469), 'year': '2019', 'std_sum': '365667', 'work_sum': '381697', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 2, 16, 39, 32), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 3, 13, 22), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 2, 16, 39, 32), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 3, 13, 22), 'max_temperature': '22.32', 'min_temperature': '13.41', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 7, 31, 0, 17, 26), 'min_temp_time': datetime.datetime(2019, 5, 1, 8, 52, 28), 'max_press': '99.57', 'min_press': '96.68', 'avg_press': '97.0', 'max_press_time': datetime.datetime(2019, 5, 30, 21, 17, 22), 'min_press_time': datetime.datetime(2019, 7, 1, 0, 9, 23), 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '365667', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2903.68', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '97.0', 'press_out': '97.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000049å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000020
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 7
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000137'}]
0000000137
00056000000020 â˜† sum_total_money <0 ç½®ä¸º0
00056000000020
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000065')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000137', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000020', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 22, 664573), 'year': '2019', 'std_sum': '29945', 'work_sum': '32220', 'max_std_flow': '1.18', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 6, 12, 5, 49, 44), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 0, 34, 25), 'max_work_flow': '1.28', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 6, 12, 5, 49, 44), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 0, 34, 25), 'max_temperature': '35.41', 'min_temperature': '0.0', 'avg_temperature': '30.0', 'max_temp_time': datetime.datetime(2019, 4, 9, 20, 31, 6), 'min_temp_time': datetime.datetime(2019, 1, 4, 0, 34, 25), 'max_press': '101.89', 'min_press': '0.0', 'avg_press': '98.0', 'max_press_time': datetime.datetime(2019, 3, 28, 14, 32, 10), 'min_press_time': datetime.datetime(2019, 1, 4, 0, 34, 25), 'price': '1.58', 'use_volume_work': '32220.0', 'use_volume_std': '16.0', 'use_money': '25.33', 'sum_total_volume': '29945', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '8984.64', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '30.0', 'temp_out': '30.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000020å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000036
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000138'}]
0000000138
00056000000036 â˜† sum_total_money <0 ç½®ä¸º0
00056000000036
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000086')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000138', 'rtu_no': '00050000000030', 'flmeter_no': '00056000000036', 'customer_no': '00050000000027', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 23, 12643), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 14, 56), 'min_std_flow_time': datetime.datetime(2019, 4, 28, 19, 1, 3), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 14, 56), 'min_work_flow_time': datetime.datetime(2019, 4, 28, 19, 1, 3), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 14, 56), 'min_temp_time': datetime.datetime(2019, 4, 28, 19, 1, 3), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 14, 56), 'min_press_time': datetime.datetime(2019, 4, 28, 19, 1, 3), 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '101418', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '656.32', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000036å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000059
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000139'}]
0000000139
00056000000059 â˜† sum_total_money <0 ç½®ä¸º0
00056000000059
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000100')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000139', 'rtu_no': '00050000000043', 'flmeter_no': '00056000000059', 'customer_no': '00050000000040', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 23, 394621), 'year': '2019', 'std_sum': '707711', 'work_sum': '705652', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 3), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 3, 9, 16), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 3), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 3, 9, 16), 'max_temperature': '15.55', 'min_temperature': '13.02', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 4, 29, 10, 14, 16), 'min_temp_time': datetime.datetime(2019, 4, 29, 3, 9, 16), 'max_press': '78.89', 'min_press': '78.83', 'avg_press': '85.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 16, 3), 'min_press_time': datetime.datetime(2019, 5, 1, 17, 16, 14), 'price': '1.77', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '707711', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '13699.12', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '85.0', 'press_out': '85.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000059å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000033
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000140'}]
0000000140
00056000000033 â˜† sum_total_money <0 ç½®ä¸º0
00056000000033
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000064')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000140', 'rtu_no': '00050000000028', 'flmeter_no': '00056000000033', 'customer_no': '00050000000025', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 23, 758648), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 17, 46), 'min_std_flow_time': datetime.datetime(2019, 4, 28, 20, 53, 29), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 17, 46), 'min_work_flow_time': datetime.datetime(2019, 4, 28, 20, 53, 29), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 17, 46), 'min_temp_time': datetime.datetime(2019, 4, 28, 20, 53, 29), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 17, 46), 'min_press_time': datetime.datetime(2019, 4, 28, 20, 53, 29), 'price': '1.71', 'use_volume_work': '0.0', 'use_volume_std': '458.0', 'use_money': '783.18', 'sum_total_volume': '1847', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1406.63', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000033å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000065
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000141'}]
0000000141
00056000000065 â˜† sum_total_money <0 ç½®ä¸º0
00056000000065
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000103')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000141', 'rtu_no': '00050000000045', 'flmeter_no': '00056000000065', 'customer_no': '00050000000042', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 24, 73807), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 47), 'min_std_flow_time': datetime.datetime(2019, 5, 1, 0, 8, 54), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 47), 'min_work_flow_time': datetime.datetime(2019, 5, 1, 0, 8, 54), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 16, 47), 'min_temp_time': datetime.datetime(2019, 5, 1, 0, 8, 54), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 16, 47), 'min_press_time': datetime.datetime(2019, 5, 1, 0, 8, 54), 'price': '2.27', 'use_volume_work': '0.0', 'use_volume_std': '884.0', 'use_money': '2006.68', 'sum_total_volume': '5371', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '376.39', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000065å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000037
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000142'}]
0000000142
00056000000037 â˜† sum_total_money <0 ç½®ä¸º0
00056000000037
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000078')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000142', 'rtu_no': '00050000000031', 'flmeter_no': '00056000000037', 'customer_no': '00050000000028', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 24, 417886), 'year': '2019', 'std_sum': '492360', 'work_sum': '539756', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 13, 51), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 3, 11, 40), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 13, 51), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 3, 11, 40), 'max_temperature': '22.89', 'min_temperature': '14.43', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 7, 31, 0, 17, 42), 'min_temp_time': datetime.datetime(2019, 5, 1, 17, 36, 42), 'max_press': '95.08', 'min_press': '137.28', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 7, 31, 0, 17, 42), 'min_press_time': datetime.datetime(2019, 4, 29, 3, 11, 40), 'price': '1.6', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '492360', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '3983.48', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000037å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000056
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000143'}]
0000000143
00056000000056 â˜† sum_total_money <0 ç½®ä¸º0
00056000000056
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000098')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000143', 'rtu_no': '00050000000042', 'flmeter_no': '00056000000056', 'customer_no': '00050000000039', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 24, 774930), 'year': '2019', 'std_sum': '3', 'work_sum': '0', 'max_std_flow': '35.91', 'min_std_flow': '35.91', 'avg_std_flow': '35.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 14, 50), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 3, 11), 'max_work_flow': '35.91', 'min_work_flow': '35.91', 'avg_work_flow': '35.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 14, 50), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 3, 11), 'max_temperature': '35.91', 'min_temperature': '35.91', 'avg_temperature': '35.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 14, 50), 'min_temp_time': datetime.datetime(2019, 4, 29, 3, 11), 'max_press': '101.32', 'min_press': '101.32', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 14, 50), 'min_press_time': datetime.datetime(2019, 4, 29, 3, 11), 'price': '1.59', 'use_volume_work': '0.0', 'use_volume_std': '102.0', 'use_money': '162.18', 'sum_total_volume': '46520', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '34577.1', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '35.0', 'temp_out': '35.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000056å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000052
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000144'}]
0000000144
00056000000052 â˜† sum_total_money <0 ç½®ä¸º0
00056000000052
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000102')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000144', 'rtu_no': '00050000000039', 'flmeter_no': '00056000000052', 'customer_no': '00050000000036', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 25, 178850), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 17, 8), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 3, 13, 1), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 17, 8), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 3, 13, 1), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 17, 8), 'min_temp_time': datetime.datetime(2019, 4, 29, 3, 13, 1), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 17, 8), 'min_press_time': datetime.datetime(2019, 4, 29, 3, 13, 1), 'price': '2.27', 'use_volume_work': '0.0', 'use_volume_std': '21119.0', 'use_money': '47942.57', 'sum_total_volume': '85926', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '3199.75', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000052å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000027
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000145'}]
0000000145
00056000000027 â˜† sum_total_money <0 ç½®ä¸º0
00056000000027
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000115')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000145', 'rtu_no': '00050000000022', 'flmeter_no': '00056000000027', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 25, 586761), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 22, 43, 5), 'min_std_flow_time': datetime.datetime(2019, 1, 3, 13, 34), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 22, 43, 5), 'min_work_flow_time': datetime.datetime(2019, 1, 3, 13, 34), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 8, 11, 22, 43, 5), 'min_temp_time': datetime.datetime(2019, 1, 3, 13, 34), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 8, 11, 22, 43, 5), 'min_press_time': datetime.datetime(2019, 1, 3, 13, 34), 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '17512.0', 'use_money': '39927.36', 'sum_total_volume': '96583', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '29.54', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000027å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000055
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000146'}]
0000000146
00056000000055 â˜† sum_total_money <0 ç½®ä¸º0
00056000000055
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000068')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000146', 'rtu_no': '00050000000041', 'flmeter_no': '00056000000055', 'customer_no': '00050000000038', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 26, 11625), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '35.91', 'min_std_flow': '0.0', 'avg_std_flow': '25.0', 'max_std_flow_time': datetime.datetime(2019, 7, 17, 16, 38, 9), 'min_std_flow_time': datetime.datetime(2019, 7, 17, 16, 43, 8), 'max_work_flow': '35.91', 'min_work_flow': '0.0', 'avg_work_flow': '25.0', 'max_work_flow_time': datetime.datetime(2019, 7, 17, 16, 38, 9), 'min_work_flow_time': datetime.datetime(2019, 7, 17, 16, 43, 8), 'max_temperature': '35.91', 'min_temperature': '35.91', 'avg_temperature': '35.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 14), 'min_temp_time': datetime.datetime(2019, 4, 28, 19, 8, 46), 'max_press': '101.32', 'min_press': '101.32', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 14), 'min_press_time': datetime.datetime(2019, 4, 28, 19, 8, 46), 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '1.0', 'use_money': '1.61', 'sum_total_volume': '8', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '988.38', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '35.0', 'temp_out': '35.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000055å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000051
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000147'}]
0000000147
00056000000051 â˜† sum_total_money <0 ç½®ä¸º0
00056000000051
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000117')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000147', 'rtu_no': '00050000000038', 'flmeter_no': '00056000000051', 'customer_no': '00050000000035', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 26, 335785), 'year': '2019', 'std_sum': '35', 'work_sum': '46', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 2, 16, 39, 34), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 3, 13, 24), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 2, 16, 39, 34), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 3, 13, 24), 'max_temperature': '22.32', 'min_temperature': '12.99', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 7, 31, 0, 17, 28), 'min_temp_time': datetime.datetime(2019, 5, 1, 6, 7, 29), 'max_press': '77.29', 'min_press': '76.45', 'avg_press': '76.0', 'max_press_time': datetime.datetime(2019, 6, 30, 0, 16, 23), 'min_press_time': datetime.datetime(2019, 5, 1, 6, 7, 29), 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '35', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '20791.68', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '76.0', 'press_out': '76.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000051å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000042
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000148'}]
0000000148
00056000000042 â˜† sum_total_money <0 ç½®ä¸º0
00056000000042
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000099')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000148', 'rtu_no': '00050000000034', 'flmeter_no': '00056000000042', 'customer_no': '00050000000031', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 26, 666872), 'year': '2019', 'std_sum': '110456', 'work_sum': '110456', 'max_std_flow': '1.38', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 23, 0, 47, 59), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 3, 13, 36), 'max_work_flow': '1.63', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 23, 0, 47, 59), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 3, 13, 36), 'max_temperature': '24.91', 'min_temperature': '13.57', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 7, 23, 0, 47, 59), 'min_temp_time': datetime.datetime(2019, 5, 1, 2, 59, 36), 'max_press': '86.29', 'min_press': '86.29', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2019, 8, 5, 16, 41, 54), 'min_press_time': datetime.datetime(2019, 4, 29, 3, 13, 36), 'price': '1.61', 'use_volume_work': '21.0', 'use_volume_std': '21.0', 'use_money': '33.81', 'sum_total_volume': '110456', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '27095.9', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000042å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000029
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000149'}]
0000000149
00056000000029 â˜† sum_total_money <0 ç½®ä¸º0
00056000000029
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000108')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000149', 'rtu_no': '00050000000024', 'flmeter_no': '00056000000029', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 26, 996989), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 37), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 5, 57, 33), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 37), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 5, 57, 33), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 16, 37), 'min_temp_time': datetime.datetime(2019, 1, 4, 5, 57, 33), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 16, 37), 'min_press_time': datetime.datetime(2019, 1, 4, 5, 57, 33), 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '9489.0', 'use_money': '15277.29', 'sum_total_volume': '32980', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2171.97', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000029å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000057
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000150'}]
0000000150
00056000000057 â˜† sum_total_money <0 ç½®ä¸º0
00056000000057
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000092')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000150', 'rtu_no': '00050000000042', 'flmeter_no': '00056000000057', 'customer_no': '00050000000039', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 27, 417947), 'year': '2019', 'std_sum': '3', 'work_sum': '0', 'max_std_flow': '35.91', 'min_std_flow': '35.91', 'avg_std_flow': '35.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 14, 51), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 3, 11, 1), 'max_work_flow': '35.91', 'min_work_flow': '35.91', 'avg_work_flow': '35.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 14, 51), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 3, 11, 1), 'max_temperature': '35.91', 'min_temperature': '35.91', 'avg_temperature': '35.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 14, 51), 'min_temp_time': datetime.datetime(2019, 4, 29, 3, 11, 1), 'max_press': '101.32', 'min_press': '101.32', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 14, 51), 'min_press_time': datetime.datetime(2019, 4, 29, 3, 11, 1), 'price': '1.59', 'use_volume_work': '0.0', 'use_volume_std': '3.0', 'use_money': '4.77', 'sum_total_volume': '46412', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '34245.12', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '35.0', 'temp_out': '35.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000057å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000038
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000151'}]
0000000151
00056000000038 â˜† sum_total_money <0 ç½®ä¸º0
00056000000038
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000081')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000151', 'rtu_no': '00050000000032', 'flmeter_no': '00056000000038', 'customer_no': '00050000000029', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 27, 893592), 'year': '2019', 'std_sum': '138841', 'work_sum': '138841', 'max_std_flow': '1.07', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 28, 20, 10, 51), 'min_std_flow_time': datetime.datetime(2019, 4, 28, 22, 50, 52), 'max_work_flow': '1.26', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 28, 20, 10, 51), 'min_work_flow_time': datetime.datetime(2019, 4, 28, 22, 50, 52), 'max_temperature': '26.56', 'min_temperature': '13.2', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 7, 31, 0, 14, 49), 'min_temp_time': datetime.datetime(2019, 5, 1, 17, 16, 39), 'max_press': '86.29', 'min_press': '86.29', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 14, 54), 'min_press_time': datetime.datetime(2019, 4, 28, 22, 50, 52), 'price': '1.59', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '138841', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '33868.31', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000038å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000066
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000152'}]
0000000152
00056000000066 â˜† sum_total_money <0 ç½®ä¸º0
00056000000066
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000093')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000152', 'rtu_no': '00050000000046', 'flmeter_no': '00056000000066', 'customer_no': '00050000000043', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 28, 390263), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 17), 'min_std_flow_time': datetime.datetime(2019, 5, 1, 17, 16, 23), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 17), 'min_work_flow_time': datetime.datetime(2019, 5, 1, 17, 16, 23), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 16, 17), 'min_temp_time': datetime.datetime(2019, 5, 1, 17, 16, 23), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 16, 17), 'min_press_time': datetime.datetime(2019, 5, 1, 17, 16, 23), 'price': '2.27', 'use_volume_work': '0.0', 'use_volume_std': '7980.0', 'use_money': '18138.02', 'sum_total_volume': '21706', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5234.57', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000066å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000045
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000153'}]
0000000153
00056000000045 â˜† sum_total_money <0 ç½®ä¸º0
00056000000045
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000069')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000153', 'rtu_no': '00050000000036', 'flmeter_no': '00056000000045', 'customer_no': '00050000000033', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 28, 750301), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 14, 29), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 23, 0, 41), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 14, 29), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 23, 0, 41), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 14, 29), 'min_temp_time': datetime.datetime(2019, 4, 29, 23, 0, 41), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 14, 29), 'min_press_time': datetime.datetime(2019, 4, 29, 23, 0, 41), 'price': '2.27', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '15495', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '15169.24', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000045å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000061
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000154'}]
0000000154
00056000000061 â˜† sum_total_money <0 ç½®ä¸º0
00056000000061
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000091')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000154', 'rtu_no': '00050000000043', 'flmeter_no': '00056000000061', 'customer_no': '00050000000040', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 29, 185138), 'year': '2019', 'std_sum': '694704', 'work_sum': '693544', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 5), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 2, 29, 19), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 5), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 2, 29, 19), 'max_temperature': '15.7', 'min_temperature': '13.14', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 4, 29, 10, 14, 18), 'min_temp_time': datetime.datetime(2019, 4, 29, 2, 29, 19), 'max_press': '80.09', 'min_press': '80.09', 'avg_press': '87.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 16, 5), 'min_press_time': datetime.datetime(2019, 5, 1, 17, 36, 15), 'price': '1.77', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '694704', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '11860.93', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '87.0', 'press_out': '87.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000061å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000060
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000155'}]
0000000155
00056000000060 â˜† sum_total_money <0 ç½®ä¸º0
00056000000060
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000114')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000155', 'rtu_no': '00050000000043', 'flmeter_no': '00056000000060', 'customer_no': '00050000000040', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 29, 517250), 'year': '2019', 'std_sum': '18', 'work_sum': '23', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 4), 'min_std_flow_time': datetime.datetime(2019, 4, 28, 19, 9, 17), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 4), 'min_work_flow_time': datetime.datetime(2019, 4, 28, 19, 9, 17), 'max_temperature': '14.98', 'min_temperature': '12.82', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 4, 29, 10, 9, 17), 'min_temp_time': datetime.datetime(2019, 4, 28, 19, 9, 17), 'max_press': '79.43', 'min_press': '77.83', 'avg_press': '78.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 16, 4), 'min_press_time': datetime.datetime(2019, 5, 1, 17, 16, 16), 'price': '1.77', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '23', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '4574.21', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '78.0', 'press_out': '78.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000060å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000069
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000156'}]
0000000156
00056000000069 â˜† sum_total_money <0 ç½®ä¸º0
00056000000069
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000061')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000156', 'rtu_no': '00050000000048', 'flmeter_no': '00056000000069', 'customer_no': '00050000000046', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 29, 841383), 'year': '2019', 'std_sum': '118995', 'work_sum': '118995', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 2, 11, 56, 49), 'min_std_flow_time': datetime.datetime(2019, 7, 26, 15, 30, 52), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 2, 11, 56, 49), 'min_work_flow_time': datetime.datetime(2019, 7, 26, 15, 30, 52), 'max_temperature': '23.54', 'min_temperature': '17.64', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 7, 31, 0, 16, 49), 'min_temp_time': datetime.datetime(2019, 8, 1, 0, 1, 49), 'max_press': '86.29', 'min_press': '86.29', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2019, 8, 2, 11, 56, 49), 'min_press_time': datetime.datetime(2019, 7, 26, 15, 30, 52), 'price': '1.63', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '118995', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '16331.9', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000069å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000063
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000157'}]
0000000157
00056000000063 â˜† sum_total_money <0 ç½®ä¸º0
00056000000063
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000072')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000157', 'rtu_no': '00050000000044', 'flmeter_no': '00056000000063', 'customer_no': '00050000000041', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 30, 244306), 'year': '2019', 'std_sum': '351973', 'work_sum': '204521', 'max_std_flow': '1.36', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 2, 20, 23, 3), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 22, 59, 5), 'max_work_flow': '1.75', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 2, 20, 23, 3), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 22, 59, 5), 'max_temperature': '20.54', 'min_temperature': '14.67', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 5, 2, 20, 23, 3), 'min_temp_time': datetime.datetime(2019, 5, 1, 15, 26, 3), 'max_press': '81.03', 'min_press': '77.83', 'avg_press': '80.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 15, 56), 'min_press_time': datetime.datetime(2019, 5, 1, 15, 26, 3), 'price': '1.61', 'use_volume_work': '13.0', 'use_volume_std': '13.0', 'use_money': '20.93', 'sum_total_volume': '204521', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '15137.15', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '80.0', 'press_out': '80.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000063å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000047
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000158'}]
0000000158
00056000000047 â˜† sum_total_money <0 ç½®ä¸º0
00056000000047
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000109')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000158', 'rtu_no': '00050000000037', 'flmeter_no': '00056000000047', 'customer_no': '00050000000034', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 30, 594374), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 2, 16, 29, 54), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 22, 56, 8), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 2, 16, 29, 54), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 22, 56, 8), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 8, 2, 16, 29, 54), 'min_temp_time': datetime.datetime(2019, 4, 29, 22, 56, 8), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 8, 2, 16, 29, 54), 'min_press_time': datetime.datetime(2019, 4, 29, 22, 56, 8), 'price': '1.6', 'use_volume_work': '0.0', 'use_volume_std': '150.0', 'use_money': '240.14', 'sum_total_volume': '5116', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '288.26', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000047å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000067
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000159'}]
0000000159
00056000000067 â˜† sum_total_money <0 ç½®ä¸º0
00056000000067
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000090')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000159', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000067', 'customer_no': '00050000000011', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 30, 936455), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 13, 51), 'min_std_flow_time': datetime.datetime(2019, 5, 27, 23, 36, 10), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 13, 51), 'min_work_flow_time': datetime.datetime(2019, 5, 27, 23, 36, 10), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 13, 51), 'min_temp_time': datetime.datetime(2019, 5, 27, 23, 36, 10), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 13, 51), 'min_press_time': datetime.datetime(2019, 5, 27, 23, 36, 10), 'price': '1.58', 'use_volume_work': '0.0', 'use_volume_std': '1346.0', 'use_money': '2126.68', 'sum_total_volume': '1346', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5773.32', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000067å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000039
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000160'}]
0000000160
00056000000039 â˜† sum_total_money <0 ç½®ä¸º0
00056000000039
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000075')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000160', 'rtu_no': '00050000000033', 'flmeter_no': '00056000000039', 'customer_no': '00050000000030', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 31, 246625), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 2, 16, 59, 29), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 20, 19, 44), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 2, 16, 59, 29), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 20, 19, 44), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 8, 2, 16, 59, 29), 'min_temp_time': datetime.datetime(2019, 4, 29, 20, 19, 44), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 8, 2, 16, 59, 29), 'min_press_time': datetime.datetime(2019, 4, 29, 20, 19, 44), 'price': '2.27', 'use_volume_work': '0.0', 'use_volume_std': '1.0', 'use_money': '2.27', 'sum_total_volume': '2912', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2706.36', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000039å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00050000000008
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000161'}]
0000000161
00050000000008 â˜† sum_total_money <0 ç½®ä¸º0
00050000000008
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000094')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000161', 'rtu_no': '00050000000002', 'flmeter_no': '00050000000008', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 31, 622620), 'year': '2019', 'std_sum': '23', 'work_sum': '29', 'max_std_flow': '0.0', 'min_std_flow': '-2107801.5', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 6, 13, 9, 3, 25), 'min_std_flow_time': datetime.datetime(2019, 3, 13, 19, 29, 40), 'max_work_flow': '20.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 49, 42), 'min_work_flow_time': datetime.datetime(2019, 3, 13, 19, 29, 40), 'max_temperature': '20.0', 'min_temperature': '-2.03', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 6, 13, 9, 3, 25), 'min_temp_time': datetime.datetime(2019, 3, 13, 19, 29, 40), 'max_press': '565.96', 'min_press': '0.0', 'avg_press': '104.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 49, 42), 'min_press_time': datetime.datetime(2019, 3, 13, 19, 29, 40), 'price': '1.71', 'use_volume_work': '29.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '23', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '500.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,æœªå¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '104.0', 'press_out': '104.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00050000000008å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000010
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000162'}]
0000000162
00056000000010 â˜† sum_total_money <0 ç½®ä¸º0
00056000000010
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000062')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000162', 'rtu_no': '00050000000004', 'flmeter_no': '00056000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 31, 986646), 'year': '2019', 'std_sum': '637035', 'work_sum': '637035', 'max_std_flow': '2.2', 'min_std_flow': '-193.0', 'avg_std_flow': '3.0', 'max_std_flow_time': datetime.datetime(2019, 7, 24, 16, 49, 21), 'min_std_flow_time': datetime.datetime(2019, 3, 15, 17, 22, 34), 'max_work_flow': '206.78', 'min_work_flow': '0.0', 'avg_work_flow': '4.0', 'max_work_flow_time': datetime.datetime(2019, 4, 1, 8, 19, 35), 'min_work_flow_time': datetime.datetime(2019, 1, 3, 14, 2, 1), 'max_temperature': '84.47', 'min_temperature': '0.0', 'avg_temperature': '539755460280389.0', 'max_temp_time': datetime.datetime(2019, 3, 19, 8, 29, 14), 'min_temp_time': datetime.datetime(2019, 3, 15, 17, 22, 34), 'max_press': '84.0', 'min_press': '0.0', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 8, 2, 16, 41, 15), 'min_press_time': datetime.datetime(2019, 1, 3, 14, 2, 1), 'price': '1.67', 'use_volume_work': '111693.0', 'use_volume_std': '111693.0', 'use_money': '170813.32', 'sum_total_volume': '637035', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '610.18', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '539755460280389.0', 'temp_out': '539755460280389.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000010å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000035
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000163'}]
0000000163
00056000000035 â˜† sum_total_money <0 ç½®ä¸º0
00056000000035
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000111')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000163', 'rtu_no': '00050000000029', 'flmeter_no': '00056000000035', 'customer_no': '00050000000026', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 32, 307787), 'year': '2019', 'std_sum': '9020', 'work_sum': '9020', 'max_std_flow': '1.4', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 2, 7, 43, 30), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 23, 0, 11), 'max_work_flow': '1.66', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 2, 7, 43, 30), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 23, 0, 11), 'max_temperature': '24.59', 'min_temperature': '13.15', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 7, 29, 1, 52, 31), 'min_temp_time': datetime.datetime(2019, 5, 1, 18, 45, 12), 'max_press': '86.29', 'min_press': '86.29', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2019, 8, 2, 7, 43, 30), 'min_press_time': datetime.datetime(2019, 4, 29, 23, 0, 11), 'price': '1.71', 'use_volume_work': '22.0', 'use_volume_std': '22.0', 'use_money': '37.62', 'sum_total_volume': '9020', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '20400.3', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000035å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000030
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 6
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000164'}]
0000000164
00056000000030
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000095')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000164', 'rtu_no': '00050000000025', 'flmeter_no': '00056000000030', 'customer_no': '00050000000022', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 32, 633915), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '1.99', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 28, 12, 16, 21), 'min_std_flow_time': datetime.datetime(2019, 3, 27, 13, 10, 48), 'max_work_flow': '0.01', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 28, 15, 47, 37), 'min_work_flow_time': datetime.datetime(2019, 3, 27, 13, 10, 48), 'max_temperature': '28.7', 'min_temperature': '0.0', 'avg_temperature': '23.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 1, 20, 20), 'min_temp_time': datetime.datetime(2019, 6, 1, 1, 20, 47), 'max_press': '77.1', 'min_press': '0.0', 'avg_press': '90.0', 'max_press_time': datetime.datetime(2019, 4, 29, 1, 21), 'min_press_time': datetime.datetime(2019, 6, 1, 1, 20, 47), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000001', 'fm_state_msg': '[ä½™é¢ä¸è¶³]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '90.0', 'press_out': '90.0', 'temp_in': '23.0', 'temp_out': '23.0', 'rssi': '24.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000030å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000068
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000165'}]
0000000165
00056000000068 â˜† sum_total_money <0 ç½®ä¸º0
00056000000068
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000113')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000165', 'rtu_no': '00050000000047', 'flmeter_no': '00056000000068', 'customer_no': '00050000000045', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 33, 94684), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 17, 19), 'min_std_flow_time': datetime.datetime(2019, 7, 26, 15, 25, 36), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 17, 19), 'min_work_flow_time': datetime.datetime(2019, 7, 26, 15, 25, 36), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 17, 19), 'min_temp_time': datetime.datetime(2019, 7, 26, 15, 25, 36), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 17, 19), 'min_press_time': datetime.datetime(2019, 7, 26, 15, 25, 36), 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '1245.0', 'use_money': '2004.45', 'sum_total_volume': '25543', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2825.77', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000068å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000023
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000166'}]
0000000166
00056000000023 â˜† sum_total_money <0 ç½®ä¸º0
00056000000023
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000097')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000166', 'rtu_no': '00050000000018', 'flmeter_no': '00056000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 33, 419818), 'year': '2019', 'std_sum': '345996', 'work_sum': '177509', 'max_std_flow': '2.1', 'min_std_flow': '0.0', 'avg_std_flow': '1.0', 'max_std_flow_time': datetime.datetime(2019, 5, 10, 5, 29, 8), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 10, 35, 13), 'max_work_flow': '2.64', 'min_work_flow': '0.0', 'avg_work_flow': '1.0', 'max_work_flow_time': datetime.datetime(2019, 5, 10, 5, 29, 8), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 10, 35, 13), 'max_temperature': '24.11', 'min_temperature': '11.88', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 3, 12, 6, 17, 51), 'min_temp_time': datetime.datetime(2019, 5, 1, 17, 17, 7), 'max_press': '99.25', 'min_press': '77.71', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2019, 4, 4, 8, 10, 12), 'min_press_time': datetime.datetime(2019, 6, 1, 0, 4, 6), 'price': '1.62', 'use_volume_work': '177507.0', 'use_volume_std': '30654.0', 'use_money': '44402.37', 'sum_total_volume': '177509', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5739.38', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000023å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000044
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000167'}]
0000000167
00056000000044
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000110')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000167', 'rtu_no': '00050000000035', 'flmeter_no': '00056000000044', 'customer_no': '00050000000032', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 33, 721009), 'year': '2019', 'std_sum': '123624', 'work_sum': '123624', 'max_std_flow': '76.88', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 13, 7, 33, 23), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 22, 56, 23), 'max_work_flow': '89.53', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 13, 7, 33, 23), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 22, 56, 23), 'max_temperature': '22.83', 'min_temperature': '14.59', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 5, 13, 7, 33, 23), 'min_temp_time': datetime.datetime(2019, 5, 1, 17, 16, 18), 'max_press': '86.29', 'min_press': '86.29', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 13, 49), 'min_press_time': datetime.datetime(2019, 4, 29, 22, 56, 23), 'price': '1.58', 'use_volume_work': '1850.0', 'use_volume_std': '1850.0', 'use_money': '2923.0', 'sum_total_volume': '123624', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.0', 'remain_volume': '0.0', 'fm_state': '10000010', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å…³,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '1', 'valve_state_msg': 'é˜€å…³', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000044å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000064
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000168'}]
0000000168
00056000000064 â˜† sum_total_money <0 ç½®ä¸º0
00056000000064
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000071')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000168', 'rtu_no': '00050000000044', 'flmeter_no': '00056000000064', 'customer_no': '00050000000041', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 34, 57114), 'year': '2019', 'std_sum': '269905', 'work_sum': '204295', 'max_std_flow': '0.81', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 8, 19, 56, 59), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 21, 33, 5), 'max_work_flow': '1.02', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 8, 19, 56, 59), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 21, 33, 5), 'max_temperature': '21.0', 'min_temperature': '14.96', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 5, 8, 19, 56, 59), 'min_temp_time': datetime.datetime(2019, 5, 1, 17, 16, 4), 'max_press': '81.65', 'min_press': '78.45', 'avg_press': '79.0', 'max_press_time': datetime.datetime(2019, 5, 8, 19, 56, 59), 'min_press_time': datetime.datetime(2019, 5, 1, 17, 16, 4), 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '204295', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '14466.68', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '79.0', 'press_out': '79.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000064å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000046
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000169'}]
0000000169
00056000000046 â˜† sum_total_money <0 ç½®ä¸º0
00056000000046
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000077')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000169', 'rtu_no': '00050000000036', 'flmeter_no': '00056000000046', 'customer_no': '00050000000033', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 34, 447067), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 14, 30), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 17, 30, 42), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 14, 30), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 17, 30, 42), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 14, 30), 'min_temp_time': datetime.datetime(2019, 4, 29, 17, 30, 42), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 14, 30), 'min_press_time': datetime.datetime(2019, 4, 29, 17, 30, 42), 'price': '2.27', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '18546', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '7212.96', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000046å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000034
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000170'}]
0000000170
00056000000034 â˜† sum_total_money <0 ç½®ä¸º0
00056000000034
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000105')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000170', 'rtu_no': '00050000000029', 'flmeter_no': '00056000000034', 'customer_no': '00050000000026', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 34, 765217), 'year': '2019', 'std_sum': '92099', 'work_sum': '92099', 'max_std_flow': '35.4', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 7, 10, 21, 6), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 22, 55, 9), 'max_work_flow': '40.68', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 7, 10, 21, 6), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 22, 55, 9), 'max_temperature': '24.65', 'min_temperature': '12.76', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 7, 31, 0, 17, 30), 'min_temp_time': datetime.datetime(2019, 5, 1, 18, 45, 11), 'max_press': '86.29', 'min_press': '86.29', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2019, 8, 8, 1, 50, 26), 'min_press_time': datetime.datetime(2019, 4, 29, 22, 55, 9), 'price': '1.71', 'use_volume_work': '63.0', 'use_volume_std': '63.0', 'use_money': '107.73', 'sum_total_volume': '92099', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '23683.02', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000034å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000062
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000171'}]
0000000171
00056000000062 â˜† sum_total_money <0 ç½®ä¸º0
00056000000062
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000060')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000171', 'rtu_no': '00050000000043', 'flmeter_no': '00056000000062', 'customer_no': '00050000000040', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 35, 119333), 'year': '2019', 'std_sum': '598108', 'work_sum': '601342', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 6), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 3, 9, 19), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 6), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 3, 9, 19), 'max_temperature': '16.09', 'min_temperature': '13.64', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 4, 29, 10, 9, 20), 'min_temp_time': datetime.datetime(2019, 4, 29, 3, 9, 19), 'max_press': '99.99', 'min_press': '79.95', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2019, 4, 29, 10, 9, 20), 'min_press_time': datetime.datetime(2019, 5, 1, 17, 16, 18), 'price': '1.77', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '598108', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '12668.59', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000062å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000017
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000172'}]
0000000172
00056000000017 â˜† sum_total_money <0 ç½®ä¸º0
00056000000017
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000116')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000172', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000017', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 35, 448391), 'year': '2019', 'std_sum': '220905', 'work_sum': '223877', 'max_std_flow': '84.12', 'min_std_flow': '0.0', 'avg_std_flow': '1.0', 'max_std_flow_time': datetime.datetime(2019, 4, 10, 21, 50, 55), 'min_std_flow_time': datetime.datetime(2019, 1, 20, 2, 8, 30), 'max_work_flow': '2.02', 'min_work_flow': '0.0', 'avg_work_flow': '1.0', 'max_work_flow_time': datetime.datetime(2019, 8, 8, 15, 11, 52), 'min_work_flow_time': datetime.datetime(2019, 1, 20, 2, 8, 30), 'max_temperature': '25.25', 'min_temperature': '11.47', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 7, 26, 17, 21, 5), 'min_temp_time': datetime.datetime(2019, 4, 1, 1, 30, 5), 'max_press': '83.5', 'min_press': '83.5', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 8, 8, 15, 11, 52), 'min_press_time': datetime.datetime(2019, 1, 20, 2, 8, 30), 'price': '1.63', 'use_volume_work': '28999.0', 'use_volume_std': '28999.0', 'use_money': '45184.5', 'sum_total_volume': '223877', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '22350.39', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000017å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000028
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 6
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000173'}]
0000000173
00056000000028 â˜† sum_total_money <0 ç½®ä¸º0
00056000000028
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000083')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000173', 'rtu_no': '00050000000023', 'flmeter_no': '00056000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 35, 864278), 'year': '2019', 'std_sum': '144378', 'work_sum': '160518', 'max_std_flow': '312.19', 'min_std_flow': '0.0', 'avg_std_flow': '11.0', 'max_std_flow_time': datetime.datetime(2019, 4, 5, 7, 41, 13), 'min_std_flow_time': datetime.datetime(2019, 1, 3, 13, 1, 24), 'max_work_flow': '343.59', 'min_work_flow': '0.0', 'avg_work_flow': '12.0', 'max_work_flow_time': datetime.datetime(2019, 4, 5, 7, 41, 13), 'min_work_flow_time': datetime.datetime(2019, 1, 3, 13, 1, 24), 'max_temperature': '27.92', 'min_temperature': '11.37', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 24, 7, 55, 53), 'min_temp_time': datetime.datetime(2019, 2, 4, 12, 29, 14), 'max_press': '98.71', 'min_press': '75.48', 'avg_press': '88.0', 'max_press_time': datetime.datetime(2019, 4, 5, 7, 41, 13), 'min_press_time': datetime.datetime(2019, 4, 1, 1, 26, 13), 'price': '1.64', 'use_volume_work': '148533.0', 'use_volume_std': '134233.0', 'use_money': '205970.51', 'sum_total_volume': '144378', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '99543.77', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '88.0', 'press_out': '88.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000028å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000016
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000174'}]
0000000174
00056000000016 â˜† sum_total_money <0 ç½®ä¸º0
00056000000016
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000063')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000174', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000016', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 36, 184426), 'year': '2019', 'std_sum': '467048', 'work_sum': '268197', 'max_std_flow': '2.42', 'min_std_flow': '0.0', 'avg_std_flow': '1.0', 'max_std_flow_time': datetime.datetime(2019, 6, 18, 12, 41, 43), 'min_std_flow_time': datetime.datetime(2019, 1, 20, 1, 38, 24), 'max_work_flow': '2.94', 'min_work_flow': '0.0', 'avg_work_flow': '1.0', 'max_work_flow_time': datetime.datetime(2019, 6, 18, 12, 41, 43), 'min_work_flow_time': datetime.datetime(2019, 1, 20, 1, 38, 24), 'max_temperature': '24.86', 'min_temperature': '10.15', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 17, 4, 3), 'min_temp_time': datetime.datetime(2019, 4, 1, 1, 35, 3), 'max_press': '83.5', 'min_press': '83.5', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 8, 5, 19, 20, 54), 'min_press_time': datetime.datetime(2019, 1, 20, 1, 38, 24), 'price': '1.63', 'use_volume_work': '33299.0', 'use_volume_std': '33299.0', 'use_money': '51789.23', 'sum_total_volume': '268197', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '33396.46', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000016å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000014
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000175'}]
0000000175
00056000000014 â˜† sum_total_money <0 ç½®ä¸º0
00056000000014
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000082')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000175', 'rtu_no': '00050000000013', 'flmeter_no': '00056000000014', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 36, 510705), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 26), 'min_std_flow_time': datetime.datetime(2019, 1, 3, 14, 2, 16), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 16, 26), 'min_work_flow_time': datetime.datetime(2019, 1, 3, 14, 2, 16), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 16, 26), 'min_temp_time': datetime.datetime(2019, 1, 3, 14, 2, 16), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 16, 26), 'min_press_time': datetime.datetime(2019, 1, 3, 14, 2, 16), 'price': '2.27', 'use_volume_work': '0.0', 'use_volume_std': '2774.0', 'use_money': '6311.58', 'sum_total_volume': '6272', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '226.35', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000014å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000032
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000176'}]
0000000176
00056000000032 â˜† sum_total_money <0 ç½®ä¸º0
00056000000032
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000074')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000176', 'rtu_no': '00050000000027', 'flmeter_no': '00056000000032', 'customer_no': '00050000000024', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 36, 828699), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 12, 0, 14, 7), 'min_std_flow_time': datetime.datetime(2019, 4, 29, 3, 13, 47), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 12, 0, 14, 7), 'min_work_flow_time': datetime.datetime(2019, 4, 29, 3, 13, 47), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 14, 7), 'min_temp_time': datetime.datetime(2019, 4, 29, 3, 13, 47), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 8, 12, 0, 14, 7), 'min_press_time': datetime.datetime(2019, 4, 29, 3, 13, 47), 'price': '1.71', 'use_volume_work': '0.0', 'use_volume_std': '5.0', 'use_money': '8.55', 'sum_total_volume': '56', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '4179.24', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000032å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00056000000018
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000177'}]
0000000177
00056000000018 â˜† sum_total_money <0 ç½®ä¸º0
00056000000018
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0005', '00052019080000000085')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0005', 'sry_id': '00052019080000000177', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000018', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 37, 270519), 'year': '2019', 'std_sum': '157457', 'work_sum': '157457', 'max_std_flow': '92.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 15, 23, 17, 51), 'min_std_flow_time': datetime.datetime(2019, 1, 20, 1, 38, 26), 'max_work_flow': '111.82', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 15, 23, 17, 51), 'min_work_flow_time': datetime.datetime(2019, 1, 20, 1, 38, 26), 'max_temperature': '25.67', 'min_temperature': '11.77', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 7, 16, 22, 32, 15), 'min_temp_time': datetime.datetime(2019, 4, 1, 1, 30, 6), 'max_press': '83.5', 'min_press': '83.5', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 8, 4, 16, 41, 57), 'min_press_time': datetime.datetime(2019, 1, 20, 1, 38, 26), 'price': '1.63', 'use_volume_work': '22863.0', 'use_volume_std': '22863.0', 'use_money': '35587.6', 'sum_total_volume': '157457', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '22971.95', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00056000000018å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
0005 data_processing is ok
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0007
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0007 2019 å¼€å§‹è¿›è¡Œè®¡ç®—å¹´æŠ¥è¡¨æ•°æ®å¤„ç†
ä¸åŒçš„è¡¨è®¡å·å…±æœ‰ä¸ªæ•°: 1
æ ¹æ®è¡¨è®¡å·ï¼Œè¿›è¡Œæ•°æ®çš„å†æ¬¡ç­›é€‰ï¼Œå¤„ç†ï¼Œå†™å…¥æ•°æ®åº“
----------------------------------------------------------------------------------------
00076000000001
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0007', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0007', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000003'}]
0000000003
00076000000001
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0007', '00072019080000000002')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0007', 'sry_id': '00072019080000000003', 'rtu_no': '00070000000001', 'flmeter_no': '00076000000001', 'customer_no': '00070000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 37, 690396), 'year': '2019', 'std_sum': '781', 'work_sum': '777', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 8, 23, 32, 20), 'min_std_flow_time': datetime.datetime(2019, 1, 1, 5, 36, 48), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 8, 23, 32, 20), 'min_work_flow_time': datetime.datetime(2019, 1, 1, 5, 36, 48), 'max_temperature': '8.1', 'min_temperature': '0.3', 'avg_temperature': '5.0', 'max_temp_time': datetime.datetime(2019, 1, 31, 23, 32, 48), 'min_temp_time': datetime.datetime(2019, 1, 1, 5, 36, 48), 'max_press': '128.4', 'min_press': '98.3', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 1, 31, 23, 32, 48), 'min_press_time': datetime.datetime(2019, 2, 1, 23, 32, 1), 'price': '3.09', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 103.0, 'total_buy_volume': None, 'total_buy_money': '2192', 'remain_money': '2089', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': 'æ— æŠ¥è­¦[çŠ¶æ€å­—2å¤‡ç”¨å¾…å®š;]', 'rtu_state': '1', 'rtu_state_msg': 'æ— æŠ¥è­¦[çŠ¶æ€å­—2å¤‡ç”¨å¾…å®š;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '5.0', 'temp_out': '5.0', 'rssi': '11.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00076000000001å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
0007 data_processing is ok
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0009
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0009 2019 æœŸé—´æ— SCADA_REPORT_MONTHLYæ•°æ®ï¼Œè¯·ç­‰å¾…é‡æ–°è®¡ç®—å¹´æŠ¥è¡¨
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0011
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0011 2019 å¼€å§‹è¿›è¡Œè®¡ç®—å¹´æŠ¥è¡¨æ•°æ®å¤„ç†
ä¸åŒçš„è¡¨è®¡å·å…±æœ‰ä¸ªæ•°: 1
æ ¹æ®è¡¨è®¡å·ï¼Œè¿›è¡Œæ•°æ®çš„å†æ¬¡ç­›é€‰ï¼Œå¤„ç†ï¼Œå†™å…¥æ•°æ®åº“
----------------------------------------------------------------------------------------
00116000000071
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0011', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0011', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000003'}]
0000000003
00116000000071
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0011', '00112019080000000002')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0011', 'sry_id': '00112019080000000003', 'rtu_no': '00110000000071', 'flmeter_no': '00116000000071', 'customer_no': '00110000000072', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 38, 391521), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 4, 8, 7, 36), 'min_std_flow_time': datetime.datetime(2019, 8, 4, 7, 37, 30), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 4, 8, 7, 36), 'min_work_flow_time': datetime.datetime(2019, 8, 4, 7, 37, 30), 'max_temperature': '29.5', 'min_temperature': '29.3', 'avg_temperature': '29.0', 'max_temp_time': datetime.datetime(2019, 8, 4, 8, 7, 36), 'min_temp_time': datetime.datetime(2019, 8, 4, 7, 37, 30), 'max_press': '99.4', 'min_press': '99.4', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 8, 4, 8, 7, 36), 'min_press_time': datetime.datetime(2019, 8, 4, 7, 37, 30), 'price': '3.794', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '200', 'remain_money': '200.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '01', 'battery_voltage': '7.2', 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '29.0', 'temp_out': '29.0', 'rssi': '29.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00116000000071å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
0011 data_processing is ok
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0012
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 10
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0012 2019 å¼€å§‹è¿›è¡Œè®¡ç®—å¹´æŠ¥è¡¨æ•°æ®å¤„ç†
ä¸åŒçš„è¡¨è®¡å·å…±æœ‰ä¸ªæ•°: 4
æ ¹æ®è¡¨è®¡å·ï¼Œè¿›è¡Œæ•°æ®çš„å†æ¬¡ç­›é€‰ï¼Œå¤„ç†ï¼Œå†™å…¥æ•°æ®åº“
----------------------------------------------------------------------------------------
00126000000005
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0012', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0012', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000009'}]
0000000009
00126000000005
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0012', '00122019080000000007')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0012', 'sry_id': '00122019080000000009', 'rtu_no': '00120000000005', 'flmeter_no': '00126000000005', 'customer_no': '00120000000004', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 38, 808405), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '964.79', 'min_std_flow': '0.0', 'avg_std_flow': '82.0', 'max_std_flow_time': datetime.datetime(2019, 8, 9, 11, 24, 18), 'min_std_flow_time': datetime.datetime(2019, 8, 7, 20, 1, 11), 'max_work_flow': '1002.6', 'min_work_flow': '0.0', 'avg_work_flow': '85.0', 'max_work_flow_time': datetime.datetime(2019, 8, 9, 11, 24, 18), 'min_work_flow_time': datetime.datetime(2019, 8, 7, 20, 1, 11), 'max_temperature': '34.2', 'min_temperature': '20.0', 'avg_temperature': '25.0', 'max_temp_time': datetime.datetime(2019, 8, 9, 11, 24, 18), 'min_temp_time': datetime.datetime(2019, 8, 7, 20, 1, 11), 'max_press': '101.3', 'min_press': '95.4', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 8, 9, 11, 24, 18), 'min_press_time': datetime.datetime(2019, 8, 7, 20, 1, 11), 'price': '0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000010000100000000', 'fm_state_msg': '[å¸‚ç”µæ–­å¼€][é˜€é—¨æ§åˆ¶å™¨æ–­çº¿æŠ¥è­¦]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': None, 'valve_state_msg': 'é˜€é—¨çŠ¶æ€æœªçŸ¥', 'power_voltage': '00', 'battery_voltage': '7.33', 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '25.0', 'temp_out': '25.0', 'rssi': '20.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00126000000005å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00126000000002
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0012', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0012', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000010'}]
0000000010
00126000000002
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0012', '00122019080000000008')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0012', 'sry_id': '00122019080000000010', 'rtu_no': '00120000000002', 'flmeter_no': '00126000000002', 'customer_no': '00120000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 39, 162459), 'year': '2019', 'std_sum': '99', 'work_sum': '105', 'max_std_flow': '48.8', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 23, 20, 0, 3), 'min_std_flow_time': datetime.datetime(2019, 6, 28, 18, 1, 42), 'max_work_flow': '51.62', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 23, 20, 0, 3), 'min_work_flow_time': datetime.datetime(2019, 6, 28, 18, 1, 42), 'max_temperature': '35.2', 'min_temperature': '20.0', 'avg_temperature': '27.0', 'max_temp_time': datetime.datetime(2019, 7, 23, 20, 0, 3), 'min_temp_time': datetime.datetime(2019, 6, 28, 18, 1, 42), 'max_press': '101.3', 'min_press': '98.7', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 7, 23, 20, 0, 3), 'min_press_time': datetime.datetime(2019, 6, 28, 18, 1, 42), 'price': '0', 'use_volume_work': '102.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000010000100000000', 'fm_state_msg': '[å¸‚ç”µæ–­å¼€][é˜€é—¨æ§åˆ¶å™¨æ–­çº¿æŠ¥è­¦]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': None, 'valve_state_msg': 'é˜€é—¨çŠ¶æ€æœªçŸ¥', 'power_voltage': '00', 'battery_voltage': '7.31', 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '27.0', 'temp_out': '27.0', 'rssi': '16.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00126000000002å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00126000000004
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0012', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0012', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000011'}]
0000000011
00126000000004
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0012', '00122019080000000005')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0012', 'sry_id': '00122019080000000011', 'rtu_no': '00120000000004', 'flmeter_no': '00126000000004', 'customer_no': '00120000000003', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 39, 483601), 'year': '2019', 'std_sum': '13', 'work_sum': '14', 'max_std_flow': '388.44', 'min_std_flow': '0.0', 'avg_std_flow': '9.0', 'max_std_flow_time': datetime.datetime(2019, 8, 3, 11, 26, 13), 'min_std_flow_time': datetime.datetime(2019, 8, 3, 20, 1, 17), 'max_work_flow': '395.91', 'min_work_flow': '0.0', 'avg_work_flow': '9.0', 'max_work_flow_time': datetime.datetime(2019, 8, 3, 11, 26, 13), 'min_work_flow_time': datetime.datetime(2019, 8, 3, 20, 1, 17), 'max_temperature': '34.6', 'min_temperature': '20.6', 'avg_temperature': '30.0', 'max_temp_time': datetime.datetime(2019, 8, 3, 11, 26, 13), 'min_temp_time': datetime.datetime(2019, 8, 3, 20, 1, 17), 'max_press': '101.3', 'min_press': '99.1', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 8, 3, 11, 26, 13), 'min_press_time': datetime.datetime(2019, 8, 3, 20, 1, 17), 'price': '0', 'use_volume_work': '14.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000010000100000000', 'fm_state_msg': '[å¸‚ç”µæ–­å¼€][é˜€é—¨æ§åˆ¶å™¨æ–­çº¿æŠ¥è­¦]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': None, 'valve_state_msg': 'é˜€é—¨çŠ¶æ€æœªçŸ¥', 'power_voltage': '00', 'battery_voltage': '7.3', 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '30.0', 'temp_out': '30.0', 'rssi': '12.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00126000000004å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00126000000003
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0012', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0012', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000012'}]
0000000012
00126000000003
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0012', '00122019080000000006')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0012', 'sry_id': '00122019080000000012', 'rtu_no': '00120000000003', 'flmeter_no': '00126000000003', 'customer_no': '00120000000002', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 39, 851616), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.58', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 4, 11, 20, 56), 'min_std_flow_time': datetime.datetime(2019, 4, 4, 11, 2, 24), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 1, 20, 11), 'min_work_flow_time': datetime.datetime(2019, 4, 4, 11, 2, 24), 'max_temperature': '32.2', 'min_temperature': '0.0', 'avg_temperature': '24.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 1, 20, 58), 'min_temp_time': datetime.datetime(2019, 4, 4, 11, 2, 24), 'max_press': '99.7', 'min_press': '93.8', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 7, 30, 1, 20, 58), 'min_press_time': datetime.datetime(2019, 4, 4, 11, 2, 24), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '7', 'remain_money': '4.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '24.0', 'temp_out': '24.0', 'rssi': '24.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00126000000003å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
0012 data_processing is ok
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0016
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 11
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0016 2019 å¼€å§‹è¿›è¡Œè®¡ç®—å¹´æŠ¥è¡¨æ•°æ®å¤„ç†
ä¸åŒçš„è¡¨è®¡å·å…±æœ‰ä¸ªæ•°: 4
æ ¹æ®è¡¨è®¡å·ï¼Œè¿›è¡Œæ•°æ®çš„å†æ¬¡ç­›é€‰ï¼Œå¤„ç†ï¼Œå†™å…¥æ•°æ®åº“
----------------------------------------------------------------------------------------
00160000000001
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0016', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0016', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000009'}]
0000000009
00160000000001
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0016', '00162019080000000007')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0016', 'sry_id': '00162019080000000009', 'rtu_no': 'FM0000000690', 'flmeter_no': '00160000000001', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 40, 241574), 'year': '2019', 'std_sum': '69693241.950', 'work_sum': '16357169.940', 'max_std_flow': '5437.2', 'min_std_flow': '0.0', 'avg_std_flow': '1707.0', 'max_std_flow_time': datetime.datetime(2019, 4, 4, 8, 0, 44), 'min_std_flow_time': datetime.datetime(2019, 3, 29, 8, 0, 36), 'max_work_flow': '951.72', 'min_work_flow': '0.0', 'avg_work_flow': '381.0', 'max_work_flow_time': datetime.datetime(2019, 3, 21, 12, 0, 25), 'min_work_flow_time': datetime.datetime(2019, 3, 29, 8, 0, 36), 'max_temperature': '17.28', 'min_temperature': '-2.07', 'avg_temperature': '4.0', 'max_temp_time': datetime.datetime(2019, 4, 4, 8, 0, 44), 'min_temp_time': datetime.datetime(2019, 3, 29, 8, 0, 36), 'max_press': '462.21', 'min_press': '256.21', 'avg_press': '434.0', 'max_press_time': datetime.datetime(2019, 3, 21, 12, 0, 25), 'min_press_time': datetime.datetime(2019, 3, 29, 8, 0, 36), 'price': '0.000', 'use_volume_work': '173780.37', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '434.0', 'press_out': '434.0', 'temp_in': '4.0', 'temp_out': '4.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00160000000001å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00166000000004
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0016', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0016', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000010'}]
0000000010
00166000000004
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0016', '00162019080000000005')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0016', 'sry_id': '00162019080000000010', 'rtu_no': '00160000000005', 'flmeter_no': '00166000000004', 'customer_no': '00160000000003', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 40, 505923), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '1.28', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 22, 16, 46), 'min_std_flow_time': datetime.datetime(2019, 4, 22, 11, 27, 12), 'max_work_flow': '1.28', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 22, 16, 46), 'min_work_flow_time': datetime.datetime(2019, 4, 22, 11, 27, 12), 'max_temperature': '28.4', 'min_temperature': '18.2', 'avg_temperature': '24.0', 'max_temp_time': datetime.datetime(2019, 8, 11, 1, 22, 46), 'min_temp_time': datetime.datetime(2019, 4, 22, 11, 27, 12), 'max_press': '97.0', 'min_press': '94.6', 'avg_press': '96.0', 'max_press_time': datetime.datetime(2019, 5, 30, 1, 21, 12), 'min_press_time': datetime.datetime(2019, 7, 1, 0, 1, 32), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '96.0', 'press_out': '96.0', 'temp_in': '24.0', 'temp_out': '24.0', 'rssi': '19.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00166000000004å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00166000000001
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0016', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0016', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000011'}]
0000000011
00166000000001
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0016', '00162019080000000006')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0016', 'sry_id': '00162019080000000011', 'rtu_no': 'FM0000000690', 'flmeter_no': '00166000000001', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 40, 815040), 'year': '2019', 'std_sum': '70057630.950', 'work_sum': '16434656.170', 'max_std_flow': '5437.2', 'min_std_flow': '0.0', 'avg_std_flow': '1645.0', 'max_std_flow_time': datetime.datetime(2019, 4, 4, 8, 0, 44), 'min_std_flow_time': datetime.datetime(2019, 4, 3, 8, 0, 29), 'max_work_flow': '1720.19', 'min_work_flow': '0.0', 'avg_work_flow': '365.0', 'max_work_flow_time': datetime.datetime(2019, 4, 4, 8, 0, 44), 'min_work_flow_time': datetime.datetime(2019, 4, 3, 8, 0, 29), 'max_temperature': '20.0', 'min_temperature': '-2.23', 'avg_temperature': '5.0', 'max_temp_time': datetime.datetime(2019, 4, 4, 8, 0, 44), 'min_temp_time': datetime.datetime(2019, 4, 3, 8, 0, 29), 'max_press': '461.72', 'min_press': '101.33', 'avg_press': '436.0', 'max_press_time': datetime.datetime(2019, 4, 4, 8, 0, 44), 'min_press_time': datetime.datetime(2019, 4, 3, 8, 0, 29), 'price': '0.000', 'use_volume_work': '146576.29', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '436.0', 'press_out': '436.0', 'temp_in': '5.0', 'temp_out': '5.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00166000000001å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00166000000002
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0016', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0016', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000012'}]
0000000012
00166000000002
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0016', '00162019080000000008')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0016', 'sry_id': '00162019080000000012', 'rtu_no': '00160000000002', 'flmeter_no': '00166000000002', 'customer_no': '00160000000002', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 41, 109253), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '8.53', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 25, 15, 34, 25), 'min_std_flow_time': datetime.datetime(2019, 3, 20, 11, 14, 44), 'max_work_flow': '8.53', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 25, 15, 34, 25), 'min_work_flow_time': datetime.datetime(2019, 3, 20, 11, 14, 44), 'max_temperature': '26.5', 'min_temperature': '0.0', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 1, 52, 13), 'min_temp_time': datetime.datetime(2019, 4, 1, 1, 53, 14), 'max_press': '137.0', 'min_press': '0.0', 'avg_press': '73.0', 'max_press_time': datetime.datetime(2019, 5, 27, 1, 21, 9), 'min_press_time': datetime.datetime(2019, 4, 1, 1, 53, 14), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000001', 'fm_state_msg': '[ä½™é¢ä¸è¶³]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '73.0', 'press_out': '73.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '16.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00166000000002å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
0016 data_processing is ok
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0019
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0019 2019 å¼€å§‹è¿›è¡Œè®¡ç®—å¹´æŠ¥è¡¨æ•°æ®å¤„ç†
ä¸åŒçš„è¡¨è®¡å·å…±æœ‰ä¸ªæ•°: 2
æ ¹æ®è¡¨è®¡å·ï¼Œè¿›è¡Œæ•°æ®çš„å†æ¬¡ç­›é€‰ï¼Œå¤„ç†ï¼Œå†™å…¥æ•°æ®åº“
----------------------------------------------------------------------------------------
00196000000002
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0019', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0019', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000007'}]
0000000007
00196000000002
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0019', '00192019080000000006')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0019', 'sry_id': '00192019080000000007', 'rtu_no': 'FM0000000697', 'flmeter_no': '00196000000002', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 41, 472282), 'year': '2019', 'std_sum': '0.000', 'work_sum': '0.000', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 30, 0, 0, 31), 'min_std_flow_time': datetime.datetime(2019, 4, 1, 13, 40, 12), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 30, 0, 0, 31), 'min_work_flow_time': datetime.datetime(2019, 4, 1, 13, 40, 12), 'max_temperature': '23.29', 'min_temperature': '11.29', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 4, 30, 0, 0, 31), 'min_temp_time': datetime.datetime(2019, 4, 1, 13, 40, 12), 'max_press': '102.52', 'min_press': '99.17', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 4, 30, 0, 0, 31), 'min_press_time': datetime.datetime(2019, 4, 1, 13, 40, 12), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00196000000002å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00196000000001
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0019', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0019', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000008'}]
0000000008
00196000000001
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0019', '00192019080000000004')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0019', 'sry_id': '00192019080000000008', 'rtu_no': '00190000000001', 'flmeter_no': '00196000000001', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 41, 765503), 'year': '2019', 'std_sum': '52236', 'work_sum': '48238', 'max_std_flow': '61.61', 'min_std_flow': '0.0', 'avg_std_flow': '10.0', 'max_std_flow_time': datetime.datetime(2019, 3, 30, 9, 41, 24), 'min_std_flow_time': datetime.datetime(2019, 3, 30, 9, 35, 25), 'max_work_flow': '61.61', 'min_work_flow': '0.0', 'avg_work_flow': '10.0', 'max_work_flow_time': datetime.datetime(2019, 3, 30, 9, 41, 24), 'min_work_flow_time': datetime.datetime(2019, 3, 30, 9, 35, 25), 'max_temperature': '20.0', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 30, 9, 41, 24), 'min_temp_time': datetime.datetime(2019, 3, 30, 9, 35, 25), 'max_press': '101.32', 'min_press': '101.32', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 30, 9, 41, 24), 'min_press_time': datetime.datetime(2019, 3, 30, 9, 35, 25), 'price': '0.0', 'use_volume_work': '1.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.0', 'remain_volume': '0.0', 'fm_state': '00000000', 'fm_state_msg': 'æ— å¤–ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,å·²å¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00196000000001å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
0019 data_processing is ok
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0003
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 335
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0003 2019 å¼€å§‹è¿›è¡Œè®¡ç®—å¹´æŠ¥è¡¨æ•°æ®å¤„ç†
ä¸åŒçš„è¡¨è®¡å·å…±æœ‰ä¸ªæ•°: 75
æ ¹æ®è¡¨è®¡å·ï¼Œè¿›è¡Œæ•°æ®çš„å†æ¬¡ç­›é€‰ï¼Œå¤„ç†ï¼Œå†™å…¥æ•°æ®åº“
----------------------------------------------------------------------------------------
00036000000045
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000151'}]
0000000151
00036000000045
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000096')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000151', 'rtu_no': '00030000000086', 'flmeter_no': '00036000000045', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 42, 140497), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 16, 10, 15, 47), 'min_std_flow_time': datetime.datetime(2019, 1, 2, 10, 15, 52), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 16, 10, 15, 47), 'min_work_flow_time': datetime.datetime(2019, 1, 2, 10, 15, 52), 'max_temperature': '20.5', 'min_temperature': '18.6', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 1, 29, 10, 16, 7), 'min_temp_time': datetime.datetime(2019, 1, 2, 10, 15, 52), 'max_press': '102.2', 'min_press': '101.3', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 4, 16, 10, 15, 47), 'min_press_time': datetime.datetime(2019, 1, 2, 10, 15, 52), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '40', 'remain_money': '37', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '00', 'valve_state_msg': 'é˜€é—¨å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '14.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000045å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000014
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000152'}]
0000000152
00036000000014
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000131')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000152', 'rtu_no': '00030000000045', 'flmeter_no': '00036000000014', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 42, 374868), 'year': '2019', 'std_sum': '155', 'work_sum': '155', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 6, 11, 24, 2), 'min_std_flow_time': datetime.datetime(2019, 3, 6, 11, 22, 16), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 6, 11, 24, 2), 'min_work_flow_time': datetime.datetime(2019, 3, 6, 11, 22, 16), 'max_temperature': '23.2', 'min_temperature': '0.0', 'avg_temperature': '9.0', 'max_temp_time': datetime.datetime(2019, 3, 6, 11, 24, 2), 'min_temp_time': datetime.datetime(2019, 3, 6, 11, 22, 16), 'max_press': '101.3', 'min_press': '0.0', 'avg_press': '42.0', 'max_press_time': datetime.datetime(2019, 3, 6, 11, 24, 2), 'min_press_time': datetime.datetime(2019, 3, 6, 11, 22, 16), 'price': '665.6', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1280.0, 'total_buy_volume': None, 'total_buy_money': '1280', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': 'æ— æŠ¥è­¦[çŠ¶æ€å­—2å¤‡ç”¨å¾…å®š;]', 'rtu_state': '1', 'rtu_state_msg': 'æ— æŠ¥è­¦[çŠ¶æ€å­—2å¤‡ç”¨å¾…å®š;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '50', 'press_in': '42.0', 'press_out': '42.0', 'temp_in': '9.0', 'temp_out': '9.0', 'rssi': '14.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000014å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000007
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000153'}]
0000000153
00036000000007 â˜† sum_total_money <0 ç½®ä¸º0
00036000000007
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000076')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000153', 'rtu_no': '00030000000012', 'flmeter_no': '00036000000007', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 42, 648139), 'year': '2019', 'std_sum': '64', 'work_sum': '66', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 14, 13, 59, 37), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 3, 9, 17), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 14, 13, 59, 37), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 3, 9, 17), 'max_temperature': '26.96', 'min_temperature': '26.96', 'avg_temperature': '26.0', 'max_temp_time': datetime.datetime(2019, 3, 14, 13, 59, 37), 'min_temp_time': datetime.datetime(2019, 1, 4, 3, 9, 17), 'max_press': '100.15', 'min_press': '100.15', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 14, 13, 59, 37), 'min_press_time': datetime.datetime(2019, 1, 4, 3, 9, 17), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '52.0', 'use_money': '52.0', 'sum_total_volume': '60544', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '39520.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,æœªå¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '26.0', 'temp_out': '26.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000007å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000023
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000154'}]
0000000154
00036000000023
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000132')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000154', 'rtu_no': None, 'flmeter_no': '00036000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 42, 965291), 'year': '2019', 'std_sum': '46413.820', 'work_sum': '10513.890', 'max_std_flow': '812.18', 'min_std_flow': '0.0', 'avg_std_flow': '21.0', 'max_std_flow_time': datetime.datetime(2019, 4, 23, 22, 0, 21), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 10, 0, 26), 'max_work_flow': '45.11', 'min_work_flow': '0.0', 'avg_work_flow': '4.0', 'max_work_flow_time': datetime.datetime(2019, 5, 19, 8, 0, 22), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 10, 0, 26), 'max_temperature': '35.25', 'min_temperature': '-6.24', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 5, 19, 8, 0, 22), 'min_temp_time': datetime.datetime(2019, 1, 4, 10, 0, 26), 'max_press': '459.0', 'min_press': '100.27', 'avg_press': '205.0', 'max_press_time': datetime.datetime(2019, 5, 19, 8, 0, 22), 'min_press_time': datetime.datetime(2019, 4, 1, 0, 0, 23), 'price': '0.000', 'use_volume_work': '4001.19', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '205.0', 'press_out': '205.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000023å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000046
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000155'}]
0000000155
00036000000046
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000148')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000155', 'rtu_no': '00030000000088', 'flmeter_no': '00036000000046', 'customer_no': '00030000000040', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 43, 256512), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 13, 15, 43, 43), 'min_std_flow_time': datetime.datetime(2019, 1, 2, 0, 20, 46), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 13, 15, 43, 43), 'min_work_flow_time': datetime.datetime(2019, 1, 2, 0, 20, 46), 'max_temperature': '22.5', 'min_temperature': '0.0', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 1, 16, 0, 20, 53), 'min_temp_time': datetime.datetime(2019, 7, 3, 14, 13, 5), 'max_press': '103.6', 'min_press': '0.0', 'avg_press': '80.0', 'max_press_time': datetime.datetime(2019, 1, 16, 0, 20, 53), 'min_press_time': datetime.datetime(2019, 7, 3, 14, 13, 5), 'price': '429496.72', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 4294967295.0, 'total_buy_volume': None, 'total_buy_money': '4294967295', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000001000000000000000000', 'fm_state_msg': '[å‹åŠ›ä¼ æ„Ÿå™¨æ•…éšœ]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '1', 'valve_state_msg': 'é˜€å…³', 'power_voltage': '00', 'battery_voltage': '7.1', 'battery_level': '98', 'press_in': '80.0', 'press_out': '80.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '19.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000046å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000050
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000156'}]
0000000156
00036000000050
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000145')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000156', 'rtu_no': '00030000000092', 'flmeter_no': '00036000000050', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 43, 576655), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 6, 17, 12, 40, 23), 'min_std_flow_time': datetime.datetime(2019, 1, 2, 12, 13, 48), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 6, 17, 12, 40, 23), 'min_work_flow_time': datetime.datetime(2019, 1, 2, 12, 13, 48), 'max_temperature': '24.4', 'min_temperature': '0.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 1, 31, 23, 0, 27), 'min_temp_time': datetime.datetime(2019, 1, 2, 12, 13, 48), 'max_press': '103.4', 'min_press': '101.3', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 1, 31, 23, 0, 27), 'min_press_time': datetime.datetime(2019, 3, 1, 1, 1, 54), 'price': '2.32', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '64', 'remain_money': '63', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000100000000', 'fm_state_msg': '[å¸‚ç”µæ–­å¼€]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '80', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '17.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000050å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000027
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000157'}]
0000000157
00036000000027
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000150')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000157', 'rtu_no': '00030000000061', 'flmeter_no': '00036000000027', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 43, 989552), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 6, 1, 20, 35), 'min_std_flow_time': datetime.datetime(2019, 5, 5, 15, 59, 16), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 6, 1, 20, 35), 'min_work_flow_time': datetime.datetime(2019, 5, 5, 15, 59, 16), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 5, 6, 1, 20, 35), 'min_temp_time': datetime.datetime(2019, 5, 5, 15, 59, 16), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 5, 6, 1, 20, 35), 'min_press_time': datetime.datetime(2019, 5, 5, 15, 59, 16), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000001', 'fm_state_msg': '[ä½™é¢ä¸è¶³]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '18.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000027å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000024
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000158'}]
0000000158
00036000000024
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000130')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000158', 'rtu_no': None, 'flmeter_no': '00036000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 44, 290746), 'year': '2019', 'std_sum': '5216.420', 'work_sum': '3210.900', 'max_std_flow': '19.91', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 25, 8, 0, 23), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 10, 0, 25), 'max_work_flow': '32.28', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 2, 0, 23), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 10, 0, 25), 'max_temperature': '34.39', 'min_temperature': '-1.25', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 5, 25, 8, 0, 23), 'min_temp_time': datetime.datetime(2019, 2, 4, 12, 0, 27), 'max_press': '436.91', 'min_press': '100.14', 'avg_press': '120.0', 'max_press_time': datetime.datetime(2019, 3, 31, 2, 0, 23), 'min_press_time': datetime.datetime(2019, 4, 1, 0, 0, 24), 'price': '0.000', 'use_volume_work': '1239.96', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '120.0', 'press_out': '120.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000024å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000040
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000159'}]
0000000159
00036000000040
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000137')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000159', 'rtu_no': '00030000000081', 'flmeter_no': '00036000000040', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 44, 565012), 'year': '2019', 'std_sum': '3230', 'work_sum': '3423', 'max_std_flow': '965.35', 'min_std_flow': '0.0', 'avg_std_flow': '3.0', 'max_std_flow_time': datetime.datetime(2019, 7, 19, 18, 1, 20), 'min_std_flow_time': datetime.datetime(2019, 1, 9, 8, 48, 13), 'max_work_flow': '995.18', 'min_work_flow': '0.0', 'avg_work_flow': '3.0', 'max_work_flow_time': datetime.datetime(2019, 7, 19, 18, 1, 20), 'min_work_flow_time': datetime.datetime(2019, 1, 9, 8, 48, 13), 'max_temperature': '34.8', 'min_temperature': '-0.2', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 8, 2, 12, 55, 5), 'min_temp_time': datetime.datetime(2019, 1, 9, 8, 48, 13), 'max_press': '114.1', 'min_press': '0.0', 'avg_press': '85.0', 'max_press_time': datetime.datetime(2019, 5, 30, 16, 41, 5), 'min_press_time': datetime.datetime(2019, 1, 9, 8, 48, 13), 'price': '3.25', 'use_volume_work': '3931.0', 'use_volume_std': '3714.0', 'use_money': '12066.0', 'sum_total_volume': '3230', 'sum_total_money': 9511.0, 'total_buy_volume': None, 'total_buy_money': '10000', 'remain_money': '489.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '85.0', 'press_out': '85.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '21.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000040å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000047
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000160'}]
0000000160
00036000000047
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000110')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000160', 'rtu_no': '00030000000089', 'flmeter_no': '00036000000047', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 44, 844265), 'year': '2019', 'std_sum': '12', 'work_sum': '12', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 6, 3, 19, 53), 'min_std_flow_time': datetime.datetime(2019, 1, 3, 15, 31, 16), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 6, 3, 19, 53), 'min_work_flow_time': datetime.datetime(2019, 1, 3, 15, 31, 16), 'max_temperature': '34.7', 'min_temperature': '0.0', 'avg_temperature': '21.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 23, 7, 34), 'min_temp_time': datetime.datetime(2019, 1, 3, 15, 31, 16), 'max_press': '99.4', 'min_press': '0.0', 'avg_press': '93.0', 'max_press_time': datetime.datetime(2019, 8, 6, 3, 19, 53), 'min_press_time': datetime.datetime(2019, 1, 3, 15, 31, 16), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '12', 'sum_total_money': 21.0, 'total_buy_volume': None, 'total_buy_money': '119', 'remain_money': '98', 'remain_volume': None, 'fm_state': '100000000000000000000000000000000000000000000000', 'fm_state_msg': '[å¾…å®š]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '93.0', 'press_out': '93.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '7.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000047å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000010
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000161'}]
0000000161
00036000000010
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000077')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000161', 'rtu_no': 'FM0000000690', 'flmeter_no': '00036000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 45, 98587), 'year': '2019', 'std_sum': '69690786.950', 'work_sum': '16356652.160', 'max_std_flow': '5437.2', 'min_std_flow': '456.63', 'avg_std_flow': '2510.0', 'max_std_flow_time': datetime.datetime(2019, 4, 4, 8, 0, 44), 'min_std_flow_time': datetime.datetime(2019, 3, 30, 8, 0, 30), 'max_work_flow': '774.38', 'min_work_flow': '206.89', 'avg_work_flow': '564.0', 'max_work_flow_time': datetime.datetime(2019, 3, 28, 8, 0, 33), 'min_work_flow_time': datetime.datetime(2019, 4, 4, 8, 0, 38), 'max_temperature': '13.36', 'min_temperature': '-1.98', 'avg_temperature': '1.0', 'max_temp_time': datetime.datetime(2019, 4, 4, 8, 0, 44), 'min_temp_time': datetime.datetime(2019, 3, 30, 8, 0, 30), 'max_press': '460.83', 'min_press': '296.23', 'avg_press': '429.0', 'max_press_time': datetime.datetime(2019, 3, 28, 8, 0, 33), 'min_press_time': datetime.datetime(2019, 4, 4, 8, 0, 38), 'price': '0.000', 'use_volume_work': '144454.34', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '429.0', 'press_out': '429.0', 'temp_in': '1.0', 'temp_out': '1.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000010å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000021
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000162'}]
0000000162
00036000000021
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000115')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000162', 'rtu_no': '00030000000055', 'flmeter_no': '00036000000021', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 45, 373849), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.37', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 18, 6, 22), 'min_std_flow_time': datetime.datetime(2019, 2, 25, 0, 21, 8), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 2, 11, 8, 21), 'min_work_flow_time': datetime.datetime(2019, 2, 25, 0, 21, 8), 'max_temperature': '20.4', 'min_temperature': '0.0', 'avg_temperature': '8.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 18, 6, 22), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 20, 56), 'max_press': '103.2', 'min_press': '0.0', 'avg_press': '63.0', 'max_press_time': datetime.datetime(2019, 3, 28, 10, 6, 56), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 20, 56), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '26351', 'remain_money': '26351', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': 'æ— æŠ¥è­¦[çŠ¶æ€å­—2å¤‡ç”¨å¾…å®š;]', 'rtu_state': '1', 'rtu_state_msg': 'æ— æŠ¥è­¦[çŠ¶æ€å­—2å¤‡ç”¨å¾…å®š;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '63.0', 'press_out': '63.0', 'temp_in': '8.0', 'temp_out': '8.0', 'rssi': '15.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000021å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000037
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000163'}]
0000000163
00036000000037
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000122')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000163', 'rtu_no': '00030000000064', 'flmeter_no': '00036000000037', 'customer_no': '00030000000018', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 45, 656095), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 16, 34, 52), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 0, 20, 42), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 16, 34, 52), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 0, 20, 42), 'max_temperature': '12.7', 'min_temperature': '9.3', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 16, 34, 52), 'min_temp_time': datetime.datetime(2019, 2, 3, 0, 20, 51), 'max_press': '103.3', 'min_press': '100.0', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 1, 27, 0, 21, 18), 'min_press_time': datetime.datetime(2019, 1, 4, 0, 20, 42), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 6.0, 'total_buy_volume': None, 'total_buy_money': '6', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': 'æ— æŠ¥è­¦[çŠ¶æ€å­—2å¤‡ç”¨å¾…å®š;]', 'rtu_state': '1', 'rtu_state_msg': 'æ— æŠ¥è­¦[çŠ¶æ€å­—2å¤‡ç”¨å¾…å®š;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '15.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000037å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000013
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 7
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000164'}]
0000000164
00036000000013 â˜† sum_total_money <0 ç½®ä¸º0
00036000000013
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000086')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000164', 'rtu_no': '00030000000044', 'flmeter_no': '00036000000013', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 45, 971252), 'year': '2019', 'std_sum': '2075', 'work_sum': '175', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 16, 35, 37), 'min_std_flow_time': datetime.datetime(2019, 1, 14, 16, 30, 16), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 16, 35, 37), 'min_work_flow_time': datetime.datetime(2019, 1, 14, 16, 30, 16), 'max_temperature': '25.79', 'min_temperature': '10.8', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 6, 30, 0, 14, 30), 'min_temp_time': datetime.datetime(2019, 1, 14, 16, 30, 16), 'max_press': '102.6', 'min_press': '101.32', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 1, 21, 0, 21, 18), 'min_press_time': datetime.datetime(2019, 3, 4, 11, 25, 1), 'price': '2.35', 'use_volume_work': '2.0', 'use_volume_std': '2.0', 'use_money': '4.7', 'sum_total_volume': '2075', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2044.62', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,æœªå¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '1.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000013å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000065
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 6
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000165'}]
0000000165
00036000000065
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000117')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000165', 'rtu_no': '00030000000107', 'flmeter_no': '00036000000065', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 46, 235682), 'year': '2019', 'std_sum': '2', 'work_sum': '3', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 20, 0, 31), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 1, 21, 29), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 20, 0, 31), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 1, 21, 29), 'max_temperature': '33.3', 'min_temperature': '0.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 8, 11, 20, 0, 31), 'min_temp_time': datetime.datetime(2019, 4, 1, 1, 21, 17), 'max_press': '106.7', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 28, 3, 23, 27), 'min_press_time': datetime.datetime(2019, 4, 1, 1, 21, 17), 'price': '0', 'use_volume_work': '3.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000010000100000000', 'fm_state_msg': '[å¸‚ç”µæ–­å¼€][é˜€é—¨æ§åˆ¶å™¨æ–­çº¿æŠ¥è­¦]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': None, 'valve_state_msg': 'é˜€é—¨çŠ¶æ€æœªçŸ¥', 'power_voltage': '00', 'battery_voltage': '7.37', 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '16.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000065å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000072
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000166'}]
0000000166
00036000000072
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000078')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000166', 'rtu_no': '00030000000115', 'flmeter_no': '00036000000072', 'customer_no': '00030000000002', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 46, 592594), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 9, 17, 56, 15), 'min_std_flow_time': datetime.datetime(2019, 1, 26, 1, 20, 32), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 9, 17, 56, 15), 'min_work_flow_time': datetime.datetime(2019, 1, 26, 1, 20, 32), 'max_temperature': '20.8', 'min_temperature': '10.7', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 1, 31, 19, 33, 39), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 2, 22), 'max_press': '103.3', 'min_press': '100.4', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 28, 2, 58, 55), 'min_press_time': datetime.datetime(2019, 1, 26, 1, 20, 32), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': 'æ— æŠ¥è­¦[çŠ¶æ€å­—2å¤‡ç”¨å¾…å®š;]', 'rtu_state': '1', 'rtu_state_msg': 'æ— æŠ¥è­¦[çŠ¶æ€å­—2å¤‡ç”¨å¾…å®š;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '12.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000072å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000061
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000167'}]
0000000167
00036000000061
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000099')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000167', 'rtu_no': '00030000000103', 'flmeter_no': '00036000000061', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 46, 876831), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 16, 6, 23, 15), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 0, 34, 58), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 16, 6, 23, 15), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 0, 34, 58), 'max_temperature': '19.2', 'min_temperature': '0.0', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 4, 16, 6, 23, 15), 'min_temp_time': datetime.datetime(2019, 1, 4, 0, 34, 58), 'max_press': '127.9', 'min_press': '100.9', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 27, 18, 36, 4), 'min_press_time': datetime.datetime(2019, 2, 4, 12, 25, 38), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '14.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000061å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000026
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000168'}]
0000000168
00036000000026
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000092')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000168', 'rtu_no': '00030000000060', 'flmeter_no': '00036000000026', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 47, 123172), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 17, 10, 45, 43), 'min_std_flow_time': datetime.datetime(2019, 5, 14, 15, 34, 11), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 17, 10, 45, 43), 'min_work_flow_time': datetime.datetime(2019, 5, 14, 15, 34, 11), 'max_temperature': '20.0', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 5, 17, 10, 45, 43), 'min_temp_time': datetime.datetime(2019, 5, 14, 15, 34, 11), 'max_press': '101.3', 'min_press': '101.3', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 5, 17, 10, 45, 43), 'min_press_time': datetime.datetime(2019, 5, 14, 15, 34, 11), 'price': '768.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000001001101000100000000', 'fm_state_msg': '[å¸‚ç”µæ–­å¼€][å¼€ç›–é˜²æ‹†æŠ¥è­¦][æµé‡è®¡æ–­çº¿æŠ¥è­¦][æ¸©åº¦ä¼ æ„Ÿå™¨å¼‚å¸¸][å‹åŠ›ä¼ æ„Ÿå™¨æ•…éšœ]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '1', 'valve_state_msg': 'é˜€å…³', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '97', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '22.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000026å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000087
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000169'}]
0000000169
00036000000087
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000090')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000169', 'rtu_no': '00030000000127', 'flmeter_no': '00036000000087', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 47, 416388), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 1, 1, 21, 15), 'min_std_flow_time': datetime.datetime(2019, 6, 5, 19, 3, 34), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 1, 1, 21, 15), 'min_work_flow_time': datetime.datetime(2019, 6, 5, 19, 3, 34), 'max_temperature': '29.7', 'min_temperature': '21.3', 'avg_temperature': '26.0', 'max_temp_time': datetime.datetime(2019, 8, 1, 1, 21, 15), 'min_temp_time': datetime.datetime(2019, 6, 5, 19, 3, 34), 'max_press': '104.0', 'min_press': '100.4', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 7, 30, 1, 20, 24), 'min_press_time': datetime.datetime(2019, 8, 1, 0, 0, 48), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000001', 'fm_state_msg': '[ä½™é¢ä¸è¶³]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '26.0', 'temp_out': '26.0', 'rssi': '19.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000087å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000105
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000170'}]
0000000170
00036000000105
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000106')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000170', 'rtu_no': '00030000000145', 'flmeter_no': '00036000000105', 'customer_no': '00030000000070', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 47, 750494), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '25.12', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 29, 19, 52, 59), 'min_std_flow_time': datetime.datetime(2019, 7, 14, 1, 21, 9), 'max_work_flow': '25.12', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 29, 19, 52, 59), 'min_work_flow_time': datetime.datetime(2019, 7, 14, 1, 21, 9), 'max_temperature': '29.1', 'min_temperature': '20.6', 'avg_temperature': '24.0', 'max_temp_time': datetime.datetime(2019, 8, 11, 1, 20, 22), 'min_temp_time': datetime.datetime(2019, 8, 1, 1, 20, 21), 'max_press': '114.0', 'min_press': '98.5', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 7, 29, 19, 52, 59), 'min_press_time': datetime.datetime(2019, 8, 1, 1, 20, 21), 'price': '1.0', 'use_volume_work': '5.0', 'use_volume_std': '5.0', 'use_money': '5.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000001', 'fm_state_msg': '[ä½™é¢ä¸è¶³]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '24.0', 'temp_out': '24.0', 'rssi': '19.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000105å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000088
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 6
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000171'}]
0000000171
00036000000088
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000141')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000171', 'rtu_no': '00030000000128', 'flmeter_no': '00036000000088', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 48, 38725), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 1, 1, 21, 15), 'min_std_flow_time': datetime.datetime(2019, 3, 26, 1, 38, 54), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 1, 1, 21, 15), 'min_work_flow_time': datetime.datetime(2019, 3, 26, 1, 38, 54), 'max_temperature': '29.8', 'min_temperature': '0.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 8, 1, 1, 21, 15), 'min_temp_time': datetime.datetime(2019, 3, 26, 1, 38, 54), 'max_press': '102.3', 'min_press': '0.0', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 4, 10, 2, 56, 37), 'min_press_time': datetime.datetime(2019, 3, 26, 1, 38, 54), 'price': '1.0', 'use_volume_work': '415.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000001', 'fm_state_msg': '[ä½™é¢ä¸è¶³]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '25.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000088å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000070
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 7
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000172'}]
0000000172
00036000000070
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000080')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000172', 'rtu_no': '00030000000112', 'flmeter_no': '00036000000070', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 48, 350910), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '22.32', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 8, 14, 43, 54), 'min_std_flow_time': datetime.datetime(2019, 1, 2, 15, 3, 28), 'max_work_flow': '22.32', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 8, 14, 43, 54), 'min_work_flow_time': datetime.datetime(2019, 1, 2, 15, 3, 28), 'max_temperature': '51.2', 'min_temperature': '0.0', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 1, 31, 13, 55, 46), 'min_temp_time': datetime.datetime(2019, 1, 2, 15, 3, 28), 'max_press': '108.1', 'min_press': '0.0', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 2, 25, 22, 19), 'min_press_time': datetime.datetime(2019, 1, 2, 15, 3, 28), 'price': '2.32', 'use_volume_work': '7.0', 'use_volume_std': '2.0', 'use_money': '2.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '175', 'remain_money': '175', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000011100000000', 'fm_state_msg': '[å¸‚ç”µæ–­å¼€][RTUç”µæ± ä½ç”µé‡æŠ¥è­¦][é˜€é—¨æ§åˆ¶å™¨ä½ç”µé‡æŠ¥è­¦]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '1', 'valve_state_msg': 'é˜€å…³', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '0', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '18.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000070å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000020
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 6
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000173'}]
0000000173
00036000000020
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000104')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000173', 'rtu_no': '00030000000051', 'flmeter_no': '00036000000020', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 48, 674029), 'year': '2019', 'std_sum': '5', 'work_sum': '5', 'max_std_flow': '594.04', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 14, 14, 41, 23), 'min_std_flow_time': datetime.datetime(2019, 1, 11, 10, 39, 3), 'max_work_flow': '261.89', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 9, 11, 31, 18), 'min_work_flow_time': datetime.datetime(2019, 1, 11, 10, 39, 3), 'max_temperature': '30.7', 'min_temperature': '-24.9', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 6, 20, 15, 2, 40), 'min_temp_time': datetime.datetime(2019, 6, 1, 11, 8, 56), 'max_press': '103.2', 'min_press': '0.0', 'avg_press': '82.0', 'max_press_time': datetime.datetime(2019, 3, 14, 14, 41, 23), 'min_press_time': datetime.datetime(2019, 1, 11, 10, 39, 3), 'price': '1.0', 'use_volume_work': '162.0', 'use_volume_std': '91.0', 'use_money': '109.2', 'sum_total_volume': '5', 'sum_total_money': 50.0, 'total_buy_volume': None, 'total_buy_money': '85', 'remain_money': '35', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000100000000', 'fm_state_msg': '[å¸‚ç”µæ–­å¼€]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': '7.2', 'battery_level': '99', 'press_in': '82.0', 'press_out': '82.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '19.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000020å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000051
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 7
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000174'}]
0000000174
00036000000051
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000114')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000174', 'rtu_no': '00030000000093', 'flmeter_no': '00036000000051', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 48, 960402), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 1, 1, 10, 8), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 0, 21, 52), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 1, 1, 10, 8), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 0, 21, 52), 'max_temperature': '20.5', 'min_temperature': '0.0', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 8, 1, 1, 10, 8), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 21, 40), 'max_press': '112.6', 'min_press': '101.2', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 1, 31, 17, 27), 'min_press_time': datetime.datetime(2019, 2, 3, 0, 21, 34), 'price': '2.5', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '1245', 'remain_money': '1245.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000100000000', 'fm_state_msg': '[å¸‚ç”µæ–­å¼€]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': '0.0', 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '15.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000051å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000075
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000175'}]
0000000175
00036000000075 â˜† sum_total_money <0 ç½®ä¸º0
00036000000075
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000116')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000175', 'rtu_no': '00030000000117', 'flmeter_no': '00036000000075', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 49, 247492), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 17, 55, 7), 'min_std_flow_time': datetime.datetime(2019, 1, 29, 1, 20, 48), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 17, 55, 7), 'min_work_flow_time': datetime.datetime(2019, 1, 29, 1, 20, 48), 'max_temperature': '25.1', 'min_temperature': '10.7', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 17, 55, 7), 'min_temp_time': datetime.datetime(2019, 3, 1, 1, 21, 13), 'max_press': '163.7', 'min_press': '101.1', 'avg_press': '107.0', 'max_press_time': datetime.datetime(2019, 2, 27, 17, 19, 46), 'min_press_time': datetime.datetime(2019, 2, 2, 1, 21, 11), 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2608.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,æœªå¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '107.0', 'press_out': '107.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '8.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000075å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000039
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000176'}]
0000000176
00036000000039
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000147')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000176', 'rtu_no': '00030000000080', 'flmeter_no': '00036000000039', 'customer_no': '00030000000029', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 49, 528740), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 22, 54, 38), 'min_std_flow_time': datetime.datetime(2019, 1, 11, 11, 6, 49), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 22, 54, 38), 'min_work_flow_time': datetime.datetime(2019, 1, 11, 11, 6, 49), 'max_temperature': '30.1', 'min_temperature': '0.0', 'avg_temperature': '5.0', 'max_temp_time': datetime.datetime(2019, 8, 11, 22, 54, 38), 'min_temp_time': datetime.datetime(2019, 1, 11, 11, 6, 49), 'max_press': '99.1', 'min_press': '0.0', 'avg_press': '19.0', 'max_press_time': datetime.datetime(2019, 7, 24, 20, 46, 28), 'min_press_time': datetime.datetime(2019, 1, 11, 11, 6, 49), 'price': '3.79', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '659', 'remain_money': '659.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000100000000', 'fm_state_msg': '[å¸‚ç”µæ–­å¼€]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': '7.35', 'battery_level': '100', 'press_in': '19.0', 'press_out': '19.0', 'temp_in': '5.0', 'temp_out': '5.0', 'rssi': '15.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000039å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000054
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000177'}]
0000000177
00036000000054
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000094')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000177', 'rtu_no': '00030000000096', 'flmeter_no': '00036000000054', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 49, 764113), 'year': '2019', 'std_sum': '16816', 'work_sum': '16613', 'max_std_flow': '90.17', 'min_std_flow': '0.0', 'avg_std_flow': '24.0', 'max_std_flow_time': datetime.datetime(2019, 6, 3, 13, 1, 18), 'min_std_flow_time': datetime.datetime(2019, 1, 2, 0, 20, 44), 'max_work_flow': '90.17', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 6, 3, 13, 1, 18), 'min_work_flow_time': datetime.datetime(2019, 1, 2, 0, 20, 44), 'max_temperature': '98.4', 'min_temperature': '-20.0', 'avg_temperature': '22.0', 'max_temp_time': datetime.datetime(2019, 3, 25, 12, 38, 16), 'min_temp_time': datetime.datetime(2019, 8, 1, 0, 20, 54), 'max_press': '119.0', 'min_press': '0.0', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 8, 5, 13, 7, 43), 'min_press_time': datetime.datetime(2019, 1, 2, 0, 20, 44), 'price': '3.25', 'use_volume_work': '26099.0', 'use_volume_std': '19174.0', 'use_money': '20870.5', 'sum_total_volume': '16816', 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '3', 'remain_money': '0.0', 'remain_volume': None, 'fm_state': '000000001000000000000000000000000000000000000001', 'fm_state_msg': '[ä½™é¢ä¸è¶³][å¾…å®š]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '13.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000054å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000083
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000178'}]
0000000178
00036000000083 â˜† sum_total_money <0 ç½®ä¸º0
00036000000083
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000146')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000178', 'rtu_no': '00030000000122', 'flmeter_no': '00036000000083', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 50, 7460), 'year': '2019', 'std_sum': '31', 'work_sum': '16', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 17, 10, 57, 54), 'min_std_flow_time': datetime.datetime(2019, 4, 25, 15, 49, 54), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 17, 10, 57, 54), 'min_work_flow_time': datetime.datetime(2019, 4, 25, 15, 49, 54), 'max_temperature': '20.0', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 5, 17, 10, 57, 54), 'min_temp_time': datetime.datetime(2019, 4, 25, 15, 49, 54), 'max_press': '101.32', 'min_press': '101.32', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 5, 17, 10, 57, 54), 'min_press_time': datetime.datetime(2019, 4, 25, 15, 49, 54), 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '31', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '26377.18', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,æœªå¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000083å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000068
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000179'}]
0000000179
00036000000068
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000107')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000179', 'rtu_no': '00030000000110', 'flmeter_no': '00036000000068', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 50, 264771), 'year': '2019', 'std_sum': '22', 'work_sum': '22', 'max_std_flow': '7.44', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 6, 15, 10, 31, 31), 'min_std_flow_time': datetime.datetime(2019, 1, 3, 13, 35, 47), 'max_work_flow': '7.44', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 6, 15, 10, 31, 31), 'min_work_flow_time': datetime.datetime(2019, 1, 3, 13, 35, 47), 'max_temperature': '29.1', 'min_temperature': '0.0', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 8, 11, 2, 30, 43), 'min_temp_time': datetime.datetime(2019, 1, 3, 13, 35, 47), 'max_press': '106.4', 'min_press': '0.0', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 26, 1, 20, 56), 'min_press_time': datetime.datetime(2019, 1, 3, 13, 35, 47), 'price': '1.0', 'use_volume_work': '7.0', 'use_volume_std': '27.0', 'use_money': '27.0', 'sum_total_volume': '22', 'sum_total_money': 5.0, 'total_buy_volume': None, 'total_buy_money': '45', 'remain_money': '40.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000001001000000000000000', 'fm_state_msg': '[æ¸©åº¦ä¼ æ„Ÿå™¨å¼‚å¸¸][å‹åŠ›ä¼ æ„Ÿå™¨æ•…éšœ]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': '7.28', 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '18.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000068å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000049
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000180'}]
0000000180
00036000000049
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000085')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000180', 'rtu_no': '00030000000091', 'flmeter_no': '00036000000049', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 50, 507259), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 2, 19, 39), 'min_std_flow_time': datetime.datetime(2019, 1, 1, 0, 21, 25), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 2, 19, 39), 'min_work_flow_time': datetime.datetime(2019, 1, 1, 0, 21, 25), 'max_temperature': '20.9', 'min_temperature': '0.0', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 1, 23, 14, 44, 38), 'min_temp_time': datetime.datetime(2019, 1, 1, 0, 21, 25), 'max_press': '103.5', 'min_press': '0.0', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 1, 23, 14, 44, 38), 'min_press_time': datetime.datetime(2019, 1, 1, 0, 21, 25), 'price': '2.5', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '100', 'remain_money': '99.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000100000000', 'fm_state_msg': '[å¸‚ç”µæ–­å¼€]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '80', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '16.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000049å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000103
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000181'}]
0000000181
00036000000103 â˜† sum_total_money <0 ç½®ä¸º0
00036000000103
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000127')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000181', 'rtu_no': '00030000000143', 'flmeter_no': '00036000000103', 'customer_no': '00030000000069', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 50, 809316), 'year': '2019', 'std_sum': '28', 'work_sum': '0', 'max_std_flow': '62.77', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 11, 12, 4, 47), 'min_std_flow_time': datetime.datetime(2019, 6, 14, 16, 37, 11), 'max_work_flow': '35.91', 'min_work_flow': '35.91', 'avg_work_flow': '35.0', 'max_work_flow_time': datetime.datetime(2019, 7, 11, 12, 4, 47), 'min_work_flow_time': datetime.datetime(2019, 6, 14, 16, 37, 11), 'max_temperature': '28.44', 'min_temperature': '17.56', 'avg_temperature': '21.0', 'max_temp_time': datetime.datetime(2019, 7, 11, 12, 4, 47), 'min_temp_time': datetime.datetime(2019, 6, 14, 16, 37, 11), 'max_press': '79.83', 'min_press': '76.4', 'avg_press': '76.0', 'max_press_time': datetime.datetime(2019, 7, 11, 12, 4, 47), 'min_press_time': datetime.datetime(2019, 6, 14, 16, 37, 11), 'price': '2.27', 'use_volume_work': '0.0', 'use_volume_std': '8.0', 'use_money': '18.16', 'sum_total_volume': '28', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '981.84', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,æœªå¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '76.0', 'press_out': '76.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000103å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000063
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000182'}]
0000000182
00036000000063 â˜† sum_total_money <0 ç½®ä¸º0
00036000000063
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000100')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000182', 'rtu_no': '00030000000105', 'flmeter_no': '00036000000063', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 51, 81588), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.02', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 1, 9, 10, 9), 'min_std_flow_time': datetime.datetime(2019, 1, 3, 13, 11, 31), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 7, 1, 20, 27), 'min_work_flow_time': datetime.datetime(2019, 1, 3, 13, 11, 31), 'max_temperature': '21.7', 'min_temperature': '0.0', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 1, 27, 0, 21, 5), 'min_temp_time': datetime.datetime(2019, 1, 3, 13, 11, 31), 'max_press': '103.0', 'min_press': '0.0', 'avg_press': '79.0', 'max_press_time': datetime.datetime(2019, 1, 27, 0, 21, 5), 'min_press_time': datetime.datetime(2019, 1, 3, 13, 11, 31), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '79.0', 'press_out': '79.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '7.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000063å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000077
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000183'}]
0000000183
00036000000077
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000084')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000183', 'rtu_no': '00030000000118', 'flmeter_no': '00036000000077', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 51, 342889), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '1.88', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 19, 32, 29), 'min_std_flow_time': datetime.datetime(2019, 1, 29, 0, 28, 21), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 16, 18, 25, 6), 'min_work_flow_time': datetime.datetime(2019, 1, 29, 0, 28, 21), 'max_temperature': '26.3', 'min_temperature': '10.9', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 16, 25, 7), 'min_temp_time': datetime.datetime(2019, 3, 1, 1, 21, 15), 'max_press': '116.1', 'min_press': '100.7', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 4, 16, 18, 25, 6), 'min_press_time': datetime.datetime(2019, 4, 11, 4, 10, 36), 'price': '1.0', 'use_volume_work': '4.0', 'use_volume_std': '9.0', 'use_money': '21.51', 'sum_total_volume': '0', 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '11.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000077å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000011
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000184'}]
0000000184
00036000000011
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000124')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000184', 'rtu_no': 'FM0000000690', 'flmeter_no': '00036000000011', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 51, 598206), 'year': '2019', 'std_sum': '69322376.950', 'work_sum': '16270391.670', 'max_std_flow': '685.94', 'min_std_flow': '685.94', 'avg_std_flow': '685.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'min_std_flow_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'max_work_flow': '141.87', 'min_work_flow': '141.87', 'avg_work_flow': '141.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'min_work_flow_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'max_temperature': '4.89', 'min_temperature': '4.89', 'avg_temperature': '4.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'min_temp_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'max_press': '460.44', 'min_press': '460.44', 'avg_press': '460.0', 'max_press_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'min_press_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '460.0', 'press_out': '460.0', 'temp_in': '4.0', 'temp_out': '4.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000011å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000106
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000185'}]
0000000185
00036000000106
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000108')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000185', 'rtu_no': '00030000000146', 'flmeter_no': '00036000000106', 'customer_no': '00030000000070', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 51, 856515), 'year': '2019', 'std_sum': '2', 'work_sum': '2', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 1, 21, 15), 'min_std_flow_time': datetime.datetime(2019, 8, 1, 1, 20, 54), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 1, 21, 15), 'min_work_flow_time': datetime.datetime(2019, 8, 1, 1, 20, 54), 'max_temperature': '26.6', 'min_temperature': '21.7', 'avg_temperature': '23.0', 'max_temp_time': datetime.datetime(2019, 8, 11, 1, 21, 15), 'min_temp_time': datetime.datetime(2019, 8, 1, 1, 20, 54), 'max_press': '100.6', 'min_press': '98.1', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 8, 11, 1, 21, 15), 'min_press_time': datetime.datetime(2019, 8, 1, 1, 20, 54), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '2', 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000001', 'fm_state_msg': '[ä½™é¢ä¸è¶³]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '23.0', 'temp_out': '23.0', 'rssi': '18.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000106å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000003
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 7
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000186'}]
0000000186
00036000000003 â˜† sum_total_money <0 ç½®ä¸º0
00036000000003
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000138')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000186', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000003', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 52, 197604), 'year': '2019', 'std_sum': '80', 'work_sum': '83', 'max_std_flow': '1671.35', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 11, 18, 8, 45), 'min_std_flow_time': datetime.datetime(2019, 1, 3, 13, 43, 12), 'max_work_flow': '1689.07', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 11, 18, 8, 45), 'min_work_flow_time': datetime.datetime(2019, 1, 3, 13, 43, 12), 'max_temperature': '25.56', 'min_temperature': '0.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 11, 18, 8, 45), 'min_temp_time': datetime.datetime(2019, 1, 3, 13, 43, 12), 'max_press': '101.8', 'min_press': '-2109584.5', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 11, 18, 8, 45), 'min_press_time': datetime.datetime(2019, 1, 3, 13, 43, 12), 'price': '2.35', 'use_volume_work': '8.0', 'use_volume_std': '7.0', 'use_money': '16.73', 'sum_total_volume': '80', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1726.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,æœªå¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000003å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000102
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 6
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000187'}]
0000000187
00036000000102
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000126')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000187', 'rtu_no': '00030000000142', 'flmeter_no': '00036000000102', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 52, 513758), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '9175.04', 'min_std_flow': '0.0', 'avg_std_flow': '1611.0', 'max_std_flow_time': datetime.datetime(2019, 4, 1, 22, 51, 4), 'min_std_flow_time': datetime.datetime(2019, 3, 27, 17, 4, 36), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 10, 16, 17, 12), 'min_work_flow_time': datetime.datetime(2019, 3, 27, 17, 4, 36), 'max_temperature': '8.0', 'min_temperature': '-9.0', 'avg_temperature': '24.0', 'max_temp_time': datetime.datetime(2019, 4, 1, 21, 22, 39), 'min_temp_time': datetime.datetime(2019, 3, 27, 17, 6, 40), 'max_press': '99.8', 'min_press': '0.0', 'avg_press': '49.0', 'max_press_time': datetime.datetime(2019, 7, 10, 16, 17, 12), 'min_press_time': datetime.datetime(2019, 3, 27, 17, 4, 36), 'price': '1.0', 'use_volume_work': '5.0', 'use_volume_std': '2.0', 'use_money': '2.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000010000010000000000000000000000000000000001', 'fm_state_msg': '[ä½™é¢ä¸è¶³][å¾…å®š][å¾…å®š]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '49.0', 'press_out': '49.0', 'temp_in': '24.0', 'temp_out': '24.0', 'rssi': '23.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000102å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000059
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000188'}]
0000000188
00036000000059
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000112')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000188', 'rtu_no': '00030000000101', 'flmeter_no': '00036000000059', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 52, 825927), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '24.64', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 9, 8, 40, 39), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 1, 28, 37), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 22, 1, 20, 32), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 1, 28, 37), 'max_temperature': '23.9', 'min_temperature': '0.0', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 2, 5, 34), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 12, 21), 'max_press': '106.5', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 26, 14, 24, 52), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 12, 21), 'price': '1.0', 'use_volume_work': '10.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '17.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000059å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000009
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000189'}]
0000000189
00036000000009 â˜† sum_total_money <0 ç½®ä¸º0
00036000000009
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000103')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000189', 'rtu_no': '00030000000012', 'flmeter_no': '00036000000009', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 53, 114154), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 14, 13, 59, 40), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 2, 8, 20), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 14, 13, 59, 40), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 2, 8, 20), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 14, 13, 59, 40), 'min_temp_time': datetime.datetime(2019, 1, 4, 2, 8, 20), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 14, 13, 59, 40), 'min_press_time': datetime.datetime(2019, 1, 4, 2, 8, 20), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '47.0', 'use_money': '47.0', 'sum_total_volume': '19715', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '80335.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,æœªå¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000009å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000101
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000190'}]
0000000190
00036000000101
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000140')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000190', 'rtu_no': '00030000000141', 'flmeter_no': '00036000000101', 'customer_no': '00030000000068', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 53, 490150), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 15, 11, 36, 47), 'min_std_flow_time': datetime.datetime(2019, 3, 27, 16, 46, 58), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 15, 11, 36, 47), 'min_work_flow_time': datetime.datetime(2019, 3, 27, 16, 46, 58), 'max_temperature': '20.0', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 4, 15, 11, 36, 47), 'min_temp_time': datetime.datetime(2019, 3, 27, 16, 46, 58), 'max_press': '101.3', 'min_press': '101.3', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 4, 15, 11, 36, 47), 'min_press_time': datetime.datetime(2019, 3, 27, 16, 46, 58), 'price': '0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '13.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000101å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000073
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000191'}]
0000000191
00036000000073 â˜† sum_total_money <0 ç½®ä¸º0
00036000000073
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000135')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000191', 'rtu_no': '00030000000116', 'flmeter_no': '00036000000073', 'customer_no': '00030000000047', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 53, 800319), 'year': '2019', 'std_sum': '31', 'work_sum': '16', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 17, 55, 8), 'min_std_flow_time': datetime.datetime(2019, 1, 25, 14, 17, 36), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 17, 55, 8), 'min_work_flow_time': datetime.datetime(2019, 1, 25, 14, 17, 36), 'max_temperature': '24.1', 'min_temperature': '0.0', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 1, 31, 14, 25, 54), 'min_temp_time': datetime.datetime(2019, 1, 25, 14, 17, 36), 'max_press': '103.1', 'min_press': '0.0', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 2, 28, 1, 22, 36), 'min_press_time': datetime.datetime(2019, 1, 25, 14, 17, 36), 'price': '2.39', 'use_volume_work': '16.0', 'use_volume_std': '31.0', 'use_money': '74.09', 'sum_total_volume': '31', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '26377.18', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,æœªå¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '8.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000073å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000022
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000192'}]
0000000192
00036000000022
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000121')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000192', 'rtu_no': None, 'flmeter_no': '00036000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 54, 241139), 'year': '2019', 'std_sum': '1705162.040', 'work_sum': '477614.430', 'max_std_flow': '170.85', 'min_std_flow': '0.0', 'avg_std_flow': '57.0', 'max_std_flow_time': datetime.datetime(2019, 4, 25, 10, 0, 23), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 10, 0, 59), 'max_work_flow': '41.54', 'min_work_flow': '0.0', 'avg_work_flow': '13.0', 'max_work_flow_time': datetime.datetime(2019, 4, 25, 10, 0, 23), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 10, 0, 59), 'max_temperature': '40.39', 'min_temperature': '-1.22', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 5, 1, 20, 0, 23), 'min_temp_time': datetime.datetime(2019, 1, 4, 10, 0, 59), 'max_press': '454.2', 'min_press': '101.03', 'avg_press': '297.0', 'max_press_time': datetime.datetime(2019, 5, 1, 20, 0, 23), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 0, 23), 'price': '0.000', 'use_volume_work': '45526.76', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '297.0', 'press_out': '297.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000022å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000028
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000193'}]
0000000193
00036000000028
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000134')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000193', 'rtu_no': None, 'flmeter_no': '00036000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 54, 573251), 'year': '2019', 'std_sum': '326093.820', 'work_sum': '300518.090', 'max_std_flow': '69.64', 'min_std_flow': '0.0', 'avg_std_flow': '5.0', 'max_std_flow_time': datetime.datetime(2019, 5, 12, 6, 0, 21), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 10, 0, 25), 'max_work_flow': '65.12', 'min_work_flow': '0.0', 'avg_work_flow': '4.0', 'max_work_flow_time': datetime.datetime(2019, 5, 12, 6, 0, 21), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 10, 0, 25), 'max_temperature': '36.18', 'min_temperature': '12.2', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 5, 12, 6, 0, 21), 'min_temp_time': datetime.datetime(2019, 5, 1, 10, 0, 25), 'max_press': '113.69', 'min_press': '101.33', 'avg_press': '104.0', 'max_press_time': datetime.datetime(2019, 4, 4, 8, 0, 26), 'min_press_time': datetime.datetime(2019, 1, 4, 10, 0, 25), 'price': '0.000', 'use_volume_work': '13443.43', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '104.0', 'press_out': '104.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000028å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000056
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000194'}]
0000000194
00036000000056
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000083')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000194', 'rtu_no': '00030000000098', 'flmeter_no': '00036000000056', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 54, 928384), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 11, 23, 13), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 1, 21, 57), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 11, 23, 13), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 1, 21, 57), 'max_temperature': '30.7', 'min_temperature': '15.8', 'avg_temperature': '22.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 4, 22, 7), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 21, 4), 'max_press': '535.5', 'min_press': '89.4', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 1, 31, 22, 27, 21), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 21, 4), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '10.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000056å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000036
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000195'}]
0000000195
00036000000036
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000093')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000195', 'rtu_no': '00030000000063', 'flmeter_no': '00036000000036', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 55, 280360), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 16, 18, 26, 15), 'min_std_flow_time': datetime.datetime(2019, 4, 8, 14, 30, 7), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 16, 18, 26, 15), 'min_work_flow_time': datetime.datetime(2019, 4, 8, 14, 30, 7), 'max_temperature': '23.0', 'min_temperature': '10.8', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 4, 16, 18, 26, 15), 'min_temp_time': datetime.datetime(2019, 4, 8, 14, 30, 7), 'max_press': '101.8', 'min_press': '95.7', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 4, 16, 18, 26, 15), 'min_press_time': datetime.datetime(2019, 4, 8, 14, 30, 7), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '4', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '14.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000036å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000104
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000196'}]
0000000196
00036000000104
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000095')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000196', 'rtu_no': '00030000000144', 'flmeter_no': '00036000000104', 'customer_no': '00030000000069', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 55, 597512), 'year': '2019', 'std_sum': '2', 'work_sum': '2', 'max_std_flow': '6.62', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 6, 19, 10, 55), 'min_std_flow_time': datetime.datetime(2019, 6, 19, 10, 44, 18), 'max_work_flow': '6.62', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 6, 19, 10, 55), 'min_work_flow_time': datetime.datetime(2019, 6, 19, 10, 44, 18), 'max_temperature': '30.4', 'min_temperature': '21.9', 'avg_temperature': '24.0', 'max_temp_time': datetime.datetime(2019, 6, 19, 10, 55), 'min_temp_time': datetime.datetime(2019, 8, 1, 1, 20, 36), 'max_press': '118.9', 'min_press': '34.3', 'avg_press': '91.0', 'max_press_time': datetime.datetime(2019, 7, 30, 9, 42, 22), 'min_press_time': datetime.datetime(2019, 6, 19, 10, 44, 18), 'price': '1.0', 'use_volume_work': '2.0', 'use_volume_std': '2.0', 'use_money': '2.0', 'sum_total_volume': '2', 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '7', 'remain_money': '4.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '91.0', 'press_out': '91.0', 'temp_in': '24.0', 'temp_out': '24.0', 'rssi': '22.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000104å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000052
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 7
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000197'}]
0000000197
00036000000052
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000118')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000197', 'rtu_no': '00030000000094', 'flmeter_no': '00036000000052', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 55, 925635), 'year': '2019', 'std_sum': '16261', 'work_sum': '16121', 'max_std_flow': '19.28', 'min_std_flow': '0.0', 'avg_std_flow': '2.0', 'max_std_flow_time': datetime.datetime(2019, 5, 29, 12, 27, 7), 'min_std_flow_time': datetime.datetime(2019, 1, 3, 13, 29, 23), 'max_work_flow': '19.28', 'min_work_flow': '0.0', 'avg_work_flow': '1.0', 'max_work_flow_time': datetime.datetime(2019, 5, 29, 12, 27, 7), 'min_work_flow_time': datetime.datetime(2019, 1, 3, 13, 29, 23), 'max_temperature': '51.1', 'min_temperature': '11.3', 'avg_temperature': '22.0', 'max_temp_time': datetime.datetime(2019, 5, 29, 12, 27, 7), 'min_temp_time': datetime.datetime(2019, 2, 2, 14, 26, 38), 'max_press': '106.8', 'min_press': '94.8', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 1, 25, 11, 29, 55), 'min_press_time': datetime.datetime(2019, 7, 1, 0, 21, 33), 'price': '1.0', 'use_volume_work': '15867.0', 'use_volume_std': '9492.0', 'use_money': '9492.0', 'sum_total_volume': '16261', 'sum_total_money': 10.0, 'total_buy_volume': None, 'total_buy_money': '10', 'remain_money': '0', 'remain_volume': None, 'fm_state': '100000000000000000000000000000000000000000000001', 'fm_state_msg': '[ä½™é¢ä¸è¶³][å¾…å®š]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '7.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000052å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000082
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000198'}]
0000000198
00036000000082
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000123')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000198', 'rtu_no': '00030000000124', 'flmeter_no': '00036000000082', 'customer_no': '00030000000052', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 56, 260742), 'year': '2019', 'std_sum': '5', 'work_sum': '5', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 29, 1, 20, 26), 'min_std_flow_time': datetime.datetime(2019, 6, 6, 1, 20, 47), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 29, 1, 20, 26), 'min_work_flow_time': datetime.datetime(2019, 6, 6, 1, 20, 47), 'max_temperature': '26.4', 'min_temperature': '19.4', 'avg_temperature': '23.0', 'max_temp_time': datetime.datetime(2019, 7, 29, 1, 20, 26), 'min_temp_time': datetime.datetime(2019, 6, 6, 1, 20, 47), 'max_press': '100.8', 'min_press': '99.2', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 6, 29, 1, 21, 10), 'min_press_time': datetime.datetime(2019, 6, 6, 1, 20, 47), 'price': '1.0', 'use_volume_work': '3.0', 'use_volume_std': '3.0', 'use_money': '3.0', 'sum_total_volume': '5', 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000001', 'fm_state_msg': '[ä½™é¢ä¸è¶³]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '23.0', 'temp_out': '23.0', 'rssi': '23.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000082å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000053
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000199'}]
0000000199
00036000000053
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000136')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000199', 'rtu_no': '00030000000095', 'flmeter_no': '00036000000053', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 56, 616876), 'year': '2019', 'std_sum': '4', 'work_sum': '5', 'max_std_flow': '27.06', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 6, 1, 11, 20, 47), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 3, 22, 23), 'max_work_flow': '27.06', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 6, 1, 11, 20, 47), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 3, 22, 23), 'max_temperature': '30.7', 'min_temperature': '0.0', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 8, 12, 0, 2, 21), 'min_temp_time': datetime.datetime(2019, 1, 4, 3, 22, 23), 'max_press': '219.9', 'min_press': '0.0', 'avg_press': '90.0', 'max_press_time': datetime.datetime(2019, 4, 22, 11, 2, 10), 'min_press_time': datetime.datetime(2019, 1, 4, 3, 22, 23), 'price': '3.0', 'use_volume_work': '6.0', 'use_volume_std': '6.0', 'use_money': '14.0', 'sum_total_volume': '4', 'sum_total_money': 14.0, 'total_buy_volume': None, 'total_buy_money': '7', 'remain_money': '-7.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000100000000', 'fm_state_msg': '[å¸‚ç”µæ–­å¼€]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '1', 'valve_state_msg': 'é˜€å…³', 'power_voltage': '00', 'battery_voltage': '7.3', 'battery_level': '100', 'press_in': '90.0', 'press_out': '90.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '23.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000053å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000062
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000200'}]
0000000200
00036000000062
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000144')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000200', 'rtu_no': '00030000000104', 'flmeter_no': '00036000000062', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 56, 938926), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 18, 7, 26, 7), 'min_std_flow_time': datetime.datetime(2019, 1, 2, 1, 20, 54), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 18, 7, 26, 7), 'min_work_flow_time': datetime.datetime(2019, 1, 2, 1, 20, 54), 'max_temperature': '21.3', 'min_temperature': '14.2', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 1, 31, 18, 27, 52), 'min_temp_time': datetime.datetime(2019, 2, 1, 12, 25, 40), 'max_press': '105.4', 'min_press': '100.1', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 28, 2, 25, 32), 'min_press_time': datetime.datetime(2019, 2, 1, 12, 25, 40), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 899.0, 'total_buy_volume': None, 'total_buy_money': '998', 'remain_money': '99', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '20.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000062å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000057
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000201'}]
0000000201
00036000000057
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000101')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000201', 'rtu_no': '00030000000099', 'flmeter_no': '00036000000057', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 57, 252098), 'year': '2019', 'std_sum': '5', 'work_sum': '5', 'max_std_flow': '0.05', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 21, 11, 51, 1), 'min_std_flow_time': datetime.datetime(2019, 1, 3, 14, 34, 26), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 1, 7, 9, 21), 'min_work_flow_time': datetime.datetime(2019, 1, 3, 14, 34, 26), 'max_temperature': '24.0', 'min_temperature': '21.5', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 1, 27, 0, 21, 4), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 20, 51), 'max_press': '106.5', 'min_press': '101.0', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 1, 27, 0, 21, 4), 'min_press_time': datetime.datetime(2019, 2, 3, 0, 21, 4), 'price': '1.0', 'use_volume_work': '5.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': 'æ— æŠ¥è­¦[çŠ¶æ€å­—2å¤‡ç”¨å¾…å®š;]', 'rtu_state': '1', 'rtu_state_msg': 'æ— æŠ¥è­¦[çŠ¶æ€å­—2å¤‡ç”¨å¾…å®š;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '15.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000057å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000064
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000202'}]
0000000202
00036000000064
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000129')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000202', 'rtu_no': '00030000000106', 'flmeter_no': '00036000000064', 'customer_no': '00030000000046', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 57, 611131), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.74', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 1, 22, 26, 54), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 1, 21), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 14, 7, 16, 17), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 1, 21), 'max_temperature': '22.2', 'min_temperature': '-4.8', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 3, 1, 22, 26, 54), 'min_temp_time': datetime.datetime(2019, 3, 1, 1, 21, 13), 'max_press': '109.2', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 1, 22, 26, 54), 'min_press_time': datetime.datetime(2019, 3, 1, 1, 21, 13), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '14.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000064å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000058
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 6
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000203'}]
0000000203
00036000000058
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000088')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000203', 'rtu_no': '00030000000100', 'flmeter_no': '00036000000058', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 57, 908338), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '5.4', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 15, 12, 42, 22), 'min_std_flow_time': datetime.datetime(2019, 1, 3, 14, 25, 37), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 6, 25, 16, 12, 2), 'min_work_flow_time': datetime.datetime(2019, 1, 3, 14, 25, 37), 'max_temperature': '27.7', 'min_temperature': '0.0', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 6, 25, 16, 12, 2), 'min_temp_time': datetime.datetime(2019, 6, 1, 0, 1, 22), 'max_press': '124.4', 'min_press': '0.0', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 4, 15, 12, 42, 22), 'min_press_time': datetime.datetime(2019, 6, 1, 0, 1, 22), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '21.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000058å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000079
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000204'}]
0000000204
00036000000079 â˜† sum_total_money <0 ç½®ä¸º0
00036000000079
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000109')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000204', 'rtu_no': '00030000000119', 'flmeter_no': '00036000000079', 'customer_no': '00030000000049', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 58, 239547), 'year': '2019', 'std_sum': '11', 'work_sum': '11', 'max_std_flow': '35.91', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 13, 14, 52, 57), 'min_std_flow_time': datetime.datetime(2019, 3, 3, 1, 21, 47), 'max_work_flow': '35.91', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 13, 14, 52, 57), 'min_work_flow_time': datetime.datetime(2019, 3, 3, 1, 21, 47), 'max_temperature': '35.91', 'min_temperature': '0.0', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 13, 14, 52, 57), 'min_temp_time': datetime.datetime(2019, 3, 3, 1, 21, 47), 'max_press': '102.8', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 13, 14, 52, 57), 'min_press_time': datetime.datetime(2019, 3, 3, 1, 21, 47), 'price': '2.39', 'use_volume_work': '11.0', 'use_volume_std': '11.0', 'use_money': '26.29', 'sum_total_volume': '11', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2427.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,æœªå¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000079å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000025
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000205'}]
0000000205
00036000000025
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000082')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000205', 'rtu_no': '00030000000059', 'flmeter_no': '00036000000025', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 58, 606466), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 5, 16, 3, 47), 'min_std_flow_time': datetime.datetime(2019, 5, 5, 16, 3, 47), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 5, 16, 3, 47), 'min_work_flow_time': datetime.datetime(2019, 5, 5, 16, 3, 47), 'max_temperature': '23.8', 'min_temperature': '23.8', 'avg_temperature': '23.0', 'max_temp_time': datetime.datetime(2019, 5, 5, 16, 3, 47), 'min_temp_time': datetime.datetime(2019, 5, 5, 16, 3, 47), 'max_press': '100.6', 'min_press': '100.6', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 5, 5, 16, 3, 47), 'min_press_time': datetime.datetime(2019, 5, 5, 16, 3, 47), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000001', 'fm_state_msg': '[ä½™é¢ä¸è¶³]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '23.0', 'temp_out': '23.0', 'rssi': '28.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000025å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000043
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000206'}]
0000000206
00036000000043
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000128')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000206', 'rtu_no': '00030000000084', 'flmeter_no': '00036000000043', 'customer_no': '00030000000035', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 58, 977475), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 17, 0, 21, 25), 'min_std_flow_time': datetime.datetime(2019, 1, 3, 0, 23), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 17, 0, 21, 25), 'min_work_flow_time': datetime.datetime(2019, 1, 3, 0, 23), 'max_temperature': '8.3', 'min_temperature': '0.5', 'avg_temperature': '9.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 21, 31, 50), 'min_temp_time': datetime.datetime(2019, 1, 3, 0, 23), 'max_press': '103.6', 'min_press': '86.9', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 31, 50), 'min_press_time': datetime.datetime(2019, 2, 4, 11, 29), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '9.0', 'temp_out': '9.0', 'rssi': '7.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000043å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000004
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 6
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000207'}]
0000000207
00036000000004 â˜† sum_total_money <0 ç½®ä¸º0
00036000000004
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000097')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000207', 'rtu_no': '00030000000018', 'flmeter_no': '00036000000004', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 59, 289789), 'year': '2019', 'std_sum': '60364', 'work_sum': '51790', 'max_std_flow': '114.36', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 11, 10, 15, 9), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 26, 27), 'max_work_flow': '114.36', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 11, 10, 15, 9), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 26, 27), 'max_temperature': '20.0', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 8, 11, 16, 35, 36), 'min_temp_time': datetime.datetime(2019, 3, 4, 11, 26, 27), 'max_press': '101.32', 'min_press': '101.32', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 8, 11, 16, 35, 36), 'min_press_time': datetime.datetime(2019, 3, 4, 11, 26, 27), 'price': '2.35', 'use_volume_work': '7.0', 'use_volume_std': '7.0', 'use_money': '16.73', 'sum_total_volume': '60364', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '52100.2', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,æœªå¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000004å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000038
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000208'}]
0000000208
00036000000038
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000120')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000208', 'rtu_no': '00030000000079', 'flmeter_no': '00036000000038', 'customer_no': '00030000000016', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 59, 627737), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 15, 0, 52, 3), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 1, 35, 8), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 15, 0, 52, 3), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 1, 35, 8), 'max_temperature': '9.5', 'min_temperature': '-0.2', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 20, 27, 24), 'min_temp_time': datetime.datetime(2019, 2, 2, 0, 45, 8), 'max_press': '99.8', 'min_press': '0.0', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 7, 15, 0, 52, 3), 'min_press_time': datetime.datetime(2019, 1, 4, 1, 35, 8), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000001', 'fm_state_msg': '[ä½™é¢ä¸è¶³]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '11.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000038å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000066
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000209'}]
0000000209
00036000000066
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000111')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000209', 'rtu_no': '00030000000108', 'flmeter_no': '00036000000066', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 8, 19, 16, 21, 59, 975806), 'year': '2019', 'std_sum': '757', 'work_sum': '746', 'max_std_flow': '7.16', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 24, 9, 37, 37), 'min_std_flow_time': datetime.datetime(2019, 1, 3, 13, 25, 3), 'max_work_flow': '7.16', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 24, 9, 37, 37), 'min_work_flow_time': datetime.datetime(2019, 1, 3, 13, 25, 3), 'max_temperature': '38.1', 'min_temperature': '-3.5', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 4, 24, 9, 37, 37), 'min_temp_time': datetime.datetime(2019, 5, 1, 1, 23, 2), 'max_press': '127.9', 'min_press': '100.7', 'avg_press': '104.0', 'max_press_time': datetime.datetime(2019, 6, 6, 9, 7, 25), 'min_press_time': datetime.datetime(2019, 2, 4, 11, 25, 19), 'price': '1.0', 'use_volume_work': '1007.0', 'use_volume_std': '693.0', 'use_money': '693.0', 'sum_total_volume': '757', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000001', 'fm_state_msg': '[ä½™é¢ä¸è¶³]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '104.0', 'press_out': '104.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '18.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000066å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000008
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000210'}]
0000000210
00036000000008 â˜† sum_total_money <0 ç½®ä¸º0
00036000000008
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000105')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000210', 'rtu_no': '00030000000012', 'flmeter_no': '00036000000008', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 0, 455525), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 14, 13, 59, 38), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 2, 8, 19), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 14, 13, 59, 38), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 2, 8, 19), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 14, 13, 59, 38), 'min_temp_time': datetime.datetime(2019, 1, 4, 2, 8, 19), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 14, 13, 59, 38), 'min_press_time': datetime.datetime(2019, 1, 4, 2, 8, 19), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '40.0', 'use_money': '35.0', 'sum_total_volume': '48420', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '51651.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,æœªå¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000008å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
0800007983
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000211'}]
0000000211
0800007983
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000098')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000211', 'rtu_no': '00030000000114', 'flmeter_no': '0800007983', 'customer_no': '00030000000047', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 0, 786637), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 25, 1, 21, 4), 'min_std_flow_time': datetime.datetime(2019, 1, 26, 1, 19, 23), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 25, 1, 21, 4), 'min_work_flow_time': datetime.datetime(2019, 1, 26, 1, 19, 23), 'max_temperature': '20.3', 'min_temperature': '10.8', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 22, 19, 30), 'min_temp_time': datetime.datetime(2019, 3, 1, 1, 21, 13), 'max_press': '103.0', 'min_press': '100.4', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 25, 22, 19, 30), 'min_press_time': datetime.datetime(2019, 3, 1, 1, 21, 13), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': 'æ— æŠ¥è­¦[çŠ¶æ€å­—2å¤‡ç”¨å¾…å®š;]', 'rtu_state': '1', 'rtu_state_msg': 'æ— æŠ¥è­¦[çŠ¶æ€å­—2å¤‡ç”¨å¾…å®š;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '13.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
0800007983å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000018
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000212'}]
0000000212
00036000000018
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000113')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000212', 'rtu_no': '00030000000049', 'flmeter_no': '00036000000018', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 1, 198540), 'year': '2019', 'std_sum': '103', 'work_sum': '104', 'max_std_flow': '1001.02', 'min_std_flow': '0.0', 'avg_std_flow': '10.0', 'max_std_flow_time': datetime.datetime(2019, 3, 19, 16, 30, 56), 'min_std_flow_time': datetime.datetime(2019, 1, 2, 13, 32, 51), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 29, 14, 13, 6), 'min_work_flow_time': datetime.datetime(2019, 1, 2, 13, 32, 51), 'max_temperature': '25.7', 'min_temperature': '0.0', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 2, 27, 18, 31, 56), 'min_temp_time': datetime.datetime(2019, 1, 2, 13, 32, 51), 'max_press': '103.8', 'min_press': '0.0', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2019, 1, 21, 14, 34, 34), 'min_press_time': datetime.datetime(2019, 1, 2, 13, 32, 51), 'price': '0.01', 'use_volume_work': '428.0', 'use_volume_std': '5.0', 'use_money': '0.05', 'sum_total_volume': '103', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '15', 'remain_money': '14', 'remain_volume': None, 'fm_state': '000000000000000000000000000001000101101100000000', 'fm_state_msg': '[å¸‚ç”µæ–­å¼€][RTUç”µæ± ä½ç”µé‡æŠ¥è­¦][ä¿®æ­£ä»ªä½ç”µé‡æŠ¥è­¦][å¼€ç›–é˜²æ‹†æŠ¥è­¦][æµé‡è®¡æ–­çº¿æŠ¥è­¦][å‹åŠ›ä¼ æ„Ÿå™¨æ•…éšœ]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '10.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000018å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000067
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000213'}]
0000000213
00036000000067
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000079')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000213', 'rtu_no': '00030000000109', 'flmeter_no': '00036000000067', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 1, 588496), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 29, 1, 30, 32), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 1, 5, 38), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 29, 1, 30, 32), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 1, 5, 38), 'max_temperature': '22.7', 'min_temperature': '12.0', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 3, 30, 17, 0, 8), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 10, 49), 'max_press': '116.8', 'min_press': '100.4', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 1, 31, 19, 5, 45), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 10, 49), 'price': '2.5', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '200', 'remain_money': '200.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000001000000000000000000', 'fm_state_msg': '[å‹åŠ›ä¼ æ„Ÿå™¨æ•…éšœ]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': '7.34', 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '17.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000067å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000060
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000214'}]
0000000214
00036000000060
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000142')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000214', 'rtu_no': '00030000000102', 'flmeter_no': '00036000000060', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 1, 906641), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 1, 5, 22, 51), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 1, 21, 22), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 1, 5, 22, 51), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 1, 21, 22), 'max_temperature': '14.1', 'min_temperature': '11.0', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 1, 31, 15, 26, 39), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 27, 33), 'max_press': '103.8', 'min_press': '100.5', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 1, 31, 15, 26, 39), 'min_press_time': datetime.datetime(2019, 1, 4, 1, 21, 22), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '1', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': 'æ— æŠ¥è­¦[çŠ¶æ€å­—2å¤‡ç”¨å¾…å®š;]', 'rtu_state': '1', 'rtu_state_msg': 'æ— æŠ¥è­¦[çŠ¶æ€å­—2å¤‡ç”¨å¾…å®š;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '15.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000060å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000055
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000215'}]
0000000215
00036000000055
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000139')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000215', 'rtu_no': '00030000000097', 'flmeter_no': '00036000000055', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 2, 302583), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 1, 5, 24, 38), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 0, 21, 53), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 1, 5, 24, 38), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 0, 21, 53), 'max_temperature': '13.3', 'min_temperature': '10.9', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 3, 1, 5, 24, 38), 'min_temp_time': datetime.datetime(2019, 3, 1, 1, 23, 5), 'max_press': '103.4', 'min_press': '96.3', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 1, 28, 17, 28, 35), 'min_press_time': datetime.datetime(2019, 1, 4, 0, 21, 53), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 8.0, 'total_buy_volume': None, 'total_buy_money': '16', 'remain_money': '8', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': 'æ— æŠ¥è­¦[çŠ¶æ€å­—2å¤‡ç”¨å¾…å®š;]', 'rtu_state': '1', 'rtu_state_msg': 'æ— æŠ¥è­¦[çŠ¶æ€å­—2å¤‡ç”¨å¾…å®š;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '13.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000055å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000005
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000216'}]
0000000216
00036000000005 â˜† sum_total_money <0 ç½®ä¸º0
00036000000005
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000081')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000216', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000005', 'customer_no': None, 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 2, 634695), 'year': '2019', 'std_sum': '419', 'work_sum': '426', 'max_std_flow': '773.14', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 11, 10, 15, 7), 'min_std_flow_time': datetime.datetime(2019, 1, 4, 0, 54, 17), 'max_work_flow': '778.62', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 11, 10, 15, 7), 'min_work_flow_time': datetime.datetime(2019, 1, 4, 0, 54, 17), 'max_temperature': '35.91', 'min_temperature': '10.53', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 11, 17, 6, 53), 'min_temp_time': datetime.datetime(2019, 2, 4, 11, 15, 45), 'max_press': '99.81', 'min_press': '100.21', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 7, 13, 15, 52, 29), 'min_press_time': datetime.datetime(2019, 2, 4, 11, 15, 45), 'price': '2.35', 'use_volume_work': '48063.0', 'use_volume_std': '105.0', 'use_money': '360.6', 'sum_total_volume': '419', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1560.59', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': 'å¤–æ¥ç”µ,é˜€é—¨æ— ä½ç”µ,æ— å¡æ”»å‡»,æœªå‰ªçº¿,è¿œç¨‹é˜€å¼€,æ— ä½ç”µ,é˜€å¼€,æœªå¼€æˆ·', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '0', 'battery_voltage': '0', 'battery_level': None, 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000005å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000069
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000217'}]
0000000217
00036000000069
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000143')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000217', 'rtu_no': '00030000000111', 'flmeter_no': '00036000000069', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 2, 939878), 'year': '2019', 'std_sum': '2', 'work_sum': '2', 'max_std_flow': '10.69', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 6, 26, 1, 21, 24), 'min_std_flow_time': datetime.datetime(2019, 1, 2, 13, 29, 9), 'max_work_flow': '10.69', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 6, 26, 1, 21, 24), 'min_work_flow_time': datetime.datetime(2019, 1, 2, 13, 29, 9), 'max_temperature': '29.1', 'min_temperature': '0.0', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 7, 24, 15, 19, 43), 'min_temp_time': datetime.datetime(2019, 1, 2, 13, 29, 9), 'max_press': '103.8', 'min_press': '0.0', 'avg_press': '74.0', 'max_press_time': datetime.datetime(2019, 7, 24, 15, 19, 43), 'min_press_time': datetime.datetime(2019, 1, 2, 13, 29, 9), 'price': '1.0', 'use_volume_work': '10.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '2', 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '40', 'remain_money': '37.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': '7.4', 'battery_level': '100', 'press_in': '74.0', 'press_out': '74.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '15.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000069å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000089
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000218'}]
0000000218
00036000000089
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000133')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000218', 'rtu_no': '00030000000129', 'flmeter_no': '00036000000089', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 3, 253046), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 19, 1, 21, 17), 'min_std_flow_time': datetime.datetime(2019, 3, 25, 19, 18, 40), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 19, 1, 21, 17), 'min_work_flow_time': datetime.datetime(2019, 3, 25, 19, 18, 40), 'max_temperature': '26.7', 'min_temperature': '0.0', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 7, 19, 1, 21, 17), 'min_temp_time': datetime.datetime(2019, 3, 25, 19, 18, 40), 'max_press': '99.7', 'min_press': '0.0', 'avg_press': '64.0', 'max_press_time': datetime.datetime(2019, 7, 19, 1, 21, 17), 'min_press_time': datetime.datetime(2019, 3, 25, 19, 18, 40), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000001', 'fm_state_msg': '[ä½™é¢ä¸è¶³]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '64.0', 'press_out': '64.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '25.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000089å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000048
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000219'}]
0000000219
00036000000048 â˜† sum_total_money <0 ç½®ä¸º0
00036000000048
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000089')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000219', 'rtu_no': '00030000000090', 'flmeter_no': '00036000000048', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 3, 584204), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 4, 17, 14, 27, 42), 'min_std_flow_time': datetime.datetime(2019, 1, 3, 13, 32, 33), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 17, 14, 27, 42), 'min_work_flow_time': datetime.datetime(2019, 1, 3, 13, 32, 33), 'max_temperature': '19.8', 'min_temperature': '13.6', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 17, 30, 42), 'min_temp_time': datetime.datetime(2019, 2, 2, 0, 21, 19), 'max_press': '103.7', 'min_press': '94.4', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 1, 29, 13, 27, 7), 'min_press_time': datetime.datetime(2019, 2, 2, 0, 21, 19), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '5', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '16.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000048å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000080
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 6
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000220'}]
0000000220
00036000000080
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000087')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000220', 'rtu_no': '00030000000120', 'flmeter_no': '00036000000080', 'customer_no': '00030000000050', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 3, 894331), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 1, 20, 40), 'min_std_flow_time': datetime.datetime(2019, 3, 26, 14, 12, 52), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 1, 20, 40), 'min_work_flow_time': datetime.datetime(2019, 3, 26, 14, 12, 52), 'max_temperature': '33.0', 'min_temperature': '19.5', 'avg_temperature': '22.0', 'max_temp_time': datetime.datetime(2019, 7, 31, 0, 15, 11), 'min_temp_time': datetime.datetime(2019, 6, 1, 1, 20, 39), 'max_press': '101.3', 'min_press': '100.1', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 7, 31, 0, 15, 11), 'min_press_time': datetime.datetime(2019, 5, 16, 10, 57, 48), 'price': '1.0', 'use_volume_work': '2.0', 'use_volume_std': '1.0', 'use_money': '1.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '20.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000080å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000042
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000221'}]
0000000221
00036000000042
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000125')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000221', 'rtu_no': '00030000000083', 'flmeter_no': '00036000000042', 'customer_no': '00030000000032', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 4, 196518), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 5, 6, 8, 58, 5), 'min_std_flow_time': datetime.datetime(2019, 1, 9, 1, 21, 58), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 5, 6, 8, 58, 5), 'min_work_flow_time': datetime.datetime(2019, 1, 9, 1, 21, 58), 'max_temperature': '21.5', 'min_temperature': '0.0', 'avg_temperature': '8.0', 'max_temp_time': datetime.datetime(2019, 5, 6, 8, 58, 5), 'min_temp_time': datetime.datetime(2019, 1, 9, 1, 21, 58), 'max_press': '103.1', 'min_press': '0.0', 'avg_press': '74.0', 'max_press_time': datetime.datetime(2019, 1, 10, 3, 34, 8), 'min_press_time': datetime.datetime(2019, 1, 9, 1, 21, 58), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '2', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '74.0', 'press_out': '74.0', 'temp_in': '8.0', 'temp_out': '8.0', 'rssi': '17.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000042å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000012
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000222'}]
0000000222
00036000000012
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000119')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000222', 'rtu_no': '00030000000043', 'flmeter_no': '00036000000012', 'customer_no': '00030000000005', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 4, 567526), 'year': '2019', 'std_sum': '6837', 'work_sum': '6828', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 1, 20, 58), 'min_std_flow_time': datetime.datetime(2019, 1, 26, 1, 21, 9), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 1, 20, 58), 'min_work_flow_time': datetime.datetime(2019, 1, 26, 1, 21, 9), 'max_temperature': '28.2', 'min_temperature': '0.0', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 8, 11, 1, 20, 58), 'min_temp_time': datetime.datetime(2019, 1, 26, 1, 21, 9), 'max_press': '103.0', 'min_press': '0.0', 'avg_press': '97.0', 'max_press_time': datetime.datetime(2019, 2, 26, 1, 20, 37), 'min_press_time': datetime.datetime(2019, 1, 26, 1, 21, 9), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '6837', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2999', 'remain_money': '2999.0', 'remain_volume': None, 'fm_state': '100000000000000000000000000000000000000000000000', 'fm_state_msg': '[å¾…å®š]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '44', 'press_in': '97.0', 'press_out': '97.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '16.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000012å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000081
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 6
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000223'}]
0000000223
00036000000081
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000091')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000223', 'rtu_no': '00030000000121', 'flmeter_no': '00036000000081', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 4, 870719), 'year': '2019', 'std_sum': '72', 'work_sum': '75', 'max_std_flow': '529.17', 'min_std_flow': '0.0', 'avg_std_flow': '75.0', 'max_std_flow_time': datetime.datetime(2019, 4, 1, 16, 55, 42), 'min_std_flow_time': datetime.datetime(2019, 4, 2, 18, 9, 30), 'max_work_flow': '0.26', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 29, 20, 1, 21), 'min_work_flow_time': datetime.datetime(2019, 4, 2, 18, 9, 30), 'max_temperature': '51.0', 'min_temperature': '-17.1', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 7, 29, 20, 1, 21), 'min_temp_time': datetime.datetime(2019, 3, 25, 11, 42, 50), 'max_press': '121.3', 'min_press': '0.0', 'avg_press': '82.0', 'max_press_time': datetime.datetime(2019, 4, 1, 16, 55, 42), 'min_press_time': datetime.datetime(2019, 3, 25, 11, 42, 50), 'price': '2.51', 'use_volume_work': '95749843.0', 'use_volume_std': '75.0', 'use_money': '210.72', 'sum_total_volume': '72', 'sum_total_money': 184.0, 'total_buy_volume': None, 'total_buy_money': '190', 'remain_money': '6.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000100000000', 'fm_state_msg': '[å¸‚ç”µæ–­å¼€]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': '7.43', 'battery_level': '100', 'press_in': '82.0', 'press_out': '82.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '29.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000081å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000099
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 6
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000224'}]
0000000224
00036000000099
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000102')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000224', 'rtu_no': '00030000000139', 'flmeter_no': '00036000000099', 'customer_no': '00030000000052', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 5, 206819), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '1.42', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 30, 13, 52, 53), 'min_std_flow_time': datetime.datetime(2019, 3, 29, 12, 43, 27), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 1, 22, 31), 'min_work_flow_time': datetime.datetime(2019, 3, 29, 12, 43, 27), 'max_temperature': '34.1', 'min_temperature': '16.4', 'avg_temperature': '24.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 1, 23, 30), 'min_temp_time': datetime.datetime(2019, 4, 1, 1, 20, 23), 'max_press': '99.9', 'min_press': '100.2', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 6, 29, 1, 23, 14), 'min_press_time': datetime.datetime(2019, 3, 29, 12, 43, 27), 'price': '1.0', 'use_volume_work': '2.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '1', 'remain_money': '1.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '24.0', 'temp_out': '24.0', 'rssi': '23.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000099å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00036000000044
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000225'}]
0000000225
00036000000044
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0003', '00032019080000000149')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0003', 'sry_id': '00032019080000000225', 'rtu_no': '00030000000085', 'flmeter_no': '00036000000044', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 5, 539927), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '37.31', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 1, 9, 15, 44, 24), 'min_std_flow_time': datetime.datetime(2019, 1, 9, 6, 27, 5), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 1, 21, 3), 'min_work_flow_time': datetime.datetime(2019, 1, 9, 6, 27, 5), 'max_temperature': '8.4', 'min_temperature': '1.1', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 21, 50, 1), 'min_temp_time': datetime.datetime(2019, 1, 9, 6, 27, 5), 'max_press': '127.9', 'min_press': '100.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 31, 19, 31, 22), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 20, 50), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000001', 'fm_state_msg': '[ä½™é¢ä¸è¶³]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '10.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00036000000044å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
0003 data_processing is ok
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0002
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0002 2019 æœŸé—´æ— SCADA_REPORT_MONTHLYæ•°æ®ï¼Œè¯·ç­‰å¾…é‡æ–°è®¡ç®—å¹´æŠ¥è¡¨
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0010
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0010 2019 æœŸé—´æ— SCADA_REPORT_MONTHLYæ•°æ®ï¼Œè¯·ç­‰å¾…é‡æ–°è®¡ç®—å¹´æŠ¥è¡¨
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0018
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 25
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0018 2019 å¼€å§‹è¿›è¡Œè®¡ç®—å¹´æŠ¥è¡¨æ•°æ®å¤„ç†
ä¸åŒçš„è¡¨è®¡å·å…±æœ‰ä¸ªæ•°: 6
æ ¹æ®è¡¨è®¡å·ï¼Œè¿›è¡Œæ•°æ®çš„å†æ¬¡ç­›é€‰ï¼Œå¤„ç†ï¼Œå†™å…¥æ•°æ®åº“
----------------------------------------------------------------------------------------
00186000000006
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0018', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0018', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000013'}]
0000000013
00186000000006
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0018', '00182019080000000007')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0018', 'sry_id': '00182019080000000013', 'rtu_no': '00180000000006', 'flmeter_no': '00186000000006', 'customer_no': '00180000000006', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 6, 298896), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '3.22', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 18, 20), 'min_std_flow_time': datetime.datetime(2019, 6, 14, 13, 13, 29), 'max_work_flow': '3.22', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 18, 20), 'min_work_flow_time': datetime.datetime(2019, 6, 14, 13, 13, 29), 'max_temperature': '35.9', 'min_temperature': '0.0', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 8, 11, 18, 20), 'min_temp_time': datetime.datetime(2019, 6, 14, 13, 13, 29), 'max_press': '98.8', 'min_press': '0.0', 'avg_press': '70.0', 'max_press_time': datetime.datetime(2019, 7, 30, 1, 20, 45), 'min_press_time': datetime.datetime(2019, 6, 14, 13, 13, 29), 'price': '3.0', 'use_volume_work': '8.0', 'use_volume_std': '7.0', 'use_money': '7.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '5000', 'remain_money': '4999.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '70.0', 'press_out': '70.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '28.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00186000000006å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00186000000005
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0018', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0018', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000014'}]
0000000014
00186000000005
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0018', '00182019080000000012')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0018', 'sry_id': '00182019080000000014', 'rtu_no': '00180000000005', 'flmeter_no': '00186000000005', 'customer_no': '00180000000005', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 6, 597149), 'year': '2019', 'std_sum': '7', 'work_sum': '8', 'max_std_flow': '0.02', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 6, 17, 12, 45, 39), 'min_std_flow_time': datetime.datetime(2019, 6, 14, 13, 13, 24), 'max_work_flow': '0.02', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 6, 17, 12, 45, 39), 'min_work_flow_time': datetime.datetime(2019, 6, 14, 13, 13, 24), 'max_temperature': '30.9', 'min_temperature': '23.0', 'avg_temperature': '25.0', 'max_temp_time': datetime.datetime(2019, 6, 17, 12, 45, 39), 'min_temp_time': datetime.datetime(2019, 6, 14, 13, 13, 24), 'max_press': '98.8', 'min_press': '97.1', 'avg_press': '98.0', 'max_press_time': datetime.datetime(2019, 7, 30, 1, 20, 45), 'min_press_time': datetime.datetime(2019, 7, 1, 1, 20, 43), 'price': '1.0', 'use_volume_work': '8.0', 'use_volume_std': '7.0', 'use_money': '7.0', 'sum_total_volume': '7', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.0', 'remain_volume': None, 'fm_state': '000000001000000000000000000000000000000000000000', 'fm_state_msg': '[å¾…å®š]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '25.0', 'temp_out': '25.0', 'rssi': '37.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00186000000005å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00186000000003
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0018', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0018', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000015'}]
0000000015
00186000000003
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0018', '00182019080000000011')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0018', 'sry_id': '00182019080000000015', 'rtu_no': '00180000000003', 'flmeter_no': '00186000000003', 'customer_no': '00180000000003', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 6, 914251), 'year': '2019', 'std_sum': '8', 'work_sum': '9', 'max_std_flow': '25.76', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 6, 17, 15, 53, 18), 'min_std_flow_time': datetime.datetime(2019, 5, 23, 11, 24, 59), 'max_work_flow': '25.76', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 6, 17, 15, 53, 18), 'min_work_flow_time': datetime.datetime(2019, 5, 23, 11, 24, 59), 'max_temperature': '32.8', 'min_temperature': '22.8', 'avg_temperature': '27.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 1, 20, 36), 'min_temp_time': datetime.datetime(2019, 6, 1, 1, 21, 7), 'max_press': '99.6', 'min_press': '96.3', 'avg_press': '97.0', 'max_press_time': datetime.datetime(2019, 7, 30, 1, 20, 36), 'min_press_time': datetime.datetime(2019, 7, 1, 1, 21, 7), 'price': '1.0', 'use_volume_work': '9.0', 'use_volume_std': '8.0', 'use_money': '8.0', 'sum_total_volume': '8', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.0', 'remain_volume': None, 'fm_state': '000000001000000000000000000000000000000000000000', 'fm_state_msg': '[å¾…å®š]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '97.0', 'press_out': '97.0', 'temp_in': '27.0', 'temp_out': '27.0', 'rssi': '18.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00186000000003å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00186000000004
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 4
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0018', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0018', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000016'}]
0000000016
00186000000004
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0018', '00182019080000000008')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0018', 'sry_id': '00182019080000000016', 'rtu_no': '00180000000004', 'flmeter_no': '00186000000004', 'customer_no': '00180000000004', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 7, 262326), 'year': '2019', 'std_sum': '5806', 'work_sum': '6079', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 1, 20, 23), 'min_std_flow_time': datetime.datetime(2019, 5, 23, 8, 46, 32), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 1, 20, 23), 'min_work_flow_time': datetime.datetime(2019, 5, 23, 8, 46, 32), 'max_temperature': '33.3', 'min_temperature': '22.9', 'avg_temperature': '27.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 1, 22, 34), 'min_temp_time': datetime.datetime(2019, 6, 1, 1, 21), 'max_press': '102.9', 'min_press': '100.4', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 5, 30, 1, 22, 34), 'min_press_time': datetime.datetime(2019, 7, 1, 1, 20, 33), 'price': '3.0', 'use_volume_work': '5870.0', 'use_volume_std': '5607.0', 'use_money': '16821.0', 'sum_total_volume': '5806', 'sum_total_money': 17413.0, 'total_buy_volume': None, 'total_buy_money': '27000', 'remain_money': '9587.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '27.0', 'temp_out': '27.0', 'rssi': '16.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00186000000004å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00186000000001
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 6
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0018', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0018', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000017'}]
0000000017
00186000000001
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0018', '00182019080000000009')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0018', 'sry_id': '00182019080000000017', 'rtu_no': '00180000000001', 'flmeter_no': '00186000000001', 'customer_no': '00180000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 7, 675216), 'year': '2019', 'std_sum': '16433', 'work_sum': '17238', 'max_std_flow': '3.96', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 31, 0, 0, 38), 'min_std_flow_time': datetime.datetime(2019, 3, 25, 16, 23, 46), 'max_work_flow': '3.96', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 31, 0, 0, 38), 'min_work_flow_time': datetime.datetime(2019, 3, 25, 16, 23, 46), 'max_temperature': '37.0', 'min_temperature': '0.0', 'avg_temperature': '27.0', 'max_temp_time': datetime.datetime(2019, 7, 31, 0, 0, 38), 'min_temp_time': datetime.datetime(2019, 3, 25, 16, 23, 46), 'max_press': '103.2', 'min_press': '0.0', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 5, 15, 1, 20, 35), 'min_press_time': datetime.datetime(2019, 3, 25, 16, 23, 46), 'price': '3.0', 'use_volume_work': '16830.0', 'use_volume_std': '16044.0', 'use_money': '48132.0', 'sum_total_volume': '16433', 'sum_total_money': 51572.0, 'total_buy_volume': None, 'total_buy_money': '55000', 'remain_money': '3428.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '27.0', 'temp_out': '27.0', 'rssi': '18.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00186000000001å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00186000000002
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 5
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0018', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0018', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000018'}]
0000000018
00186000000002
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0018', '00182019080000000010')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0018', 'sry_id': '00182019080000000018', 'rtu_no': '00180000000002', 'flmeter_no': '00186000000002', 'customer_no': '00180000000002', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 8, 6472), 'year': '2019', 'std_sum': '2852', 'work_sum': '2982', 'max_std_flow': '8.91', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 28, 11, 16, 24), 'min_std_flow_time': datetime.datetime(2019, 4, 10, 14, 12, 39), 'max_work_flow': '8.91', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 28, 11, 16, 24), 'min_work_flow_time': datetime.datetime(2019, 4, 10, 14, 12, 39), 'max_temperature': '32.1', 'min_temperature': '16.0', 'avg_temperature': '24.0', 'max_temp_time': datetime.datetime(2019, 7, 28, 11, 16, 24), 'min_temp_time': datetime.datetime(2019, 4, 10, 14, 12, 39), 'max_press': '98.5', 'min_press': '96.6', 'avg_press': '98.0', 'max_press_time': datetime.datetime(2019, 6, 29, 1, 21, 16), 'min_press_time': datetime.datetime(2019, 7, 1, 1, 21, 7), 'price': '3.0', 'use_volume_work': '2915.0', 'use_volume_std': '2788.0', 'use_money': '8338.0', 'sum_total_volume': '2852', 'sum_total_money': 8623.0, 'total_buy_volume': None, 'total_buy_money': '14000', 'remain_money': '5377.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '24.0', 'temp_out': '24.0', 'rssi': '23.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00186000000002å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
0018 data_processing is ok
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0021
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 8
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0021 2019 å¼€å§‹è¿›è¡Œè®¡ç®—å¹´æŠ¥è¡¨æ•°æ®å¤„ç†
ä¸åŒçš„è¡¨è®¡å·å…±æœ‰ä¸ªæ•°: 4
æ ¹æ®è¡¨è®¡å·ï¼Œè¿›è¡Œæ•°æ®çš„å†æ¬¡ç­›é€‰ï¼Œå¤„ç†ï¼Œå†™å…¥æ•°æ®åº“
----------------------------------------------------------------------------------------
00216000000001
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0021', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0021', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000009'}]
0000000009
00216000000001
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0021', '00212019080000000006')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0021', 'sry_id': '00212019080000000009', 'rtu_no': '00210000000001', 'flmeter_no': '00216000000001', 'customer_no': '00210000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 8, 506993), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '62.56', 'min_std_flow': '0.0', 'avg_std_flow': '1.0', 'max_std_flow_time': datetime.datetime(2019, 6, 20, 17, 0, 49), 'min_std_flow_time': datetime.datetime(2019, 6, 20, 16, 56, 19), 'max_work_flow': '40.94', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 6, 20, 17, 0, 49), 'min_work_flow_time': datetime.datetime(2019, 6, 20, 16, 56, 19), 'max_temperature': '38.1', 'min_temperature': '20.0', 'avg_temperature': '30.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 0, 35, 32), 'min_temp_time': datetime.datetime(2019, 6, 20, 16, 56, 19), 'max_press': '238.3', 'min_press': '101.1', 'avg_press': '190.0', 'max_press_time': datetime.datetime(2019, 6, 20, 17, 0, 49), 'min_press_time': datetime.datetime(2019, 7, 5, 11, 12, 49), 'price': '2.89', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '200', 'remain_money': '199.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': '7.37', 'battery_level': '100', 'press_in': '190.0', 'press_out': '190.0', 'temp_in': '30.0', 'temp_out': '30.0', 'rssi': '22.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00216000000001å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00216000000004
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0021', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0021', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000010'}]
0000000010
00216000000004
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0021', '00212019080000000007')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0021', 'sry_id': '00212019080000000010', 'rtu_no': '00210000000004', 'flmeter_no': '00216000000004', 'customer_no': '00210000000004', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 8, 834117), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 6, 20, 17, 21), 'min_std_flow_time': datetime.datetime(2019, 6, 20, 15, 29, 23), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 6, 20, 17, 21), 'min_work_flow_time': datetime.datetime(2019, 6, 20, 15, 29, 23), 'max_temperature': '31.4', 'min_temperature': '29.8', 'avg_temperature': '30.0', 'max_temp_time': datetime.datetime(2019, 6, 20, 17, 21), 'min_temp_time': datetime.datetime(2019, 6, 20, 15, 29, 23), 'max_press': '201.3', 'min_press': '100.9', 'avg_press': '116.0', 'max_press_time': datetime.datetime(2019, 6, 20, 17, 21), 'min_press_time': datetime.datetime(2019, 6, 20, 15, 29, 23), 'price': '2.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '23', 'remain_money': '22', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000100000000', 'fm_state_msg': '[å¸‚ç”µæ–­å¼€]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': '7.2', 'battery_level': '87', 'press_in': '116.0', 'press_out': '116.0', 'temp_in': '30.0', 'temp_out': '30.0', 'rssi': '20.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00216000000004å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00216000000002
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 3
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0021', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0021', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000011'}]
0000000011
00216000000002
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0021', '00212019080000000005')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0021', 'sry_id': '00212019080000000011', 'rtu_no': '00210000000002', 'flmeter_no': '00216000000002', 'customer_no': '00210000000002', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 9, 144288), 'year': '2019', 'std_sum': '531', 'work_sum': '288', 'max_std_flow': '5.23', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 7, 5, 15, 54, 36), 'min_std_flow_time': datetime.datetime(2019, 6, 20, 16, 41, 34), 'max_work_flow': '2.72', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 7, 5, 15, 54, 36), 'min_work_flow_time': datetime.datetime(2019, 6, 20, 16, 41, 34), 'max_temperature': '37.4', 'min_temperature': '0.0', 'avg_temperature': '28.0', 'max_temp_time': datetime.datetime(2019, 7, 5, 15, 54, 36), 'min_temp_time': datetime.datetime(2019, 7, 5, 11, 16, 19), 'max_press': '226.0', 'min_press': '103.4', 'avg_press': '178.0', 'max_press_time': datetime.datetime(2019, 6, 20, 16, 43), 'min_press_time': datetime.datetime(2019, 6, 20, 16, 41, 34), 'price': '2.89', 'use_volume_work': '288.0', 'use_volume_std': '531.0', 'use_money': '1534.59', 'sum_total_volume': '531', 'sum_total_money': 1537.0, 'total_buy_volume': None, 'total_buy_money': '2800', 'remain_money': '1263.0', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000000000000', 'fm_state_msg': 'æ— æŠ¥è­¦', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': '7.37', 'battery_level': '100', 'press_in': '178.0', 'press_out': '178.0', 'temp_in': '28.0', 'temp_out': '28.0', 'rssi': '21.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00216000000002å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
00216000000003
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 1
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0021', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0021', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000012'}]
0000000012
00216000000003
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0021', '00212019080000000008')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0021', 'sry_id': '00212019080000000012', 'rtu_no': '00210000000003', 'flmeter_no': '00216000000003', 'customer_no': '00210000000003', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 9, 488368), 'year': '2019', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '1337.19', 'min_std_flow': '0.0', 'avg_std_flow': '90.0', 'max_std_flow_time': datetime.datetime(2019, 6, 20, 16, 33, 24), 'min_std_flow_time': datetime.datetime(2019, 6, 20, 15, 57, 17), 'max_work_flow': '1132.01', 'min_work_flow': '0.0', 'avg_work_flow': '76.0', 'max_work_flow_time': datetime.datetime(2019, 6, 20, 16, 33, 24), 'min_work_flow_time': datetime.datetime(2019, 6, 20, 15, 57, 17), 'max_temperature': '31.3', 'min_temperature': '20.0', 'avg_temperature': '22.0', 'max_temp_time': datetime.datetime(2019, 6, 20, 16, 33, 24), 'min_temp_time': datetime.datetime(2019, 6, 20, 15, 57, 17), 'max_press': '226.4', 'min_press': '101.3', 'avg_press': '119.0', 'max_press_time': datetime.datetime(2019, 6, 20, 16, 33, 24), 'min_press_time': datetime.datetime(2019, 6, 20, 15, 57, 17), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '4', 'remain_volume': None, 'fm_state': '000000000000000000000000000000000000000100000000', 'fm_state_msg': '[å¸‚ç”µæ–­å¼€]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': '7.2', 'battery_level': '100', 'press_in': '119.0', 'press_out': '119.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '22.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00216000000003å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
0021 data_processing is ok
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0022
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0022 2019 å¼€å§‹è¿›è¡Œè®¡ç®—å¹´æŠ¥è¡¨æ•°æ®å¤„ç†
ä¸åŒçš„è¡¨è®¡å·å…±æœ‰ä¸ªæ•°: 1
æ ¹æ®è¡¨è®¡å·ï¼Œè¿›è¡Œæ•°æ®çš„å†æ¬¡ç­›é€‰ï¼Œå¤„ç†ï¼Œå†™å…¥æ•°æ®åº“
----------------------------------------------------------------------------------------
00226000000001
æ­¤æŸ¥è¯¢åŒºé—´,å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 2
æ­¤æŸ¥è¯¢åŒºé—´,ä¸Šä¸€å¹´å½“å‰ç¼–å·ä¸‹æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
å¼€å§‹å–è‡ªåŠ¨é€’å¢æµæ°´å·é€»è¾‘
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],å‚æ•°:[{'ssn_org_id': '0022', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '08'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0022', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019å¹´æŠ¥è¡¨', 'SSN_YEAR': '2019', 'SSN_MONTH': '08', 'SSN_VALUE': '0000000003'}]
0000000003
00226000000001
æ€»åˆ—è¡¨é•¿åº¦: 1
æ‰§è¡Œsql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],å‚æ•°:[('0022', '00222019080000000002')]
del_by_where ok
æ‰§è¡Œsql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],å‚æ•°:[{'sry_org_id': '0022', 'sry_id': '00222019080000000003', 'rtu_no': '00220000000001', 'flmeter_no': '00226000000001', 'customer_no': '00220000000001', 'report_time': datetime.datetime(2019, 8, 19, 16, 22, 9, 998007), 'year': '2019', 'std_sum': '226', 'work_sum': '239', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 8, 11, 1, 22, 34), 'min_std_flow_time': datetime.datetime(2019, 7, 10, 16, 32, 45), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 8, 11, 1, 22, 34), 'min_work_flow_time': datetime.datetime(2019, 7, 10, 16, 32, 45), 'max_temperature': '31.1', 'min_temperature': '23.7', 'avg_temperature': '26.0', 'max_temp_time': datetime.datetime(2019, 7, 30, 1, 20, 39), 'min_temp_time': datetime.datetime(2019, 7, 10, 16, 32, 45), 'max_press': '99.6', 'min_press': '77.7', 'avg_press': '98.0', 'max_press_time': datetime.datetime(2019, 7, 30, 1, 20, 39), 'min_press_time': datetime.datetime(2019, 7, 10, 16, 32, 45), 'price': '1.0', 'use_volume_work': '228.0', 'use_volume_std': '216.0', 'use_money': '216.0', 'sum_total_volume': '226', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.0', 'remain_volume': None, 'fm_state': '000000011000010000000000000000000000000000000001', 'fm_state_msg': '[ä½™é¢ä¸è¶³][å¾…å®š][å¾…å®š][å¾…å®š]', 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': 'é˜€å¼€', 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '26.0', 'temp_out': '26.0', 'rssi': '19.0', 'sry_status': '1'}]
insert_scada_report_yearly ok
00226000000001å¤„ç†å¥½æ•°æ®å·²å†™å…¥oracle
----------------------------------------------------------------------------------------
0022 data_processing is ok
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0013
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0013 2019 æœŸé—´æ— SCADA_REPORT_MONTHLYæ•°æ®ï¼Œè¯·ç­‰å¾…é‡æ–°è®¡ç®—å¹´æŠ¥è¡¨
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0006
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0006 2019 æœŸé—´æ— SCADA_REPORT_MONTHLYæ•°æ®ï¼Œè¯·ç­‰å¾…é‡æ–°è®¡ç®—å¹´æŠ¥è¡¨
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0014
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0014 2019 æœŸé—´æ— SCADA_REPORT_MONTHLYæ•°æ®ï¼Œè¯·ç­‰å¾…é‡æ–°è®¡ç®—å¹´æŠ¥è¡¨
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0023
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0023 2019 æœŸé—´æ— SCADA_REPORT_MONTHLYæ•°æ®ï¼Œè¯·ç­‰å¾…é‡æ–°è®¡ç®—å¹´æŠ¥è¡¨
----------------------------------------------------------------------------------------
æ­¤æœºæ„: 0024
ğŸ’— I am main2()
2019 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
2018 æ€»å…±SCADA_REPORT_MONTHLYæ•°æ®: 0
0024 2019 æœŸé—´æ— SCADA_REPORT_MONTHLYæ•°æ®ï¼Œè¯·ç­‰å¾…é‡æ–°è®¡ç®—å¹´æŠ¥è¡¨
----------------------------------------------------------------------------------------
all done-å¹´æŠ¥è¡¨æ•´ä¸ªå¤„ç†æµç¨‹å®Œæˆ
----------------------------------------------------------------------------------------
ç¨‹åºè¿è¡Œå¼€å§‹æ—¶é—´ 2019-08-19 16:20:38.244381
ç¨‹åºè¿è¡Œç»“æŸæ—¶é—´: 2019-08-19 16:22:11.020272
æ•´ä¸ªç¨‹åºè¿è¡Œæ€»æ—¶é—´: 92 ç§’
----------------------------------------------------------------------------------------
ç¨‹åºè¿è¡Œå¼€å§‹time.clock(): 3.4133327507912105e-07
ç¨‹åºè¿è¡Œç»“æŸtime.clock(): 92.77618981953027
æ•´ä¸ªç¨‹åºè¿è¡Œæ€»æ—¶é—´time.clock()å·®: 92.776189478197 ç§’
----------------------------------------------------------------------------------------
